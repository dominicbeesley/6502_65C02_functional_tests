AS65 Assembler for R6502 [1.42].  Copyright 1994-2007, Frank A. Kingswood                                                Page    1
------------------------------------------------ 65C02_extended_opcodes_test.a65 -------------------------------------------------

3125 lines read, no errors in pass 1.
                        ;
                        ; 6 5 C 0 2   E X T E N D E D   O P C O D E S   T E S T
                        ;
                        ; Copyright (C) 2013-2017  Klaus Dormann
                        ;
                        ; This program is free software: you can redistribute it and/or modify
                        ; it under the terms of the GNU General Public License as published by
                        ; the Free Software Foundation, either version 3 of the License, or
                        ; (at your option) any later version.
                        ;
                        ; This program is distributed in the hope that it will be useful,
                        ; but WITHOUT ANY WARRANTY; without even the implied warranty of
                        ; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                        ; GNU General Public License for more details.
                        ;
                        ; You should have received a copy of the GNU General Public License
                        ; along with this program.  If not, see <http://www.gnu.org/licenses/>.
                        
                        
                        ; This program is designed to test all additional 65C02 opcodes, addressing
                        ; modes and functionality not available in the NMOS version of the 6502.
                        ; The 6502_functional_test is a prerequisite to this test.
                        ; NMI, IRQ, STP & WAI are covered in the 6502_interrupt_test.
                        ; 
                        ; version 04-dec-2017
                        ; contact info at http://2m5.de or email K@2m5.de
                        ;
                        ; assembled with AS65 from http://www.kingswood-consulting.co.uk/assemblers/
                        ; command line switches: -l -m -s2 -w -x -h0
                        ;                         |  |  |   |  |  no page headers in listing
                        ;                         |  |  |   |  65C02 extensions
                        ;                         |  |  |   wide listing (133 char/col)
                        ;                         |  |  write intel hex file instead of binary
                        ;                         |  expand macros in listing
                        ;                         generate pass2 listing
                        ;
                        ; No IO - should be run from a monitor with access to registers.
                        ; To run load intel hex image with a load command, than alter PC to 400 hex
                        ; (code_segment) and enter a go command.
                        ; Loop on program counter determines error or successful completion of test.
                        ; Check listing for relevant traps (jump/branch *).
                        ; Please note that in early tests some instructions will have to be used before
                        ; they are actually tested!
                        ;
                        ; RESET, NMI or IRQ should not occur and will be trapped if vectors are enabled.
                        ; Tests documented behavior of the original 65C02 only!
                        ; Decimal ops will only be tested with valid BCD operands and the V flag will
                        ; be ignored as it is absolutely useless in decimal mode.
                        ;
                        ; Debugging hints:
                        ;     Most of the code is written sequentially. if you hit a trap, check the
                        ;   immediately preceeding code for the instruction to be tested. Results are
                        ;   tested first, flags are checked second by pushing them onto the stack and
                        ;   pulling them to the accumulator after the result was checked. The "real"
                        ;   flags are no longer valid for the tested instruction at this time!
                        ;     If the tested instruction was indexed, the relevant index (X or Y) must
                        ;   also be checked. Opposed to the flags, X and Y registers are still valid.
                        ;
                        ; versions:
                        ;   19-jul-2013  1st version distributed for testing
                        ;   23-jul-2013  fixed BRA out of range due to larger trap macros
                        ;                added RAM integrity check
                        ;   16-aug-2013  added error report to standard output option
                        ;   23-aug-2015  change revoked
                        ;   24-aug-2015  all self modifying immediate opcodes now execute in data RAM
                        ;   28-aug-2015  fixed decimal adc/sbc immediate only testing carry
                        ;   09-feb-2017  fixed RMB/SMB tested when they shouldn't be tested
                        ;   04-dec-2017  fixed BRK not tested for actually going through the IRQ vector
                        ;                added option to skip the remainder of a failing test
                        ;                in report.i65
                        ;                added skip override to undefined opcode as NOP test
                        
                        
                        ; C O N F I G U R A T I O N
                        
                        ;ROM_vectors writable (0=no, 1=yes)
                        ;if ROM vectors can not be used interrupts will not be trapped
                        ;as a consequence BRK can not be tested but will be emulated to test RTI
0000 =                  ROM_vectors = 0
                        
                        ;load_data_direct (0=move from code segment, 1=load directly)
                        ;loading directly is preferred but may not be supported by your platform
                        ;0 produces only consecutive object code, 1 is not suitable for a binary image
0000 =                  load_data_direct = 0
                        
                        ;I_flag behavior (0=force enabled, 1=force disabled, 2=prohibit change, 3=allow
                        ;change) 2 requires extra code and is not recommended.
0003 =                  I_flag = 3
                        
                        ;configure memory - try to stay away from memory used by the system
                        ;zero_page memory start address, $4e (78) consecutive Bytes required
                        ;                                add 2 if I_flag = 2
0050 =                  zero_page = $50
                        
                        ;data_segment memory start address, $63 (99) consecutive Bytes required
                        ; + 12 Bytes at data_segment + $f9 (JMP indirect page cross test)
1100 =                  data_segment = BASE
                            if (data_segment & $ff) != 0
                                ERROR ERROR ERROR low byte of data_segment MUST be $00 !!
                            endif  
                        
                        ;code_segment memory start address, 10kB of consecutive space required
                        ;                                   add 1 kB if I_flag = 2
1300 =                  code_segment = BASE + $200
                        
                        ;added WDC only opcodes WAI & STP (0=test as NOPs, >0=no test)
0000 =                  wdc_op = WDC_OP
                        
                        ;added Rockwell & WDC opcodes BBR, BBS, RMB & SMB
                        ;(0=test as NOPs, 1=full test, >1=no test) 
0001 =                  rkwl_wdc_op = RKWL_OP
                        
                        ;skip testing all undefined opcodes override
                        ;0=test as NOP, >0=skip
0000 =                  skip_nop = 0
                        
                        ;report errors through I/O channel (0=use standard self trap loops, 1=include
                        ;report.i65 as I/O channel, add 3 kB)
0001 =                  report = 1
                        
                        ;RAM integrity test option. Checks for undesired RAM writes.
                        ;set lowest non RAM or RAM mirror address page (-1=disable, 0=64k, $40=16k)
                        ;leave disabled if a monitor, OS or background interrupt is allowed to alter RAM
ffff =                  ram_top = -1
                        
                                noopt       ;do not take shortcuts
                                
                        ;macros for error & success traps to allow user modification
                        ;example:
                        ;trap    macro
                        ;        jsr my_error_handler
                        ;        endm
                        ;trap_eq macro
                        ;        bne skip\?
                        ;        trap           ;failed equal (zero)
                        ;skip\?
                        ;        endm
                        ;
                        ; my_error_handler should pop the calling address from the stack and report it.
                        ; putting larger portions of code (more than 3 bytes) inside the trap macro
                        ; may lead to branch range problems for some tests.
                            if report = 0
                        trap    macro
                                jmp *           ;failed anyway
                                endm
                        trap_eq macro
                                beq *           ;failed equal (zero)
                                endm
                        trap_ne macro
                                bne *           ;failed not equal (non zero)
                                endm
                        trap_cs macro
                                bcs *           ;failed carry set
                                endm
                        trap_cc macro
                                bcc *           ;failed carry clear
                                endm
                        trap_mi macro
                                bmi *           ;failed minus (bit 7 set)
                                endm
                        trap_pl macro
                                bpl *           ;failed plus (bit 7 clear)
                                endm
                        trap_vs macro
                                bvs *           ;failed overflow set
                                endm
                        trap_vc macro
                                bvc *           ;failed overflow clear
                                endm
                        ; please observe that during the test the stack gets invalidated
                        ; therefore a RTS inside the success macro is not possible
                        success macro
                                jmp *           ;test passed, no errors
                                endm
                            endif
                            if report = 1
                        trap    macro
                                jsr report_error
                                endm
                        trap_eq macro
                                bne skip\?
                                trap           ;failed equal (zero)
                        skip\?
                                endm
                        trap_ne macro
                                beq skip\?
                                trap            ;failed not equal (non zero)
                        skip\?
                                endm
                        trap_cs macro
                                bcc skip\?
                                trap            ;failed carry set
                        skip\?
                                endm
                        trap_cc macro
                                bcs skip\?
                                trap            ;failed carry clear
                        skip\?
                                endm
                        trap_mi macro
                                bpl skip\?
                                trap            ;failed minus (bit 7 set)
                        skip\?
                                endm
                        trap_pl macro
                                bmi skip\?
                                trap            ;failed plus (bit 7 clear)
                        skip\?
                                endm
                        trap_vs macro
                                bvc skip\?
                                trap            ;failed overflow set
                        skip\?
                                endm
                        trap_vc macro
                                bvs skip\?
                                trap            ;failed overflow clear
                        skip\?
                                endm
                        ; please observe that during the test the stack gets invalidated
                        ; therefore a RTS inside the success macro is not possible
                        success macro
                                jsr report_success
                                endm
                            endif
                        
                        
0001 =                  carry   equ %00000001   ;flag bits in status
0002 =                  zero    equ %00000010
0004 =                  intdis  equ %00000100
0008 =                  decmode equ %00001000
0010 =                  break   equ %00010000
0020 =                  reserv  equ %00100000
0040 =                  overfl  equ %01000000
0080 =                  minus   equ %10000000
                        
0001 =                  fc      equ carry
0002 =                  fz      equ zero
0003 =                  fzc     equ carry+zero
0040 =                  fv      equ overfl
0042 =                  fvz     equ overfl+zero
0080 =                  fn      equ minus
0081 =                  fnc     equ minus+carry
0082 =                  fnz     equ minus+zero
0083 =                  fnzc    equ minus+zero+carry
00c0 =                  fnv     equ minus+overfl
                        
0030 =                  fao     equ break+reserv    ;bits always on after PHP, BRK
0034 =                  fai     equ fao+intdis      ;+ forced interrupt disable
00ff =                  m8      equ $ff             ;8 bit mask
00fb =                  m8i     equ $ff&~intdis     ;8 bit mask - interrupt disable
                        
                        ;macros to allow masking of status bits.
                        ;masking of interrupt enable/disable on load and compare
                        ;masking of always on bits after PHP or BRK (unused & break) on compare
                                if I_flag = 0
                        load_flag   macro
                                    lda #\1&m8i         ;force enable interrupts (mask I)
                                    endm
                        cmp_flag    macro
                                    cmp #(\1|fao)&m8i   ;I_flag is always enabled + always on bits
                                    endm
                        eor_flag    macro
                                    eor #(\1&m8i|fao)   ;mask I, invert expected flags + always on bits
                                    endm
                                endif
                                if I_flag = 1
                        load_flag   macro
                                    lda #\1|intdis      ;force disable interrupts
                                    endm
                        cmp_flag    macro
                                    cmp #(\1|fai)&m8    ;I_flag is always disabled + always on bits
                                    endm
                        eor_flag    macro
                                    eor #(\1|fai)       ;invert expected flags + always on bits + I
                                    endm
                                endif
                                if I_flag = 2
                        load_flag   macro
                                    lda #\1
                                    ora flag_I_on       ;restore I-flag
                                    and flag_I_off
                                    endm
                        cmp_flag    macro
                                    eor flag_I_on       ;I_flag is never changed
                                    cmp #(\1|fao)&m8i   ;expected flags + always on bits, mask I
                                    endm
                        eor_flag    macro
                                    eor flag_I_on       ;I_flag is never changed
                                    eor #(\1&m8i|fao)   ;mask I, invert expected flags + always on bits
                                    endm
                                endif
                                if I_flag = 3
                        load_flag   macro
                                    lda #\1             ;allow test to change I-flag (no mask)
                                    endm
                        cmp_flag    macro
                                    cmp #(\1|fao)&m8    ;expected flags + always on bits
                                    endm
                        eor_flag    macro
                                    eor #\1|fao         ;invert expected flags + always on bits
                                    endm
                                endif
                        
                        ;macros to set (register|memory|zeropage) & status
                        set_stat    macro       ;setting flags in the processor status register
                                    load_flag \1
                                    pha         ;use stack to load status
                                    plp
                                    endm
                        
                        set_a       macro       ;precharging accu & status
                                    load_flag \2
                                    pha         ;use stack to load status
                                    lda #\1     ;precharge accu
                                    plp
                                    endm
                        
                        set_x       macro       ;precharging index & status
                                    load_flag \2
                                    pha         ;use stack to load status
                                    ldx #\1     ;precharge index x
                                    plp
                                    endm
                        
                        set_y       macro       ;precharging index & status
                                    load_flag \2
                                    pha         ;use stack to load status
                                    ldy #\1     ;precharge index y
                                    plp
                                    endm
                        
                        set_ax      macro       ;precharging indexed accu & immediate status
                                    load_flag \2
                                    pha         ;use stack to load status
                                    lda \1,x    ;precharge accu
                                    plp
                                    endm
                        
                        set_ay      macro       ;precharging indexed accu & immediate status
                                    load_flag \2
                                    pha         ;use stack to load status
                                    lda \1,y    ;precharge accu
                                    plp
                                    endm
                        
                        set_z       macro       ;precharging indexed zp & immediate status
                                    load_flag \2
                                    pha         ;use stack to load status
                                    lda \1,x    ;load to zeropage
                                    sta zpt
                                    plp
                                    endm
                        
                        set_zx      macro       ;precharging zp,x & immediate status
                                    load_flag \2
                                    pha         ;use stack to load status
                                    lda \1,x    ;load to indexed zeropage
                                    sta zpt,x
                                    plp
                                    endm
                        
                        set_abs     macro       ;precharging indexed memory & immediate status
                                    load_flag \2
                                    pha         ;use stack to load status
                                    lda \1,x    ;load to memory
                                    sta abst
                                    plp
                                    endm
                        
                        set_absx    macro       ;precharging abs,x & immediate status
                                    load_flag \2
                                    pha         ;use stack to load status
                                    lda \1,x    ;load to indexed memory
                                    sta abst,x
                                    plp
                                    endm
                        
                        ;macros to test (register|memory|zeropage) & status & (mask)
                        tst_stat    macro       ;testing flags in the processor status register
                                    php         ;save status
                                    pla         ;use stack to retrieve status
                                    pha
                                    cmp_flag \1
                                    trap_ne
                                    plp         ;restore status
                                    endm
                                    
                        tst_a       macro       ;testing result in accu & flags
                                    php         ;save flags
                                    cmp #\1     ;test result
                                    trap_ne
                                    pla         ;load status
                                    pha
                                    cmp_flag \2
                                    trap_ne
                                    plp         ;restore status
                                    endm
                        
                        tst_as      macro       ;testing result in accu & flags, save accu
                                    pha
                                    php         ;save flags
                                    cmp #\1     ;test result
                                    trap_ne
                                    pla         ;load status
                                    pha
                                    cmp_flag \2
                                    trap_ne
                                    plp         ;restore status
                                    pla
                                    endm
                        
                        tst_x       macro       ;testing result in x index & flags
                                    php         ;save flags
                                    cpx #\1     ;test result
                                    trap_ne
                                    pla         ;load status
                                    pha
                                    cmp_flag \2
                                    trap_ne
                                    plp         ;restore status
                                    endm
                        
                        tst_y       macro       ;testing result in y index & flags
                                    php         ;save flags
                                    cpy #\1     ;test result
                                    trap_ne
                                    pla         ;load status
                                    pha
                                    cmp_flag \2
                                    trap_ne
                                    plp         ;restore status
                                    endm
                        
                        tst_ax      macro       ;indexed testing result in accu & flags
                                    php         ;save flags
                                    cmp \1,x    ;test result
                                    trap_ne
                                    pla         ;load status
                                    eor_flag \3
                                    cmp \2,x    ;test flags
                                    trap_ne     ;
                                    endm
                        
                        tst_ay      macro       ;indexed testing result in accu & flags
                                    php         ;save flags
                                    cmp \1,y    ;test result
                                    trap_ne     ;
                                    pla         ;load status
                                    eor_flag \3
                                    cmp \2,y    ;test flags
                                    trap_ne
                                    endm
                                
                        tst_z       macro       ;indexed testing result in zp & flags
                                    php         ;save flags
                                    lda zpt
                                    cmp \1,x    ;test result
                                    trap_ne
                                    pla         ;load status
                                    eor_flag \3
                                    cmp \2,x    ;test flags
                                    trap_ne
                                    endm
                        
                        tst_zx      macro       ;testing result in zp,x & flags
                                    php         ;save flags
                                    lda zpt,x
                                    cmp \1,x    ;test result
                                    trap_ne
                                    pla         ;load status
                                    eor_flag \3
                                    cmp \2,x    ;test flags
                                    trap_ne
                                    endm
                        
                        tst_abs     macro       ;indexed testing result in memory & flags
                                    php         ;save flags
                                    lda abst
                                    cmp \1,x    ;test result
                                    trap_ne
                                    pla         ;load status
                                    eor_flag \3
                                    cmp \2,x    ;test flags
                                    trap_ne
                                    endm
                        
                        tst_absx    macro       ;testing result in abs,x & flags
                                    php         ;save flags
                                    lda abst,x
                                    cmp \1,x    ;test result
                                    trap_ne
                                    pla         ;load status
                                    eor_flag \3
                                    cmp \2,x    ;test flags
                                    trap_ne
                                    endm
                                    
                        ; RAM integrity test
                        ;   verifies that none of the previous tests has altered RAM outside of the
                        ;   designated write areas.
                        ;   uses zpt word as indirect pointer, zpt+2 word as checksum
                                if ram_top > -1
                        check_ram   macro 
                                    cld
                                    lda #0
                                    sta zpt         ;set low byte of indirect pointer
                                    sta zpt+3       ;checksum high byte
                                    ldx #11         ;reset modifiable RAM
                        ccs1\?      sta jxi_tab,x   ;JMP indirect page cross area
                                    dex
                                    bpl ccs1\?
                                    clc
                                    ldx #zp_bss-zero_page ;zeropage - write test area
                        ccs3\?      adc zero_page,x
                                    bcc ccs2\?
                                    inc zpt+3       ;carry to high byte
                                    clc
                        ccs2\?      inx
                                    bne ccs3\?
                                    ldx #hi(abs1)   ;set high byte of indirect pointer
                                    stx zpt+1
                                    ldy #lo(abs1)   ;data after write & execute test area
                        ccs5\?      adc (zpt),y
                                    bcc ccs4\?
                                    inc zpt+3       ;carry to high byte
                                    clc
                        ccs4\?      iny
                                    bne ccs5\?
                                    inx             ;advance RAM high address
                                    stx zpt+1
                                    cpx #ram_top
                                    bne ccs5\?
                                    sta zpt+2       ;checksum low is
                                    cmp ram_chksm   ;checksum low expected
                                    trap_ne         ;checksum mismatch
                                    lda zpt+3       ;checksum high is
                                    cmp ram_chksm+1 ;checksum high expected
                                    trap_ne         ;checksum mismatch
                                    endm            
                                else
                        check_ram   macro
                                    ;RAM check disabled - RAM size not set
                                    endm
                                endif
                                    
                        next_test   macro           ;make sure, tests don't jump the fence
                                    lda test_case   ;previous test
                                    cmp #test_num
                                    trap_ne         ;test is out of sequence
                        test_num = test_num + 1
                                    lda #test_num   ;*** next tests' number
                                    sta test_case
                                    ;check_ram       ;uncomment to find altered RAM after each test
                                    endm
                        
                            if load_data_direct = 1
                                data
                            else
                                bss                 ;uninitialized segment, copy of data at end of code!
                            endif
0050 =                          org zero_page
                        ;break test interrupt save
0050 =                  irq_a   ds  1               ;a register
0051 =                  irq_x   ds  1               ;x register
                            if I_flag = 2
                        ;masking for I bit in status
                        flag_I_on   ds  1           ;or mask to load flags   
                        flag_I_off  ds  1           ;and mask to load flags
                            endif
0052 =                  zpt                         ;5 bytes store/modify test area
                        ;add/subtract operand generation and result/flag prediction
0052 =                  adfc    ds  1               ;carry flag before op
0053 =                  ad1     ds  1               ;operand 1 - accumulator
0054 =                  ad2     ds  1               ;operand 2 - memory / immediate
0055 =                  adrl    ds  1               ;expected result bits 0-7
0056 =                  adrh    ds  1               ;expected result bit 8 (carry)
0057 =                  adrf    ds  1               ;expected flags NV0000ZC (-V in decimal mode)
0058 =                  sb2     ds  1               ;operand 2 complemented for subtract
0059 =                  zp_bss
0059 =                  zp1     db  $c3,$82,$41,0   ;test patterns for LDx BIT ROL ROR ASL LSR
005d =                  zp7f    db  $7f             ;test pattern for compare  
                        ;logical zeropage operands
005e =                  zpOR    db  0,$1f,$71,$80   ;test pattern for OR
0062 =                  zpAN    db  $0f,$ff,$7f,$80 ;test pattern for AND
0066 =                  zpEO    db  $ff,$0f,$8f,$8f ;test pattern for EOR
                        ;indirect addressing pointers
006a =                  ind1    dw  abs1            ;indirect pointer to pattern in absolute memory
006c =                          dw  abs1+1
006e =                          dw  abs1+2
0070 =                          dw  abs1+3
0072 =                          dw  abs7f
0074 =                  inw1    dw  abs1-$f8        ;indirect pointer for wrap-test pattern
0076 =                  indt    dw  abst            ;indirect pointer to store area in absolute memory
0078 =                          dw  abst+1
007a =                          dw  abst+2
007c =                          dw  abst+3
007e =                  inwt    dw  abst-$f8        ;indirect pointer for wrap-test store
0080 =                  indAN   dw  absAN           ;indirect pointer to AND pattern in absolute memory
0082 =                          dw  absAN+1
0084 =                          dw  absAN+2
0086 =                          dw  absAN+3
0088 =                  indEO   dw  absEO           ;indirect pointer to EOR pattern in absolute memory
008a =                          dw  absEO+1
008c =                          dw  absEO+2
008e =                          dw  absEO+3
0090 =                  indOR   dw  absOR           ;indirect pointer to OR pattern in absolute memory
0092 =                          dw  absOR+1
0094 =                          dw  absOR+2
0096 =                          dw  absOR+3
                        ;add/subtract indirect pointers
0098 =                  adi2    dw  ada2            ;indirect pointer to operand 2 in absolute memory
009a =                  sbi2    dw  sba2            ;indirect pointer to complemented operand 2 (SBC)
009c =                  adiy2   dw  ada2-$ff        ;with offset for indirect indexed
009e =                  sbiy2   dw  sba2-$ff
00a0 =                  zp_bss_end
                            
1100 =                          org data_segment
1100 =                  pg_x    ds  2               ;high JMP indirect address for page cross bug
1102 =                  test_case   ds  1           ;current test number
1103 =                  ram_chksm   ds  2           ;checksum for RAM integrity test
                        ;add/subtract operand copy - abs tests write area
1105 =                  abst                        ;5 bytes store/modify test area
1105 =                  ada2    ds  1               ;operand 2
1106 =                  sba2    ds  1               ;operand 2 complemented for subtract
1107 =                          ds  3               ;fill remaining bytes
110a =                  data_bss
                            if load_data_direct = 1
                        ex_adci adc #0              ;execute immediate opcodes
                                rts
                        ex_sbci sbc #0              ;execute immediate opcodes
                                rts
                            else
110a =                  ex_adci ds  3
110d =                  ex_sbci ds  3
                            endif
1110 =                  abs1    db  $c3,$82,$41,0   ;test patterns for LDx BIT ROL ROR ASL LSR
1114 =                  abs7f   db  $7f             ;test pattern for compare
                        ;loads
1115 =                  fLDx    db  fn,fn,0,fz      ;expected flags for load
                        ;shifts
1119 =                  rASL                        ;expected result ASL & ROL -carry  
1119 =                  rROL    db  $86,$04,$82,0   ; "
111d =                  rROLc   db  $87,$05,$83,1   ;expected result ROL +carry
1121 =                  rLSR                        ;expected result LSR & ROR -carry
1121 =                  rROR    db  $61,$41,$20,0   ; "
1125 =                  rRORc   db  $e1,$c1,$a0,$80 ;expected result ROR +carry
1129 =                  fASL                        ;expected flags for shifts
1129 =                  fROL    db  fnc,fc,fn,fz    ;no carry in
112d =                  fROLc   db  fnc,fc,fn,0     ;carry in
1131 =                  fLSR
1131 =                  fROR    db  fc,0,fc,fz      ;no carry in
1135 =                  fRORc   db  fnc,fn,fnc,fn   ;carry in
                        ;increments (decrements)
1139 =                  rINC    db  $7f,$80,$ff,0,1 ;expected result for INC/DEC
113e =                  fINC    db  0,fn,fn,fz,0    ;expected flags for INC/DEC
                        ;logical memory operand
1143 =                  absOR   db  0,$1f,$71,$80   ;test pattern for OR
1147 =                  absAN   db  $0f,$ff,$7f,$80 ;test pattern for AND
114b =                  absEO   db  $ff,$0f,$8f,$8f ;test pattern for EOR
                        ;logical accu operand
114f =                  absORa  db  0,$f1,$1f,0     ;test pattern for OR
1153 =                  absANa  db  $f0,$ff,$ff,$ff ;test pattern for AND
1157 =                  absEOa  db  $ff,$f0,$f0,$0f ;test pattern for EOR
                        ;logical results
115b =                  absrlo  db  0,$ff,$7f,$80
115f =                  absflo  db  fz,fn,0,fn
1163 =                  data_bss_end
                        ;define area for page crossing JMP (abs) & JMP (abs,x) test
11f9 =                  jxi_tab equ data_segment + $100 - 7     ;JMP (jxi_tab,x) x=6
11fd =                  ji_tab  equ data_segment + $100 - 3     ;JMP (ji_tab+2)
1200 =                  jxp_tab equ data_segment + $100         ;JMP (jxp_tab-255) x=255
                        
                        
                                code
1300 =                          org code_segment
1300 : d8               start   cld
1301 : a2ff                     ldx #$ff
1303 : 9a                       txs
1304 : a900                     lda #0          ;*** test 0 = initialize
1306 : 8d0211                   sta test_case
0000 =                  test_num = 0
                        
                        ;stop interrupts before initializing BSS
                            if I_flag = 1
                                sei
                            endif
                            
                        ;initialize I/O for report channel
                            if report = 1
1309 : 20b840                   jsr report_init
                            endif
                            
                        ;initialize BSS segment
                            if load_data_direct != 1
130c : a246                     ldx #zp_end-zp_init-1
130e : bd6242           ld_zp   lda zp_init,x
1311 : 9559                     sta zp_bss,x
1313 : ca                       dex
1314 : 10f8                     bpl ld_zp
1316 : a258                     ldx #data_end-data_init-1
1318 : bda942           ld_data lda data_init,x
131b : 9d0a11                   sta data_bss,x
131e : ca                       dex
131f : 10f7                     bpl ld_data
                              if ROM_vectors = 1
                                ldx #5
                        ld_vect lda vec_init,x
                                sta vec_bss,x
                                dex
                                bpl ld_vect
                              endif
                            endif
                        
                        ;retain status of interrupt flag
                            if I_flag = 2
                                php
                                pla
                                and #4          ;isolate flag
                                sta flag_I_on   ;or mask
                                eor #lo(~4)     ;reverse
                                sta flag_I_off  ;and mask
                            endif
                                
                        ;generate checksum for RAM integrity test
                            if ram_top > -1
                                lda #0 
                                sta zpt         ;set low byte of indirect pointer
                                sta ram_chksm+1 ;checksum high byte
                                ldx #11         ;reset modifiable RAM
                        gcs1    sta jxi_tab,x   ;JMP indirect page cross area
                                dex
                                bpl gcs1
                                clc
                                ldx #zp_bss-zero_page ;zeropage - write test area
                        gcs3    adc zero_page,x
                                bcc gcs2
                                inc ram_chksm+1 ;carry to high byte
                                clc
                        gcs2    inx
                                bne gcs3
                                ldx #hi(abs1)   ;set high byte of indirect pointer
                                stx zpt+1
                                ldy #lo(abs1)   ;data after write & execute test area
                        gcs5    adc (zpt),y
                                bcc gcs4
                                inc ram_chksm+1 ;carry to high byte
                                clc
                        gcs4    iny
                                bne gcs5
                                inx             ;advance RAM high address
                                stx zpt+1
                                cpx #ram_top
                                bne gcs5
                                sta ram_chksm   ;checksum complete
                            endif
                                next_test            
1321 : ad0211          >            lda test_case   ;previous test
1324 : c900            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
1326 : f003            >        beq skip0002
                       >        trap            ;failed not equal (non zero)
1328 : 20c740          >        jsr report_error
                       >
132b :                 >skip0002
                       >
0001 =                 >test_num = test_num + 1
132b : a901            >            lda #test_num   ;*** next tests' number
132d : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                        ;testing stack operations PHX PHY PLX PLY
1330 : a999                     lda #$99        ;protect a
1332 : a2ff                     ldx #$ff        ;initialize stack
1334 : 9a                       txs
1335 : a255                     ldx #$55
1337 : da                       phx
1338 : a2aa                     ldx #$aa
133a : da                       phx
133b : ecfe01                   cpx $1fe        ;on stack ?
                                trap_ne
133e : f003            >        beq skip0004
                       >        trap            ;failed not equal (non zero)
1340 : 20c740          >        jsr report_error
                       >
1343 :                 >skip0004
                        
1343 : ba                       tsx
1344 : e0fd                     cpx #$fd        ;sp decremented?
                                trap_ne
1346 : f003            >        beq skip0006
                       >        trap            ;failed not equal (non zero)
1348 : 20c740          >        jsr report_error
                       >
134b :                 >skip0006
                        
134b : 7a                       ply
134c : c0aa                     cpy #$aa        ;successful retreived from stack?
                                trap_ne
134e : f003            >        beq skip0008
                       >        trap            ;failed not equal (non zero)
1350 : 20c740          >        jsr report_error
                       >
1353 :                 >skip0008
                        
1353 : 7a                       ply
1354 : c055                     cpy #$55
                                trap_ne
1356 : f003            >        beq skip0010
                       >        trap            ;failed not equal (non zero)
1358 : 20c740          >        jsr report_error
                       >
135b :                 >skip0010
                        
135b : ccff01                   cpy $1ff        ;remains on stack?
                                trap_ne
135e : f003            >        beq skip0012
                       >        trap            ;failed not equal (non zero)
1360 : 20c740          >        jsr report_error
                       >
1363 :                 >skip0012
                        
1363 : ba                       tsx
1364 : e0ff                     cpx #$ff        ;sp incremented?
                                trap_ne
1366 : f003            >        beq skip0014
                       >        trap            ;failed not equal (non zero)
1368 : 20c740          >        jsr report_error
                       >
136b :                 >skip0014
                        
                                
136b : a0a5                     ldy #$a5
136d : 5a                       phy
136e : a05a                     ldy #$5a
1370 : 5a                       phy
1371 : ccfe01                   cpy $1fe        ;on stack ?
                                trap_ne
1374 : f003            >        beq skip0016
                       >        trap            ;failed not equal (non zero)
1376 : 20c740          >        jsr report_error
                       >
1379 :                 >skip0016
                        
1379 : ba                       tsx
137a : e0fd                     cpx #$fd        ;sp decremented?
                                trap_ne
137c : f003            >        beq skip0018
                       >        trap            ;failed not equal (non zero)
137e : 20c740          >        jsr report_error
                       >
1381 :                 >skip0018
                        
1381 : fa                       plx
1382 : e05a                     cpx #$5a        ;successful retreived from stack?
                                trap_ne
1384 : f003            >        beq skip0020
                       >        trap            ;failed not equal (non zero)
1386 : 20c740          >        jsr report_error
                       >
1389 :                 >skip0020
                        
1389 : fa                       plx
138a : e0a5                     cpx #$a5
                                trap_ne
138c : f003            >        beq skip0022
                       >        trap            ;failed not equal (non zero)
138e : 20c740          >        jsr report_error
                       >
1391 :                 >skip0022
                        
1391 : ecff01                   cpx $1ff        ;remains on stack?
                                trap_ne
1394 : f003            >        beq skip0024
                       >        trap            ;failed not equal (non zero)
1396 : 20c740          >        jsr report_error
                       >
1399 :                 >skip0024
                        
1399 : ba                       tsx
139a : e0ff                     cpx #$ff        ;sp incremented?
                                trap_ne
139c : f003            >        beq skip0026
                       >        trap            ;failed not equal (non zero)
139e : 20c740          >        jsr report_error
                       >
13a1 :                 >skip0026
                        
13a1 : c999                     cmp #$99        ;unchanged?
                                trap_ne
13a3 : f003            >        beq skip0028
                       >        trap            ;failed not equal (non zero)
13a5 : 20c740          >        jsr report_error
                       >
13a8 :                 >skip0028
                        
                                next_test            
13a8 : ad0211          >            lda test_case   ;previous test
13ab : c901            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
13ad : f003            >        beq skip0031
                       >        trap            ;failed not equal (non zero)
13af : 20c740          >        jsr report_error
                       >
13b2 :                 >skip0031
                       >
0002 =                 >test_num = test_num + 1
13b2 : a902            >            lda #test_num   ;*** next tests' number
13b4 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                                
                        ; test PHX does not alter flags or X but PLX does
13b7 : a0aa                     ldy #$aa        ;protect y
                                set_x 1,$ff     ;push
                       >            load_flag $ff     
13b9 : a9ff            >            lda #$ff                  ;allow test to change I-flag (no mask)
                       >
13bb : 48              >            pha         ;use stack to load status
13bc : a201            >            ldx #1     ;precharge index x
13be : 28              >            plp
                        
13bf : da                       phx
                                tst_x 1,$ff
13c0 : 08              >            php         ;save flags
13c1 : e001            >            cpx #1     ;test result
                       >            trap_ne
13c3 : f003            >        beq skip0036
                       >        trap            ;failed not equal (non zero)
13c5 : 20c740          >        jsr report_error
                       >
13c8 :                 >skip0036
                       >
13c8 : 68              >            pla         ;load status
13c9 : 48              >            pha
                       >            cmp_flag $ff
13ca : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
13cc : f003            >        beq skip0039
                       >        trap            ;failed not equal (non zero)
13ce : 20c740          >        jsr report_error
                       >
13d1 :                 >skip0039
                       >
13d1 : 28              >            plp         ;restore status
                        
                                set_x 0,0
                       >            load_flag 0
13d2 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
13d4 : 48              >            pha         ;use stack to load status
13d5 : a200            >            ldx #0     ;precharge index x
13d7 : 28              >            plp
                        
13d8 : da                       phx
                                tst_x 0,0
13d9 : 08              >            php         ;save flags
13da : e000            >            cpx #0     ;test result
                       >            trap_ne
13dc : f003            >        beq skip0044
                       >        trap            ;failed not equal (non zero)
13de : 20c740          >        jsr report_error
                       >
13e1 :                 >skip0044
                       >
13e1 : 68              >            pla         ;load status
13e2 : 48              >            pha
                       >            cmp_flag 0
13e3 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
13e5 : f003            >        beq skip0047
                       >        trap            ;failed not equal (non zero)
13e7 : 20c740          >        jsr report_error
                       >
13ea :                 >skip0047
                       >
13ea : 28              >            plp         ;restore status
                        
                                set_x $ff,$ff
                       >            load_flag $ff
13eb : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
13ed : 48              >            pha         ;use stack to load status
13ee : a2ff            >            ldx #$ff     ;precharge index x
13f0 : 28              >            plp
                        
13f1 : da                       phx
                                tst_x $ff,$ff
13f2 : 08              >            php         ;save flags
13f3 : e0ff            >            cpx #$ff     ;test result
                       >            trap_ne
13f5 : f003            >        beq skip0052
                       >        trap            ;failed not equal (non zero)
13f7 : 20c740          >        jsr report_error
                       >
13fa :                 >skip0052
                       >
13fa : 68              >            pla         ;load status
13fb : 48              >            pha
                       >            cmp_flag $ff
13fc : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
13fe : f003            >        beq skip0055
                       >        trap            ;failed not equal (non zero)
1400 : 20c740          >        jsr report_error
                       >
1403 :                 >skip0055
                       >
1403 : 28              >            plp         ;restore status
                        
                                set_x 1,0
                       >            load_flag 0
1404 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1406 : 48              >            pha         ;use stack to load status
1407 : a201            >            ldx #1     ;precharge index x
1409 : 28              >            plp
                        
140a : da                       phx
                                tst_x 1,0
140b : 08              >            php         ;save flags
140c : e001            >            cpx #1     ;test result
                       >            trap_ne
140e : f003            >        beq skip0060
                       >        trap            ;failed not equal (non zero)
1410 : 20c740          >        jsr report_error
                       >
1413 :                 >skip0060
                       >
1413 : 68              >            pla         ;load status
1414 : 48              >            pha
                       >            cmp_flag 0
1415 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1417 : f003            >        beq skip0063
                       >        trap            ;failed not equal (non zero)
1419 : 20c740          >        jsr report_error
                       >
141c :                 >skip0063
                       >
141c : 28              >            plp         ;restore status
                        
                                set_x 0,$ff
                       >            load_flag $ff
141d : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
141f : 48              >            pha         ;use stack to load status
1420 : a200            >            ldx #0     ;precharge index x
1422 : 28              >            plp
                        
1423 : da                       phx
                                tst_x 0,$ff
1424 : 08              >            php         ;save flags
1425 : e000            >            cpx #0     ;test result
                       >            trap_ne
1427 : f003            >        beq skip0068
                       >        trap            ;failed not equal (non zero)
1429 : 20c740          >        jsr report_error
                       >
142c :                 >skip0068
                       >
142c : 68              >            pla         ;load status
142d : 48              >            pha
                       >            cmp_flag $ff
142e : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1430 : f003            >        beq skip0071
                       >        trap            ;failed not equal (non zero)
1432 : 20c740          >        jsr report_error
                       >
1435 :                 >skip0071
                       >
1435 : 28              >            plp         ;restore status
                        
                                set_x $ff,0
                       >            load_flag 0
1436 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1438 : 48              >            pha         ;use stack to load status
1439 : a2ff            >            ldx #$ff     ;precharge index x
143b : 28              >            plp
                        
143c : da                       phx
                                tst_x $ff,0
143d : 08              >            php         ;save flags
143e : e0ff            >            cpx #$ff     ;test result
                       >            trap_ne
1440 : f003            >        beq skip0076
                       >        trap            ;failed not equal (non zero)
1442 : 20c740          >        jsr report_error
                       >
1445 :                 >skip0076
                       >
1445 : 68              >            pla         ;load status
1446 : 48              >            pha
                       >            cmp_flag 0
1447 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1449 : f003            >        beq skip0079
                       >        trap            ;failed not equal (non zero)
144b : 20c740          >        jsr report_error
                       >
144e :                 >skip0079
                       >
144e : 28              >            plp         ;restore status
                        
                                set_x 0,$ff     ;pull
                       >            load_flag $ff     
144f : a9ff            >            lda #$ff                  ;allow test to change I-flag (no mask)
                       >
1451 : 48              >            pha         ;use stack to load status
1452 : a200            >            ldx #0     ;precharge index x
1454 : 28              >            plp
                        
1455 : fa                       plx
                                tst_x $ff,$ff-zero
1456 : 08              >            php         ;save flags
1457 : e0ff            >            cpx #$ff     ;test result
                       >            trap_ne
1459 : f003            >        beq skip0084
                       >        trap            ;failed not equal (non zero)
145b : 20c740          >        jsr report_error
                       >
145e :                 >skip0084
                       >
145e : 68              >            pla         ;load status
145f : 48              >            pha
                       >            cmp_flag $ff-zero
1460 : c9fd            >            cmp #($ff-zero|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1462 : f003            >        beq skip0087
                       >        trap            ;failed not equal (non zero)
1464 : 20c740          >        jsr report_error
                       >
1467 :                 >skip0087
                       >
1467 : 28              >            plp         ;restore status
                        
                                set_x $ff,0
                       >            load_flag 0
1468 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
146a : 48              >            pha         ;use stack to load status
146b : a2ff            >            ldx #$ff     ;precharge index x
146d : 28              >            plp
                        
146e : fa                       plx
                                tst_x 0,zero
146f : 08              >            php         ;save flags
1470 : e000            >            cpx #0     ;test result
                       >            trap_ne
1472 : f003            >        beq skip0092
                       >        trap            ;failed not equal (non zero)
1474 : 20c740          >        jsr report_error
                       >
1477 :                 >skip0092
                       >
1477 : 68              >            pla         ;load status
1478 : 48              >            pha
                       >            cmp_flag zero
1479 : c932            >            cmp #(zero|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
147b : f003            >        beq skip0095
                       >        trap            ;failed not equal (non zero)
147d : 20c740          >        jsr report_error
                       >
1480 :                 >skip0095
                       >
1480 : 28              >            plp         ;restore status
                        
                                set_x $fe,$ff
                       >            load_flag $ff
1481 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1483 : 48              >            pha         ;use stack to load status
1484 : a2fe            >            ldx #$fe     ;precharge index x
1486 : 28              >            plp
                        
1487 : fa                       plx
                                tst_x 1,$ff-zero-minus
1488 : 08              >            php         ;save flags
1489 : e001            >            cpx #1     ;test result
                       >            trap_ne
148b : f003            >        beq skip0100
                       >        trap            ;failed not equal (non zero)
148d : 20c740          >        jsr report_error
                       >
1490 :                 >skip0100
                       >
1490 : 68              >            pla         ;load status
1491 : 48              >            pha
                       >            cmp_flag $ff-zero-minus
1492 : c97d            >            cmp #($ff-zero-minus|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1494 : f003            >        beq skip0103
                       >        trap            ;failed not equal (non zero)
1496 : 20c740          >        jsr report_error
                       >
1499 :                 >skip0103
                       >
1499 : 28              >            plp         ;restore status
                        
                                set_x 0,0
                       >            load_flag 0
149a : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
149c : 48              >            pha         ;use stack to load status
149d : a200            >            ldx #0     ;precharge index x
149f : 28              >            plp
                        
14a0 : fa                       plx
                                tst_x $ff,minus
14a1 : 08              >            php         ;save flags
14a2 : e0ff            >            cpx #$ff     ;test result
                       >            trap_ne
14a4 : f003            >        beq skip0108
                       >        trap            ;failed not equal (non zero)
14a6 : 20c740          >        jsr report_error
                       >
14a9 :                 >skip0108
                       >
14a9 : 68              >            pla         ;load status
14aa : 48              >            pha
                       >            cmp_flag minus
14ab : c9b0            >            cmp #(minus|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
14ad : f003            >        beq skip0111
                       >        trap            ;failed not equal (non zero)
14af : 20c740          >        jsr report_error
                       >
14b2 :                 >skip0111
                       >
14b2 : 28              >            plp         ;restore status
                        
                                set_x $ff,$ff
                       >            load_flag $ff
14b3 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
14b5 : 48              >            pha         ;use stack to load status
14b6 : a2ff            >            ldx #$ff     ;precharge index x
14b8 : 28              >            plp
                        
14b9 : fa                       plx
                                tst_x 0,$ff-minus
14ba : 08              >            php         ;save flags
14bb : e000            >            cpx #0     ;test result
                       >            trap_ne
14bd : f003            >        beq skip0116
                       >        trap            ;failed not equal (non zero)
14bf : 20c740          >        jsr report_error
                       >
14c2 :                 >skip0116
                       >
14c2 : 68              >            pla         ;load status
14c3 : 48              >            pha
                       >            cmp_flag $ff-minus
14c4 : c97f            >            cmp #($ff-minus|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
14c6 : f003            >        beq skip0119
                       >        trap            ;failed not equal (non zero)
14c8 : 20c740          >        jsr report_error
                       >
14cb :                 >skip0119
                       >
14cb : 28              >            plp         ;restore status
                        
                                set_x $fe,0
                       >            load_flag 0
14cc : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
14ce : 48              >            pha         ;use stack to load status
14cf : a2fe            >            ldx #$fe     ;precharge index x
14d1 : 28              >            plp
                        
14d2 : fa                       plx
                                tst_x 1,0
14d3 : 08              >            php         ;save flags
14d4 : e001            >            cpx #1     ;test result
                       >            trap_ne
14d6 : f003            >        beq skip0124
                       >        trap            ;failed not equal (non zero)
14d8 : 20c740          >        jsr report_error
                       >
14db :                 >skip0124
                       >
14db : 68              >            pla         ;load status
14dc : 48              >            pha
                       >            cmp_flag 0
14dd : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
14df : f003            >        beq skip0127
                       >        trap            ;failed not equal (non zero)
14e1 : 20c740          >        jsr report_error
                       >
14e4 :                 >skip0127
                       >
14e4 : 28              >            plp         ;restore status
                        
14e5 : c0aa                     cpy #$aa        ;Y unchanged
                                trap_ne
14e7 : f003            >        beq skip0129
                       >        trap            ;failed not equal (non zero)
14e9 : 20c740          >        jsr report_error
                       >
14ec :                 >skip0129
                        
                                next_test            
14ec : ad0211          >            lda test_case   ;previous test
14ef : c902            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
14f1 : f003            >        beq skip0132
                       >        trap            ;failed not equal (non zero)
14f3 : 20c740          >        jsr report_error
                       >
14f6 :                 >skip0132
                       >
0003 =                 >test_num = test_num + 1
14f6 : a903            >            lda #test_num   ;*** next tests' number
14f8 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                         
                        ; test PHY does not alter flags or Y but PLY does
14fb : a255                     ldx #$55        ;x & a protected
                                set_y 1,$ff     ;push
                       >            load_flag $ff     
14fd : a9ff            >            lda #$ff                  ;allow test to change I-flag (no mask)
                       >
14ff : 48              >            pha         ;use stack to load status
1500 : a001            >            ldy #1     ;precharge index y
1502 : 28              >            plp
                        
1503 : 5a                       phy
                                tst_y 1,$ff
1504 : 08              >            php         ;save flags
1505 : c001            >            cpy #1     ;test result
                       >            trap_ne
1507 : f003            >        beq skip0137
                       >        trap            ;failed not equal (non zero)
1509 : 20c740          >        jsr report_error
                       >
150c :                 >skip0137
                       >
150c : 68              >            pla         ;load status
150d : 48              >            pha
                       >            cmp_flag $ff
150e : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1510 : f003            >        beq skip0140
                       >        trap            ;failed not equal (non zero)
1512 : 20c740          >        jsr report_error
                       >
1515 :                 >skip0140
                       >
1515 : 28              >            plp         ;restore status
                        
                                set_y 0,0
                       >            load_flag 0
1516 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1518 : 48              >            pha         ;use stack to load status
1519 : a000            >            ldy #0     ;precharge index y
151b : 28              >            plp
                        
151c : 5a                       phy
                                tst_y 0,0
151d : 08              >            php         ;save flags
151e : c000            >            cpy #0     ;test result
                       >            trap_ne
1520 : f003            >        beq skip0145
                       >        trap            ;failed not equal (non zero)
1522 : 20c740          >        jsr report_error
                       >
1525 :                 >skip0145
                       >
1525 : 68              >            pla         ;load status
1526 : 48              >            pha
                       >            cmp_flag 0
1527 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1529 : f003            >        beq skip0148
                       >        trap            ;failed not equal (non zero)
152b : 20c740          >        jsr report_error
                       >
152e :                 >skip0148
                       >
152e : 28              >            plp         ;restore status
                        
                                set_y $ff,$ff
                       >            load_flag $ff
152f : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1531 : 48              >            pha         ;use stack to load status
1532 : a0ff            >            ldy #$ff     ;precharge index y
1534 : 28              >            plp
                        
1535 : 5a                       phy
                                tst_y $ff,$ff
1536 : 08              >            php         ;save flags
1537 : c0ff            >            cpy #$ff     ;test result
                       >            trap_ne
1539 : f003            >        beq skip0153
                       >        trap            ;failed not equal (non zero)
153b : 20c740          >        jsr report_error
                       >
153e :                 >skip0153
                       >
153e : 68              >            pla         ;load status
153f : 48              >            pha
                       >            cmp_flag $ff
1540 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1542 : f003            >        beq skip0156
                       >        trap            ;failed not equal (non zero)
1544 : 20c740          >        jsr report_error
                       >
1547 :                 >skip0156
                       >
1547 : 28              >            plp         ;restore status
                        
                                set_y 1,0
                       >            load_flag 0
1548 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
154a : 48              >            pha         ;use stack to load status
154b : a001            >            ldy #1     ;precharge index y
154d : 28              >            plp
                        
154e : 5a                       phy
                                tst_y 1,0
154f : 08              >            php         ;save flags
1550 : c001            >            cpy #1     ;test result
                       >            trap_ne
1552 : f003            >        beq skip0161
                       >        trap            ;failed not equal (non zero)
1554 : 20c740          >        jsr report_error
                       >
1557 :                 >skip0161
                       >
1557 : 68              >            pla         ;load status
1558 : 48              >            pha
                       >            cmp_flag 0
1559 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
155b : f003            >        beq skip0164
                       >        trap            ;failed not equal (non zero)
155d : 20c740          >        jsr report_error
                       >
1560 :                 >skip0164
                       >
1560 : 28              >            plp         ;restore status
                        
                                set_y 0,$ff
                       >            load_flag $ff
1561 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1563 : 48              >            pha         ;use stack to load status
1564 : a000            >            ldy #0     ;precharge index y
1566 : 28              >            plp
                        
1567 : 5a                       phy
                                tst_y 0,$ff
1568 : 08              >            php         ;save flags
1569 : c000            >            cpy #0     ;test result
                       >            trap_ne
156b : f003            >        beq skip0169
                       >        trap            ;failed not equal (non zero)
156d : 20c740          >        jsr report_error
                       >
1570 :                 >skip0169
                       >
1570 : 68              >            pla         ;load status
1571 : 48              >            pha
                       >            cmp_flag $ff
1572 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1574 : f003            >        beq skip0172
                       >        trap            ;failed not equal (non zero)
1576 : 20c740          >        jsr report_error
                       >
1579 :                 >skip0172
                       >
1579 : 28              >            plp         ;restore status
                        
                                set_y $ff,0
                       >            load_flag 0
157a : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
157c : 48              >            pha         ;use stack to load status
157d : a0ff            >            ldy #$ff     ;precharge index y
157f : 28              >            plp
                        
1580 : 5a                       phy
                                tst_y $ff,0
1581 : 08              >            php         ;save flags
1582 : c0ff            >            cpy #$ff     ;test result
                       >            trap_ne
1584 : f003            >        beq skip0177
                       >        trap            ;failed not equal (non zero)
1586 : 20c740          >        jsr report_error
                       >
1589 :                 >skip0177
                       >
1589 : 68              >            pla         ;load status
158a : 48              >            pha
                       >            cmp_flag 0
158b : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
158d : f003            >        beq skip0180
                       >        trap            ;failed not equal (non zero)
158f : 20c740          >        jsr report_error
                       >
1592 :                 >skip0180
                       >
1592 : 28              >            plp         ;restore status
                        
                                set_y 0,$ff     ;pull
                       >            load_flag $ff     
1593 : a9ff            >            lda #$ff                  ;allow test to change I-flag (no mask)
                       >
1595 : 48              >            pha         ;use stack to load status
1596 : a000            >            ldy #0     ;precharge index y
1598 : 28              >            plp
                        
1599 : 7a                       ply
                                tst_y $ff,$ff-zero
159a : 08              >            php         ;save flags
159b : c0ff            >            cpy #$ff     ;test result
                       >            trap_ne
159d : f003            >        beq skip0185
                       >        trap            ;failed not equal (non zero)
159f : 20c740          >        jsr report_error
                       >
15a2 :                 >skip0185
                       >
15a2 : 68              >            pla         ;load status
15a3 : 48              >            pha
                       >            cmp_flag $ff-zero
15a4 : c9fd            >            cmp #($ff-zero|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
15a6 : f003            >        beq skip0188
                       >        trap            ;failed not equal (non zero)
15a8 : 20c740          >        jsr report_error
                       >
15ab :                 >skip0188
                       >
15ab : 28              >            plp         ;restore status
                        
                                set_y $ff,0
                       >            load_flag 0
15ac : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
15ae : 48              >            pha         ;use stack to load status
15af : a0ff            >            ldy #$ff     ;precharge index y
15b1 : 28              >            plp
                        
15b2 : 7a                       ply
                                tst_y 0,zero
15b3 : 08              >            php         ;save flags
15b4 : c000            >            cpy #0     ;test result
                       >            trap_ne
15b6 : f003            >        beq skip0193
                       >        trap            ;failed not equal (non zero)
15b8 : 20c740          >        jsr report_error
                       >
15bb :                 >skip0193
                       >
15bb : 68              >            pla         ;load status
15bc : 48              >            pha
                       >            cmp_flag zero
15bd : c932            >            cmp #(zero|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
15bf : f003            >        beq skip0196
                       >        trap            ;failed not equal (non zero)
15c1 : 20c740          >        jsr report_error
                       >
15c4 :                 >skip0196
                       >
15c4 : 28              >            plp         ;restore status
                        
                                set_y $fe,$ff
                       >            load_flag $ff
15c5 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
15c7 : 48              >            pha         ;use stack to load status
15c8 : a0fe            >            ldy #$fe     ;precharge index y
15ca : 28              >            plp
                        
15cb : 7a                       ply
                                tst_y 1,$ff-zero-minus
15cc : 08              >            php         ;save flags
15cd : c001            >            cpy #1     ;test result
                       >            trap_ne
15cf : f003            >        beq skip0201
                       >        trap            ;failed not equal (non zero)
15d1 : 20c740          >        jsr report_error
                       >
15d4 :                 >skip0201
                       >
15d4 : 68              >            pla         ;load status
15d5 : 48              >            pha
                       >            cmp_flag $ff-zero-minus
15d6 : c97d            >            cmp #($ff-zero-minus|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
15d8 : f003            >        beq skip0204
                       >        trap            ;failed not equal (non zero)
15da : 20c740          >        jsr report_error
                       >
15dd :                 >skip0204
                       >
15dd : 28              >            plp         ;restore status
                        
                                set_y 0,0
                       >            load_flag 0
15de : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
15e0 : 48              >            pha         ;use stack to load status
15e1 : a000            >            ldy #0     ;precharge index y
15e3 : 28              >            plp
                        
15e4 : 7a                       ply
                                tst_y $ff,minus
15e5 : 08              >            php         ;save flags
15e6 : c0ff            >            cpy #$ff     ;test result
                       >            trap_ne
15e8 : f003            >        beq skip0209
                       >        trap            ;failed not equal (non zero)
15ea : 20c740          >        jsr report_error
                       >
15ed :                 >skip0209
                       >
15ed : 68              >            pla         ;load status
15ee : 48              >            pha
                       >            cmp_flag minus
15ef : c9b0            >            cmp #(minus|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
15f1 : f003            >        beq skip0212
                       >        trap            ;failed not equal (non zero)
15f3 : 20c740          >        jsr report_error
                       >
15f6 :                 >skip0212
                       >
15f6 : 28              >            plp         ;restore status
                        
                                set_y $ff,$ff
                       >            load_flag $ff
15f7 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
15f9 : 48              >            pha         ;use stack to load status
15fa : a0ff            >            ldy #$ff     ;precharge index y
15fc : 28              >            plp
                        
15fd : 7a                       ply
                                tst_y 0,$ff-minus
15fe : 08              >            php         ;save flags
15ff : c000            >            cpy #0     ;test result
                       >            trap_ne
1601 : f003            >        beq skip0217
                       >        trap            ;failed not equal (non zero)
1603 : 20c740          >        jsr report_error
                       >
1606 :                 >skip0217
                       >
1606 : 68              >            pla         ;load status
1607 : 48              >            pha
                       >            cmp_flag $ff-minus
1608 : c97f            >            cmp #($ff-minus|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
160a : f003            >        beq skip0220
                       >        trap            ;failed not equal (non zero)
160c : 20c740          >        jsr report_error
                       >
160f :                 >skip0220
                       >
160f : 28              >            plp         ;restore status
                        
                                set_y $fe,0
                       >            load_flag 0
1610 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1612 : 48              >            pha         ;use stack to load status
1613 : a0fe            >            ldy #$fe     ;precharge index y
1615 : 28              >            plp
                        
1616 : 7a                       ply
                                tst_y 1,0
1617 : 08              >            php         ;save flags
1618 : c001            >            cpy #1     ;test result
                       >            trap_ne
161a : f003            >        beq skip0225
                       >        trap            ;failed not equal (non zero)
161c : 20c740          >        jsr report_error
                       >
161f :                 >skip0225
                       >
161f : 68              >            pla         ;load status
1620 : 48              >            pha
                       >            cmp_flag 0
1621 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1623 : f003            >        beq skip0228
                       >        trap            ;failed not equal (non zero)
1625 : 20c740          >        jsr report_error
                       >
1628 :                 >skip0228
                       >
1628 : 28              >            plp         ;restore status
                        
1629 : e055                     cpx #$55        ;x unchanged?
                                trap_ne
162b : f003            >        beq skip0230
                       >        trap            ;failed not equal (non zero)
162d : 20c740          >        jsr report_error
                       >
1630 :                 >skip0230
                        
                                next_test            
1630 : ad0211          >            lda test_case   ;previous test
1633 : c903            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
1635 : f003            >        beq skip0233
                       >        trap            ;failed not equal (non zero)
1637 : 20c740          >        jsr report_error
                       >
163a :                 >skip0233
                       >
0004 =                 >test_num = test_num + 1
163a : a904            >            lda #test_num   ;*** next tests' number
163c : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                         
                        ; PC modifying instructions (BRA, BBR, BBS, 1, 2, 3 byte NOPs, JMP(abs,x))
                        ; testing unconditional branch BRA
                        
163f : a281                     ldx #$81        ;protect unused registers
1641 : a07e                     ldy #$7e
                                set_a 0,$ff
                       >            load_flag $ff
1643 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1645 : 48              >            pha         ;use stack to load status
1646 : a900            >            lda #0     ;precharge accu
1648 : 28              >            plp
                        
1649 : 8003                     bra br1         ;branch should always be taken
                                trap 
164b : 20c740          >        jsr report_error
                        
164e :                  br1
                                tst_a 0,$ff
164e : 08              >            php         ;save flags
164f : c900            >            cmp #0     ;test result
                       >            trap_ne
1651 : f003            >        beq skip0239
                       >        trap            ;failed not equal (non zero)
1653 : 20c740          >        jsr report_error
                       >
1656 :                 >skip0239
                       >
1656 : 68              >            pla         ;load status
1657 : 48              >            pha
                       >            cmp_flag $ff
1658 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
165a : f003            >        beq skip0242
                       >        trap            ;failed not equal (non zero)
165c : 20c740          >        jsr report_error
                       >
165f :                 >skip0242
                       >
165f : 28              >            plp         ;restore status
                        
                                set_a $ff,0
                       >            load_flag 0
1660 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1662 : 48              >            pha         ;use stack to load status
1663 : a9ff            >            lda #$ff     ;precharge accu
1665 : 28              >            plp
                        
1666 : 8003                     bra br2         ;branch should always be taken
                                trap 
1668 : 20c740          >        jsr report_error
                        
166b :                  br2
                                tst_a $ff,0
166b : 08              >            php         ;save flags
166c : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
166e : f003            >        beq skip0248
                       >        trap            ;failed not equal (non zero)
1670 : 20c740          >        jsr report_error
                       >
1673 :                 >skip0248
                       >
1673 : 68              >            pla         ;load status
1674 : 48              >            pha
                       >            cmp_flag 0
1675 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1677 : f003            >        beq skip0251
                       >        trap            ;failed not equal (non zero)
1679 : 20c740          >        jsr report_error
                       >
167c :                 >skip0251
                       >
167c : 28              >            plp         ;restore status
                        
167d : e081                     cpx #$81
                                trap_ne
167f : f003            >        beq skip0253
                       >        trap            ;failed not equal (non zero)
1681 : 20c740          >        jsr report_error
                       >
1684 :                 >skip0253
                        
1684 : c07e                     cpy #$7e
                                trap_ne
1686 : f003            >        beq skip0255
                       >        trap            ;failed not equal (non zero)
1688 : 20c740          >        jsr report_error
                       >
168b :                 >skip0255
                        
                                next_test            
168b : ad0211          >            lda test_case   ;previous test
168e : c904            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
1690 : f003            >        beq skip0258
                       >        trap            ;failed not equal (non zero)
1692 : 20c740          >        jsr report_error
                       >
1695 :                 >skip0258
                       >
0005 =                 >test_num = test_num + 1
1695 : a905            >            lda #test_num   ;*** next tests' number
1697 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                                
169a : a000                     ldy #0          ;branch range test  
169c : 8076                     bra bra0
                                
169e : c001             bra1    cpy #1
                                trap_ne         ;long range backward
16a0 : f003            >        beq skip0260
                       >        trap            ;failed not equal (non zero)
16a2 : 20c740          >        jsr report_error
                       >
16a5 :                 >skip0260
                        
16a5 : c8                       iny        
16a6 : 8062                     bra bra2
                                        
16a8 : c003             bra3    cpy #3
                                trap_ne         ;long range backward
16aa : f003            >        beq skip0262
                       >        trap            ;failed not equal (non zero)
16ac : 20c740          >        jsr report_error
                       >
16af :                 >skip0262
                        
16af : c8                       iny        
16b0 : 804e                     bra bra4
                                        
16b2 : c005             bra5    cpy #5
                                trap_ne         ;long range backward
16b4 : f003            >        beq skip0264
                       >        trap            ;failed not equal (non zero)
16b6 : 20c740          >        jsr report_error
                       >
16b9 :                 >skip0264
                        
16b9 : c8                       iny        
16ba : a000                     ldy #0
16bc : 8004                     bra brf0
                                
16be : c8                       iny
16bf : c8                       iny
16c0 : c8                       iny
16c1 : c8                       iny        
16c2 : 8003             brf0    bra brf1
                        
16c4 : c8                       iny
16c5 : c8                       iny
16c6 : c8                       iny
16c7 : c8               brf1    iny        
16c8 : 8002                     bra brf2
                                
16ca : c8                       iny
16cb : c8                       iny
16cc : c8               brf2    iny
16cd : c8                       iny        
16ce : 8001                     bra brf3
                                
16d0 : c8                       iny
16d1 : c8               brf3    iny
16d2 : c8                       iny
16d3 : c8                       iny        
16d4 : 8000                     bra brf4
                                
16d6 : c8               brf4    iny
16d7 : c8                       iny
16d8 : c8                       iny
16d9 : c8                       iny
16da : c00a                     cpy #10
                                trap_ne     ;short range forward
16dc : f003            >        beq skip0266
                       >        trap            ;failed not equal (non zero)
16de : 20c740          >        jsr report_error
                       >
16e1 :                 >skip0266
                        
16e1 : 8012                     bra brb0
                        
16e3 : 88               brb4    dey
16e4 : 88                       dey
16e5 : 88                       dey
16e6 : 88                       dey
16e7 : 800e                     bra brb5        
                        
16e9 : 88               brb3    dey
16ea : 88                       dey
16eb : 88                       dey
16ec : 80f5                     bra brb4        
                        
16ee : 88               brb2    dey
16ef : 88                       dey
16f0 : 80f7                     bra brb3        
                        
16f2 : 88               brb1    dey
16f3 : 80f9                     bra brb2        
                        
16f5 : 80fb             brb0    bra brb1        
                        
16f7 : c000             brb5    cpy #0
                                trap_ne     ;short range backward
16f9 : f003            >        beq skip0268
                       >        trap            ;failed not equal (non zero)
16fb : 20c740          >        jsr report_error
                       >
16fe :                 >skip0268
                        
16fe : 801e                     bra bra6
                        
1700 : c004             bra4    cpy #4
                                trap_ne     ;long range forward
1702 : f003            >        beq skip0270
                       >        trap            ;failed not equal (non zero)
1704 : 20c740          >        jsr report_error
                       >
1707 :                 >skip0270
                        
1707 : c8                       iny        
1708 : 80a8                     bra bra5
                                        
170a : c002             bra2    cpy #2
                                trap_ne     ;long range forward
170c : f003            >        beq skip0272
                       >        trap            ;failed not equal (non zero)
170e : 20c740          >        jsr report_error
                       >
1711 :                 >skip0272
                        
1711 : c8                       iny        
1712 : 8094                     bra bra3
                                        
1714 : c000             bra0    cpy #0
                                trap_ne     ;long range forward
1716 : f003            >        beq skip0274
                       >        trap            ;failed not equal (non zero)
1718 : 20c740          >        jsr report_error
                       >
171b :                 >skip0274
                        
171b : c8                       iny        
171c : 8080                     bra bra1
                                        
171e :                  bra6
                                next_test
171e : ad0211          >            lda test_case   ;previous test
1721 : c905            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
1723 : f003            >        beq skip0277
                       >        trap            ;failed not equal (non zero)
1725 : 20c740          >        jsr report_error
                       >
1728 :                 >skip0277
                       >
0006 =                 >test_num = test_num + 1
1728 : a906            >            lda #test_num   ;*** next tests' number
172a : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                                
                            if rkwl_wdc_op = 1
                        ; testing BBR & BBS
                        
                        bbt     macro           ;\1 = bitnum
                                lda #(1<<\1)    ;testing 1 bit on
                                sta zpt
                                set_a $33,0     ;with flags off
                                bbr \1,zpt,fail1\?
                                bbs \1,zpt,ok1\?
                                trap            ;bbs branch not taken
                        fail1\?
                                trap            ;bbr branch taken
                        ok1\?   
                                tst_a $33,0
                                set_a $cc,$ff   ;with flags on
                                bbr \1,zpt,fail2\?
                                bbs \1,zpt,ok2\?
                                trap            ;bbs branch not taken
                        fail2\? 
                                trap            ;bbr branch taken
                        ok2\?   
                                tst_a $cc,$ff
                                lda zpt
                                cmp #(1<<\1)
                                trap_ne         ;zp altered
                                lda #$ff-(1<<\1) ;testing 1 bit off
                                sta zpt
                                set_a $33,0     ;with flags off
                                bbs \1,zpt,fail3\?
                                bbr \1,zpt,ok3\?
                                trap            ;bbr branch not taken
                        fail3\? 
                                trap            ;bbs branch taken
                        ok3\?   
                                tst_a $33,0
                                set_a $cc,$ff   ;with flags on
                                bbs \1,zpt,fail4\?
                                bbr \1,zpt,ok4\?
                                trap            ;bbr branch not taken
                        fail4\? 
                                trap            ;bbs branch taken
                        ok4\?   
                                tst_a $cc,$ff
                                lda zpt
                                cmp #$ff-(1<<\1)
                                trap_ne         ;zp altered
                                endm
                        
172d : a211                     ldx #$11        ;test bbr/bbs integrity
172f : a022                     ldy #$22
                                bbt 0
1731 : a901            >        lda #(1<<0)    ;testing 1 bit on
1733 : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1735 : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
1737 : 48              >            pha         ;use stack to load status
1738 : a933            >            lda #$33     ;precharge accu
173a : 28              >            plp
                       >
173b : 0f5206          >        bbr 0,zpt,fail10279
173e : 8f5206          >        bbs 0,zpt,ok10279
                       >        trap            ;bbs branch not taken
1741 : 20c740          >        jsr report_error
                       >
1744 :                 >fail10279
                       >        trap            ;bbr branch taken
1744 : 20c740          >        jsr report_error
                       >
1747 :                 >ok10279   
                       >        tst_a $33,0
1747 : 08              >            php         ;save flags
1748 : c933            >            cmp #$33     ;test result
                       >            trap_ne
174a : f003            >        beq skip0285
                       >        trap            ;failed not equal (non zero)
174c : 20c740          >        jsr report_error
                       >
174f :                 >skip0285
                       >
174f : 68              >            pla         ;load status
1750 : 48              >            pha
                       >            cmp_flag 0
1751 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1753 : f003            >        beq skip0288
                       >        trap            ;failed not equal (non zero)
1755 : 20c740          >        jsr report_error
                       >
1758 :                 >skip0288
                       >
1758 : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1759 : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
175b : 48              >            pha         ;use stack to load status
175c : a9cc            >            lda #$cc     ;precharge accu
175e : 28              >            plp
                       >
175f : 0f5206          >        bbr 0,zpt,fail20279
1762 : 8f5206          >        bbs 0,zpt,ok20279
                       >        trap            ;bbs branch not taken
1765 : 20c740          >        jsr report_error
                       >
1768 :                 >fail20279 
                       >        trap            ;bbr branch taken
1768 : 20c740          >        jsr report_error
                       >
176b :                 >ok20279   
                       >        tst_a $cc,$ff
176b : 08              >            php         ;save flags
176c : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
176e : f003            >        beq skip0295
                       >        trap            ;failed not equal (non zero)
1770 : 20c740          >        jsr report_error
                       >
1773 :                 >skip0295
                       >
1773 : 68              >            pla         ;load status
1774 : 48              >            pha
                       >            cmp_flag $ff
1775 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1777 : f003            >        beq skip0298
                       >        trap            ;failed not equal (non zero)
1779 : 20c740          >        jsr report_error
                       >
177c :                 >skip0298
                       >
177c : 28              >            plp         ;restore status
                       >
177d : a552            >        lda zpt
177f : c901            >        cmp #(1<<0)
                       >        trap_ne         ;zp altered
1781 : f003            >        beq skip0300
                       >        trap            ;failed not equal (non zero)
1783 : 20c740          >        jsr report_error
                       >
1786 :                 >skip0300
                       >
1786 : a9fe            >        lda #$ff-(1<<0) ;testing 1 bit off
1788 : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
178a : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
178c : 48              >            pha         ;use stack to load status
178d : a933            >            lda #$33     ;precharge accu
178f : 28              >            plp
                       >
1790 : 8f5206          >        bbs 0,zpt,fail30279
1793 : 0f5206          >        bbr 0,zpt,ok30279
                       >        trap            ;bbr branch not taken
1796 : 20c740          >        jsr report_error
                       >
1799 :                 >fail30279 
                       >        trap            ;bbs branch taken
1799 : 20c740          >        jsr report_error
                       >
179c :                 >ok30279   
                       >        tst_a $33,0
179c : 08              >            php         ;save flags
179d : c933            >            cmp #$33     ;test result
                       >            trap_ne
179f : f003            >        beq skip0307
                       >        trap            ;failed not equal (non zero)
17a1 : 20c740          >        jsr report_error
                       >
17a4 :                 >skip0307
                       >
17a4 : 68              >            pla         ;load status
17a5 : 48              >            pha
                       >            cmp_flag 0
17a6 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
17a8 : f003            >        beq skip0310
                       >        trap            ;failed not equal (non zero)
17aa : 20c740          >        jsr report_error
                       >
17ad :                 >skip0310
                       >
17ad : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
17ae : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
17b0 : 48              >            pha         ;use stack to load status
17b1 : a9cc            >            lda #$cc     ;precharge accu
17b3 : 28              >            plp
                       >
17b4 : 8f5206          >        bbs 0,zpt,fail40279
17b7 : 0f5206          >        bbr 0,zpt,ok40279
                       >        trap            ;bbr branch not taken
17ba : 20c740          >        jsr report_error
                       >
17bd :                 >fail40279 
                       >        trap            ;bbs branch taken
17bd : 20c740          >        jsr report_error
                       >
17c0 :                 >ok40279   
                       >        tst_a $cc,$ff
17c0 : 08              >            php         ;save flags
17c1 : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
17c3 : f003            >        beq skip0317
                       >        trap            ;failed not equal (non zero)
17c5 : 20c740          >        jsr report_error
                       >
17c8 :                 >skip0317
                       >
17c8 : 68              >            pla         ;load status
17c9 : 48              >            pha
                       >            cmp_flag $ff
17ca : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
17cc : f003            >        beq skip0320
                       >        trap            ;failed not equal (non zero)
17ce : 20c740          >        jsr report_error
                       >
17d1 :                 >skip0320
                       >
17d1 : 28              >            plp         ;restore status
                       >
17d2 : a552            >        lda zpt
17d4 : c9fe            >        cmp #$ff-(1<<0)
                       >        trap_ne         ;zp altered
17d6 : f003            >        beq skip0322
                       >        trap            ;failed not equal (non zero)
17d8 : 20c740          >        jsr report_error
                       >
17db :                 >skip0322
                       >
                        
                                bbt 1
17db : a902            >        lda #(1<<1)    ;testing 1 bit on
17dd : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
17df : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
17e1 : 48              >            pha         ;use stack to load status
17e2 : a933            >            lda #$33     ;precharge accu
17e4 : 28              >            plp
                       >
17e5 : 1f5206          >        bbr 1,zpt,fail10324
17e8 : 9f5206          >        bbs 1,zpt,ok10324
                       >        trap            ;bbs branch not taken
17eb : 20c740          >        jsr report_error
                       >
17ee :                 >fail10324
                       >        trap            ;bbr branch taken
17ee : 20c740          >        jsr report_error
                       >
17f1 :                 >ok10324   
                       >        tst_a $33,0
17f1 : 08              >            php         ;save flags
17f2 : c933            >            cmp #$33     ;test result
                       >            trap_ne
17f4 : f003            >        beq skip0330
                       >        trap            ;failed not equal (non zero)
17f6 : 20c740          >        jsr report_error
                       >
17f9 :                 >skip0330
                       >
17f9 : 68              >            pla         ;load status
17fa : 48              >            pha
                       >            cmp_flag 0
17fb : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
17fd : f003            >        beq skip0333
                       >        trap            ;failed not equal (non zero)
17ff : 20c740          >        jsr report_error
                       >
1802 :                 >skip0333
                       >
1802 : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1803 : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1805 : 48              >            pha         ;use stack to load status
1806 : a9cc            >            lda #$cc     ;precharge accu
1808 : 28              >            plp
                       >
1809 : 1f5206          >        bbr 1,zpt,fail20324
180c : 9f5206          >        bbs 1,zpt,ok20324
                       >        trap            ;bbs branch not taken
180f : 20c740          >        jsr report_error
                       >
1812 :                 >fail20324 
                       >        trap            ;bbr branch taken
1812 : 20c740          >        jsr report_error
                       >
1815 :                 >ok20324   
                       >        tst_a $cc,$ff
1815 : 08              >            php         ;save flags
1816 : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
1818 : f003            >        beq skip0340
                       >        trap            ;failed not equal (non zero)
181a : 20c740          >        jsr report_error
                       >
181d :                 >skip0340
                       >
181d : 68              >            pla         ;load status
181e : 48              >            pha
                       >            cmp_flag $ff
181f : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1821 : f003            >        beq skip0343
                       >        trap            ;failed not equal (non zero)
1823 : 20c740          >        jsr report_error
                       >
1826 :                 >skip0343
                       >
1826 : 28              >            plp         ;restore status
                       >
1827 : a552            >        lda zpt
1829 : c902            >        cmp #(1<<1)
                       >        trap_ne         ;zp altered
182b : f003            >        beq skip0345
                       >        trap            ;failed not equal (non zero)
182d : 20c740          >        jsr report_error
                       >
1830 :                 >skip0345
                       >
1830 : a9fd            >        lda #$ff-(1<<1) ;testing 1 bit off
1832 : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1834 : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
1836 : 48              >            pha         ;use stack to load status
1837 : a933            >            lda #$33     ;precharge accu
1839 : 28              >            plp
                       >
183a : 9f5206          >        bbs 1,zpt,fail30324
183d : 1f5206          >        bbr 1,zpt,ok30324
                       >        trap            ;bbr branch not taken
1840 : 20c740          >        jsr report_error
                       >
1843 :                 >fail30324 
                       >        trap            ;bbs branch taken
1843 : 20c740          >        jsr report_error
                       >
1846 :                 >ok30324   
                       >        tst_a $33,0
1846 : 08              >            php         ;save flags
1847 : c933            >            cmp #$33     ;test result
                       >            trap_ne
1849 : f003            >        beq skip0352
                       >        trap            ;failed not equal (non zero)
184b : 20c740          >        jsr report_error
                       >
184e :                 >skip0352
                       >
184e : 68              >            pla         ;load status
184f : 48              >            pha
                       >            cmp_flag 0
1850 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1852 : f003            >        beq skip0355
                       >        trap            ;failed not equal (non zero)
1854 : 20c740          >        jsr report_error
                       >
1857 :                 >skip0355
                       >
1857 : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1858 : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
185a : 48              >            pha         ;use stack to load status
185b : a9cc            >            lda #$cc     ;precharge accu
185d : 28              >            plp
                       >
185e : 9f5206          >        bbs 1,zpt,fail40324
1861 : 1f5206          >        bbr 1,zpt,ok40324
                       >        trap            ;bbr branch not taken
1864 : 20c740          >        jsr report_error
                       >
1867 :                 >fail40324 
                       >        trap            ;bbs branch taken
1867 : 20c740          >        jsr report_error
                       >
186a :                 >ok40324   
                       >        tst_a $cc,$ff
186a : 08              >            php         ;save flags
186b : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
186d : f003            >        beq skip0362
                       >        trap            ;failed not equal (non zero)
186f : 20c740          >        jsr report_error
                       >
1872 :                 >skip0362
                       >
1872 : 68              >            pla         ;load status
1873 : 48              >            pha
                       >            cmp_flag $ff
1874 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1876 : f003            >        beq skip0365
                       >        trap            ;failed not equal (non zero)
1878 : 20c740          >        jsr report_error
                       >
187b :                 >skip0365
                       >
187b : 28              >            plp         ;restore status
                       >
187c : a552            >        lda zpt
187e : c9fd            >        cmp #$ff-(1<<1)
                       >        trap_ne         ;zp altered
1880 : f003            >        beq skip0367
                       >        trap            ;failed not equal (non zero)
1882 : 20c740          >        jsr report_error
                       >
1885 :                 >skip0367
                       >
                        
                                bbt 2
1885 : a904            >        lda #(1<<2)    ;testing 1 bit on
1887 : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1889 : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
188b : 48              >            pha         ;use stack to load status
188c : a933            >            lda #$33     ;precharge accu
188e : 28              >            plp
                       >
188f : 2f5206          >        bbr 2,zpt,fail10369
1892 : af5206          >        bbs 2,zpt,ok10369
                       >        trap            ;bbs branch not taken
1895 : 20c740          >        jsr report_error
                       >
1898 :                 >fail10369
                       >        trap            ;bbr branch taken
1898 : 20c740          >        jsr report_error
                       >
189b :                 >ok10369   
                       >        tst_a $33,0
189b : 08              >            php         ;save flags
189c : c933            >            cmp #$33     ;test result
                       >            trap_ne
189e : f003            >        beq skip0375
                       >        trap            ;failed not equal (non zero)
18a0 : 20c740          >        jsr report_error
                       >
18a3 :                 >skip0375
                       >
18a3 : 68              >            pla         ;load status
18a4 : 48              >            pha
                       >            cmp_flag 0
18a5 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
18a7 : f003            >        beq skip0378
                       >        trap            ;failed not equal (non zero)
18a9 : 20c740          >        jsr report_error
                       >
18ac :                 >skip0378
                       >
18ac : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
18ad : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
18af : 48              >            pha         ;use stack to load status
18b0 : a9cc            >            lda #$cc     ;precharge accu
18b2 : 28              >            plp
                       >
18b3 : 2f5206          >        bbr 2,zpt,fail20369
18b6 : af5206          >        bbs 2,zpt,ok20369
                       >        trap            ;bbs branch not taken
18b9 : 20c740          >        jsr report_error
                       >
18bc :                 >fail20369 
                       >        trap            ;bbr branch taken
18bc : 20c740          >        jsr report_error
                       >
18bf :                 >ok20369   
                       >        tst_a $cc,$ff
18bf : 08              >            php         ;save flags
18c0 : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
18c2 : f003            >        beq skip0385
                       >        trap            ;failed not equal (non zero)
18c4 : 20c740          >        jsr report_error
                       >
18c7 :                 >skip0385
                       >
18c7 : 68              >            pla         ;load status
18c8 : 48              >            pha
                       >            cmp_flag $ff
18c9 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
18cb : f003            >        beq skip0388
                       >        trap            ;failed not equal (non zero)
18cd : 20c740          >        jsr report_error
                       >
18d0 :                 >skip0388
                       >
18d0 : 28              >            plp         ;restore status
                       >
18d1 : a552            >        lda zpt
18d3 : c904            >        cmp #(1<<2)
                       >        trap_ne         ;zp altered
18d5 : f003            >        beq skip0390
                       >        trap            ;failed not equal (non zero)
18d7 : 20c740          >        jsr report_error
                       >
18da :                 >skip0390
                       >
18da : a9fb            >        lda #$ff-(1<<2) ;testing 1 bit off
18dc : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
18de : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
18e0 : 48              >            pha         ;use stack to load status
18e1 : a933            >            lda #$33     ;precharge accu
18e3 : 28              >            plp
                       >
18e4 : af5206          >        bbs 2,zpt,fail30369
18e7 : 2f5206          >        bbr 2,zpt,ok30369
                       >        trap            ;bbr branch not taken
18ea : 20c740          >        jsr report_error
                       >
18ed :                 >fail30369 
                       >        trap            ;bbs branch taken
18ed : 20c740          >        jsr report_error
                       >
18f0 :                 >ok30369   
                       >        tst_a $33,0
18f0 : 08              >            php         ;save flags
18f1 : c933            >            cmp #$33     ;test result
                       >            trap_ne
18f3 : f003            >        beq skip0397
                       >        trap            ;failed not equal (non zero)
18f5 : 20c740          >        jsr report_error
                       >
18f8 :                 >skip0397
                       >
18f8 : 68              >            pla         ;load status
18f9 : 48              >            pha
                       >            cmp_flag 0
18fa : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
18fc : f003            >        beq skip0400
                       >        trap            ;failed not equal (non zero)
18fe : 20c740          >        jsr report_error
                       >
1901 :                 >skip0400
                       >
1901 : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1902 : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1904 : 48              >            pha         ;use stack to load status
1905 : a9cc            >            lda #$cc     ;precharge accu
1907 : 28              >            plp
                       >
1908 : af5206          >        bbs 2,zpt,fail40369
190b : 2f5206          >        bbr 2,zpt,ok40369
                       >        trap            ;bbr branch not taken
190e : 20c740          >        jsr report_error
                       >
1911 :                 >fail40369 
                       >        trap            ;bbs branch taken
1911 : 20c740          >        jsr report_error
                       >
1914 :                 >ok40369   
                       >        tst_a $cc,$ff
1914 : 08              >            php         ;save flags
1915 : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
1917 : f003            >        beq skip0407
                       >        trap            ;failed not equal (non zero)
1919 : 20c740          >        jsr report_error
                       >
191c :                 >skip0407
                       >
191c : 68              >            pla         ;load status
191d : 48              >            pha
                       >            cmp_flag $ff
191e : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1920 : f003            >        beq skip0410
                       >        trap            ;failed not equal (non zero)
1922 : 20c740          >        jsr report_error
                       >
1925 :                 >skip0410
                       >
1925 : 28              >            plp         ;restore status
                       >
1926 : a552            >        lda zpt
1928 : c9fb            >        cmp #$ff-(1<<2)
                       >        trap_ne         ;zp altered
192a : f003            >        beq skip0412
                       >        trap            ;failed not equal (non zero)
192c : 20c740          >        jsr report_error
                       >
192f :                 >skip0412
                       >
                        
                                bbt 3
192f : a908            >        lda #(1<<3)    ;testing 1 bit on
1931 : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1933 : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
1935 : 48              >            pha         ;use stack to load status
1936 : a933            >            lda #$33     ;precharge accu
1938 : 28              >            plp
                       >
1939 : 3f5206          >        bbr 3,zpt,fail10414
193c : bf5206          >        bbs 3,zpt,ok10414
                       >        trap            ;bbs branch not taken
193f : 20c740          >        jsr report_error
                       >
1942 :                 >fail10414
                       >        trap            ;bbr branch taken
1942 : 20c740          >        jsr report_error
                       >
1945 :                 >ok10414   
                       >        tst_a $33,0
1945 : 08              >            php         ;save flags
1946 : c933            >            cmp #$33     ;test result
                       >            trap_ne
1948 : f003            >        beq skip0420
                       >        trap            ;failed not equal (non zero)
194a : 20c740          >        jsr report_error
                       >
194d :                 >skip0420
                       >
194d : 68              >            pla         ;load status
194e : 48              >            pha
                       >            cmp_flag 0
194f : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1951 : f003            >        beq skip0423
                       >        trap            ;failed not equal (non zero)
1953 : 20c740          >        jsr report_error
                       >
1956 :                 >skip0423
                       >
1956 : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1957 : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1959 : 48              >            pha         ;use stack to load status
195a : a9cc            >            lda #$cc     ;precharge accu
195c : 28              >            plp
                       >
195d : 3f5206          >        bbr 3,zpt,fail20414
1960 : bf5206          >        bbs 3,zpt,ok20414
                       >        trap            ;bbs branch not taken
1963 : 20c740          >        jsr report_error
                       >
1966 :                 >fail20414 
                       >        trap            ;bbr branch taken
1966 : 20c740          >        jsr report_error
                       >
1969 :                 >ok20414   
                       >        tst_a $cc,$ff
1969 : 08              >            php         ;save flags
196a : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
196c : f003            >        beq skip0430
                       >        trap            ;failed not equal (non zero)
196e : 20c740          >        jsr report_error
                       >
1971 :                 >skip0430
                       >
1971 : 68              >            pla         ;load status
1972 : 48              >            pha
                       >            cmp_flag $ff
1973 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1975 : f003            >        beq skip0433
                       >        trap            ;failed not equal (non zero)
1977 : 20c740          >        jsr report_error
                       >
197a :                 >skip0433
                       >
197a : 28              >            plp         ;restore status
                       >
197b : a552            >        lda zpt
197d : c908            >        cmp #(1<<3)
                       >        trap_ne         ;zp altered
197f : f003            >        beq skip0435
                       >        trap            ;failed not equal (non zero)
1981 : 20c740          >        jsr report_error
                       >
1984 :                 >skip0435
                       >
1984 : a9f7            >        lda #$ff-(1<<3) ;testing 1 bit off
1986 : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1988 : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
198a : 48              >            pha         ;use stack to load status
198b : a933            >            lda #$33     ;precharge accu
198d : 28              >            plp
                       >
198e : bf5206          >        bbs 3,zpt,fail30414
1991 : 3f5206          >        bbr 3,zpt,ok30414
                       >        trap            ;bbr branch not taken
1994 : 20c740          >        jsr report_error
                       >
1997 :                 >fail30414 
                       >        trap            ;bbs branch taken
1997 : 20c740          >        jsr report_error
                       >
199a :                 >ok30414   
                       >        tst_a $33,0
199a : 08              >            php         ;save flags
199b : c933            >            cmp #$33     ;test result
                       >            trap_ne
199d : f003            >        beq skip0442
                       >        trap            ;failed not equal (non zero)
199f : 20c740          >        jsr report_error
                       >
19a2 :                 >skip0442
                       >
19a2 : 68              >            pla         ;load status
19a3 : 48              >            pha
                       >            cmp_flag 0
19a4 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
19a6 : f003            >        beq skip0445
                       >        trap            ;failed not equal (non zero)
19a8 : 20c740          >        jsr report_error
                       >
19ab :                 >skip0445
                       >
19ab : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
19ac : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
19ae : 48              >            pha         ;use stack to load status
19af : a9cc            >            lda #$cc     ;precharge accu
19b1 : 28              >            plp
                       >
19b2 : bf5206          >        bbs 3,zpt,fail40414
19b5 : 3f5206          >        bbr 3,zpt,ok40414
                       >        trap            ;bbr branch not taken
19b8 : 20c740          >        jsr report_error
                       >
19bb :                 >fail40414 
                       >        trap            ;bbs branch taken
19bb : 20c740          >        jsr report_error
                       >
19be :                 >ok40414   
                       >        tst_a $cc,$ff
19be : 08              >            php         ;save flags
19bf : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
19c1 : f003            >        beq skip0452
                       >        trap            ;failed not equal (non zero)
19c3 : 20c740          >        jsr report_error
                       >
19c6 :                 >skip0452
                       >
19c6 : 68              >            pla         ;load status
19c7 : 48              >            pha
                       >            cmp_flag $ff
19c8 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
19ca : f003            >        beq skip0455
                       >        trap            ;failed not equal (non zero)
19cc : 20c740          >        jsr report_error
                       >
19cf :                 >skip0455
                       >
19cf : 28              >            plp         ;restore status
                       >
19d0 : a552            >        lda zpt
19d2 : c9f7            >        cmp #$ff-(1<<3)
                       >        trap_ne         ;zp altered
19d4 : f003            >        beq skip0457
                       >        trap            ;failed not equal (non zero)
19d6 : 20c740          >        jsr report_error
                       >
19d9 :                 >skip0457
                       >
                        
                                bbt 4
19d9 : a910            >        lda #(1<<4)    ;testing 1 bit on
19db : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
19dd : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
19df : 48              >            pha         ;use stack to load status
19e0 : a933            >            lda #$33     ;precharge accu
19e2 : 28              >            plp
                       >
19e3 : 4f5206          >        bbr 4,zpt,fail10459
19e6 : cf5206          >        bbs 4,zpt,ok10459
                       >        trap            ;bbs branch not taken
19e9 : 20c740          >        jsr report_error
                       >
19ec :                 >fail10459
                       >        trap            ;bbr branch taken
19ec : 20c740          >        jsr report_error
                       >
19ef :                 >ok10459   
                       >        tst_a $33,0
19ef : 08              >            php         ;save flags
19f0 : c933            >            cmp #$33     ;test result
                       >            trap_ne
19f2 : f003            >        beq skip0465
                       >        trap            ;failed not equal (non zero)
19f4 : 20c740          >        jsr report_error
                       >
19f7 :                 >skip0465
                       >
19f7 : 68              >            pla         ;load status
19f8 : 48              >            pha
                       >            cmp_flag 0
19f9 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
19fb : f003            >        beq skip0468
                       >        trap            ;failed not equal (non zero)
19fd : 20c740          >        jsr report_error
                       >
1a00 :                 >skip0468
                       >
1a00 : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1a01 : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1a03 : 48              >            pha         ;use stack to load status
1a04 : a9cc            >            lda #$cc     ;precharge accu
1a06 : 28              >            plp
                       >
1a07 : 4f5206          >        bbr 4,zpt,fail20459
1a0a : cf5206          >        bbs 4,zpt,ok20459
                       >        trap            ;bbs branch not taken
1a0d : 20c740          >        jsr report_error
                       >
1a10 :                 >fail20459 
                       >        trap            ;bbr branch taken
1a10 : 20c740          >        jsr report_error
                       >
1a13 :                 >ok20459   
                       >        tst_a $cc,$ff
1a13 : 08              >            php         ;save flags
1a14 : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
1a16 : f003            >        beq skip0475
                       >        trap            ;failed not equal (non zero)
1a18 : 20c740          >        jsr report_error
                       >
1a1b :                 >skip0475
                       >
1a1b : 68              >            pla         ;load status
1a1c : 48              >            pha
                       >            cmp_flag $ff
1a1d : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1a1f : f003            >        beq skip0478
                       >        trap            ;failed not equal (non zero)
1a21 : 20c740          >        jsr report_error
                       >
1a24 :                 >skip0478
                       >
1a24 : 28              >            plp         ;restore status
                       >
1a25 : a552            >        lda zpt
1a27 : c910            >        cmp #(1<<4)
                       >        trap_ne         ;zp altered
1a29 : f003            >        beq skip0480
                       >        trap            ;failed not equal (non zero)
1a2b : 20c740          >        jsr report_error
                       >
1a2e :                 >skip0480
                       >
1a2e : a9ef            >        lda #$ff-(1<<4) ;testing 1 bit off
1a30 : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1a32 : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
1a34 : 48              >            pha         ;use stack to load status
1a35 : a933            >            lda #$33     ;precharge accu
1a37 : 28              >            plp
                       >
1a38 : cf5206          >        bbs 4,zpt,fail30459
1a3b : 4f5206          >        bbr 4,zpt,ok30459
                       >        trap            ;bbr branch not taken
1a3e : 20c740          >        jsr report_error
                       >
1a41 :                 >fail30459 
                       >        trap            ;bbs branch taken
1a41 : 20c740          >        jsr report_error
                       >
1a44 :                 >ok30459   
                       >        tst_a $33,0
1a44 : 08              >            php         ;save flags
1a45 : c933            >            cmp #$33     ;test result
                       >            trap_ne
1a47 : f003            >        beq skip0487
                       >        trap            ;failed not equal (non zero)
1a49 : 20c740          >        jsr report_error
                       >
1a4c :                 >skip0487
                       >
1a4c : 68              >            pla         ;load status
1a4d : 48              >            pha
                       >            cmp_flag 0
1a4e : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1a50 : f003            >        beq skip0490
                       >        trap            ;failed not equal (non zero)
1a52 : 20c740          >        jsr report_error
                       >
1a55 :                 >skip0490
                       >
1a55 : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1a56 : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1a58 : 48              >            pha         ;use stack to load status
1a59 : a9cc            >            lda #$cc     ;precharge accu
1a5b : 28              >            plp
                       >
1a5c : cf5206          >        bbs 4,zpt,fail40459
1a5f : 4f5206          >        bbr 4,zpt,ok40459
                       >        trap            ;bbr branch not taken
1a62 : 20c740          >        jsr report_error
                       >
1a65 :                 >fail40459 
                       >        trap            ;bbs branch taken
1a65 : 20c740          >        jsr report_error
                       >
1a68 :                 >ok40459   
                       >        tst_a $cc,$ff
1a68 : 08              >            php         ;save flags
1a69 : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
1a6b : f003            >        beq skip0497
                       >        trap            ;failed not equal (non zero)
1a6d : 20c740          >        jsr report_error
                       >
1a70 :                 >skip0497
                       >
1a70 : 68              >            pla         ;load status
1a71 : 48              >            pha
                       >            cmp_flag $ff
1a72 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1a74 : f003            >        beq skip0500
                       >        trap            ;failed not equal (non zero)
1a76 : 20c740          >        jsr report_error
                       >
1a79 :                 >skip0500
                       >
1a79 : 28              >            plp         ;restore status
                       >
1a7a : a552            >        lda zpt
1a7c : c9ef            >        cmp #$ff-(1<<4)
                       >        trap_ne         ;zp altered
1a7e : f003            >        beq skip0502
                       >        trap            ;failed not equal (non zero)
1a80 : 20c740          >        jsr report_error
                       >
1a83 :                 >skip0502
                       >
                        
                                bbt 5
1a83 : a920            >        lda #(1<<5)    ;testing 1 bit on
1a85 : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1a87 : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
1a89 : 48              >            pha         ;use stack to load status
1a8a : a933            >            lda #$33     ;precharge accu
1a8c : 28              >            plp
                       >
1a8d : 5f5206          >        bbr 5,zpt,fail10504
1a90 : df5206          >        bbs 5,zpt,ok10504
                       >        trap            ;bbs branch not taken
1a93 : 20c740          >        jsr report_error
                       >
1a96 :                 >fail10504
                       >        trap            ;bbr branch taken
1a96 : 20c740          >        jsr report_error
                       >
1a99 :                 >ok10504   
                       >        tst_a $33,0
1a99 : 08              >            php         ;save flags
1a9a : c933            >            cmp #$33     ;test result
                       >            trap_ne
1a9c : f003            >        beq skip0510
                       >        trap            ;failed not equal (non zero)
1a9e : 20c740          >        jsr report_error
                       >
1aa1 :                 >skip0510
                       >
1aa1 : 68              >            pla         ;load status
1aa2 : 48              >            pha
                       >            cmp_flag 0
1aa3 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1aa5 : f003            >        beq skip0513
                       >        trap            ;failed not equal (non zero)
1aa7 : 20c740          >        jsr report_error
                       >
1aaa :                 >skip0513
                       >
1aaa : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1aab : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1aad : 48              >            pha         ;use stack to load status
1aae : a9cc            >            lda #$cc     ;precharge accu
1ab0 : 28              >            plp
                       >
1ab1 : 5f5206          >        bbr 5,zpt,fail20504
1ab4 : df5206          >        bbs 5,zpt,ok20504
                       >        trap            ;bbs branch not taken
1ab7 : 20c740          >        jsr report_error
                       >
1aba :                 >fail20504 
                       >        trap            ;bbr branch taken
1aba : 20c740          >        jsr report_error
                       >
1abd :                 >ok20504   
                       >        tst_a $cc,$ff
1abd : 08              >            php         ;save flags
1abe : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
1ac0 : f003            >        beq skip0520
                       >        trap            ;failed not equal (non zero)
1ac2 : 20c740          >        jsr report_error
                       >
1ac5 :                 >skip0520
                       >
1ac5 : 68              >            pla         ;load status
1ac6 : 48              >            pha
                       >            cmp_flag $ff
1ac7 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1ac9 : f003            >        beq skip0523
                       >        trap            ;failed not equal (non zero)
1acb : 20c740          >        jsr report_error
                       >
1ace :                 >skip0523
                       >
1ace : 28              >            plp         ;restore status
                       >
1acf : a552            >        lda zpt
1ad1 : c920            >        cmp #(1<<5)
                       >        trap_ne         ;zp altered
1ad3 : f003            >        beq skip0525
                       >        trap            ;failed not equal (non zero)
1ad5 : 20c740          >        jsr report_error
                       >
1ad8 :                 >skip0525
                       >
1ad8 : a9df            >        lda #$ff-(1<<5) ;testing 1 bit off
1ada : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1adc : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
1ade : 48              >            pha         ;use stack to load status
1adf : a933            >            lda #$33     ;precharge accu
1ae1 : 28              >            plp
                       >
1ae2 : df5206          >        bbs 5,zpt,fail30504
1ae5 : 5f5206          >        bbr 5,zpt,ok30504
                       >        trap            ;bbr branch not taken
1ae8 : 20c740          >        jsr report_error
                       >
1aeb :                 >fail30504 
                       >        trap            ;bbs branch taken
1aeb : 20c740          >        jsr report_error
                       >
1aee :                 >ok30504   
                       >        tst_a $33,0
1aee : 08              >            php         ;save flags
1aef : c933            >            cmp #$33     ;test result
                       >            trap_ne
1af1 : f003            >        beq skip0532
                       >        trap            ;failed not equal (non zero)
1af3 : 20c740          >        jsr report_error
                       >
1af6 :                 >skip0532
                       >
1af6 : 68              >            pla         ;load status
1af7 : 48              >            pha
                       >            cmp_flag 0
1af8 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1afa : f003            >        beq skip0535
                       >        trap            ;failed not equal (non zero)
1afc : 20c740          >        jsr report_error
                       >
1aff :                 >skip0535
                       >
1aff : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1b00 : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1b02 : 48              >            pha         ;use stack to load status
1b03 : a9cc            >            lda #$cc     ;precharge accu
1b05 : 28              >            plp
                       >
1b06 : df5206          >        bbs 5,zpt,fail40504
1b09 : 5f5206          >        bbr 5,zpt,ok40504
                       >        trap            ;bbr branch not taken
1b0c : 20c740          >        jsr report_error
                       >
1b0f :                 >fail40504 
                       >        trap            ;bbs branch taken
1b0f : 20c740          >        jsr report_error
                       >
1b12 :                 >ok40504   
                       >        tst_a $cc,$ff
1b12 : 08              >            php         ;save flags
1b13 : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
1b15 : f003            >        beq skip0542
                       >        trap            ;failed not equal (non zero)
1b17 : 20c740          >        jsr report_error
                       >
1b1a :                 >skip0542
                       >
1b1a : 68              >            pla         ;load status
1b1b : 48              >            pha
                       >            cmp_flag $ff
1b1c : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1b1e : f003            >        beq skip0545
                       >        trap            ;failed not equal (non zero)
1b20 : 20c740          >        jsr report_error
                       >
1b23 :                 >skip0545
                       >
1b23 : 28              >            plp         ;restore status
                       >
1b24 : a552            >        lda zpt
1b26 : c9df            >        cmp #$ff-(1<<5)
                       >        trap_ne         ;zp altered
1b28 : f003            >        beq skip0547
                       >        trap            ;failed not equal (non zero)
1b2a : 20c740          >        jsr report_error
                       >
1b2d :                 >skip0547
                       >
                        
                                bbt 6
1b2d : a940            >        lda #(1<<6)    ;testing 1 bit on
1b2f : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1b31 : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
1b33 : 48              >            pha         ;use stack to load status
1b34 : a933            >            lda #$33     ;precharge accu
1b36 : 28              >            plp
                       >
1b37 : 6f5206          >        bbr 6,zpt,fail10549
1b3a : ef5206          >        bbs 6,zpt,ok10549
                       >        trap            ;bbs branch not taken
1b3d : 20c740          >        jsr report_error
                       >
1b40 :                 >fail10549
                       >        trap            ;bbr branch taken
1b40 : 20c740          >        jsr report_error
                       >
1b43 :                 >ok10549   
                       >        tst_a $33,0
1b43 : 08              >            php         ;save flags
1b44 : c933            >            cmp #$33     ;test result
                       >            trap_ne
1b46 : f003            >        beq skip0555
                       >        trap            ;failed not equal (non zero)
1b48 : 20c740          >        jsr report_error
                       >
1b4b :                 >skip0555
                       >
1b4b : 68              >            pla         ;load status
1b4c : 48              >            pha
                       >            cmp_flag 0
1b4d : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1b4f : f003            >        beq skip0558
                       >        trap            ;failed not equal (non zero)
1b51 : 20c740          >        jsr report_error
                       >
1b54 :                 >skip0558
                       >
1b54 : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1b55 : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1b57 : 48              >            pha         ;use stack to load status
1b58 : a9cc            >            lda #$cc     ;precharge accu
1b5a : 28              >            plp
                       >
1b5b : 6f5206          >        bbr 6,zpt,fail20549
1b5e : ef5206          >        bbs 6,zpt,ok20549
                       >        trap            ;bbs branch not taken
1b61 : 20c740          >        jsr report_error
                       >
1b64 :                 >fail20549 
                       >        trap            ;bbr branch taken
1b64 : 20c740          >        jsr report_error
                       >
1b67 :                 >ok20549   
                       >        tst_a $cc,$ff
1b67 : 08              >            php         ;save flags
1b68 : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
1b6a : f003            >        beq skip0565
                       >        trap            ;failed not equal (non zero)
1b6c : 20c740          >        jsr report_error
                       >
1b6f :                 >skip0565
                       >
1b6f : 68              >            pla         ;load status
1b70 : 48              >            pha
                       >            cmp_flag $ff
1b71 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1b73 : f003            >        beq skip0568
                       >        trap            ;failed not equal (non zero)
1b75 : 20c740          >        jsr report_error
                       >
1b78 :                 >skip0568
                       >
1b78 : 28              >            plp         ;restore status
                       >
1b79 : a552            >        lda zpt
1b7b : c940            >        cmp #(1<<6)
                       >        trap_ne         ;zp altered
1b7d : f003            >        beq skip0570
                       >        trap            ;failed not equal (non zero)
1b7f : 20c740          >        jsr report_error
                       >
1b82 :                 >skip0570
                       >
1b82 : a9bf            >        lda #$ff-(1<<6) ;testing 1 bit off
1b84 : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1b86 : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
1b88 : 48              >            pha         ;use stack to load status
1b89 : a933            >            lda #$33     ;precharge accu
1b8b : 28              >            plp
                       >
1b8c : ef5206          >        bbs 6,zpt,fail30549
1b8f : 6f5206          >        bbr 6,zpt,ok30549
                       >        trap            ;bbr branch not taken
1b92 : 20c740          >        jsr report_error
                       >
1b95 :                 >fail30549 
                       >        trap            ;bbs branch taken
1b95 : 20c740          >        jsr report_error
                       >
1b98 :                 >ok30549   
                       >        tst_a $33,0
1b98 : 08              >            php         ;save flags
1b99 : c933            >            cmp #$33     ;test result
                       >            trap_ne
1b9b : f003            >        beq skip0577
                       >        trap            ;failed not equal (non zero)
1b9d : 20c740          >        jsr report_error
                       >
1ba0 :                 >skip0577
                       >
1ba0 : 68              >            pla         ;load status
1ba1 : 48              >            pha
                       >            cmp_flag 0
1ba2 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1ba4 : f003            >        beq skip0580
                       >        trap            ;failed not equal (non zero)
1ba6 : 20c740          >        jsr report_error
                       >
1ba9 :                 >skip0580
                       >
1ba9 : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1baa : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1bac : 48              >            pha         ;use stack to load status
1bad : a9cc            >            lda #$cc     ;precharge accu
1baf : 28              >            plp
                       >
1bb0 : ef5206          >        bbs 6,zpt,fail40549
1bb3 : 6f5206          >        bbr 6,zpt,ok40549
                       >        trap            ;bbr branch not taken
1bb6 : 20c740          >        jsr report_error
                       >
1bb9 :                 >fail40549 
                       >        trap            ;bbs branch taken
1bb9 : 20c740          >        jsr report_error
                       >
1bbc :                 >ok40549   
                       >        tst_a $cc,$ff
1bbc : 08              >            php         ;save flags
1bbd : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
1bbf : f003            >        beq skip0587
                       >        trap            ;failed not equal (non zero)
1bc1 : 20c740          >        jsr report_error
                       >
1bc4 :                 >skip0587
                       >
1bc4 : 68              >            pla         ;load status
1bc5 : 48              >            pha
                       >            cmp_flag $ff
1bc6 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1bc8 : f003            >        beq skip0590
                       >        trap            ;failed not equal (non zero)
1bca : 20c740          >        jsr report_error
                       >
1bcd :                 >skip0590
                       >
1bcd : 28              >            plp         ;restore status
                       >
1bce : a552            >        lda zpt
1bd0 : c9bf            >        cmp #$ff-(1<<6)
                       >        trap_ne         ;zp altered
1bd2 : f003            >        beq skip0592
                       >        trap            ;failed not equal (non zero)
1bd4 : 20c740          >        jsr report_error
                       >
1bd7 :                 >skip0592
                       >
                        
                                bbt 7
1bd7 : a980            >        lda #(1<<7)    ;testing 1 bit on
1bd9 : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1bdb : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
1bdd : 48              >            pha         ;use stack to load status
1bde : a933            >            lda #$33     ;precharge accu
1be0 : 28              >            plp
                       >
1be1 : 7f5206          >        bbr 7,zpt,fail10594
1be4 : ff5206          >        bbs 7,zpt,ok10594
                       >        trap            ;bbs branch not taken
1be7 : 20c740          >        jsr report_error
                       >
1bea :                 >fail10594
                       >        trap            ;bbr branch taken
1bea : 20c740          >        jsr report_error
                       >
1bed :                 >ok10594   
                       >        tst_a $33,0
1bed : 08              >            php         ;save flags
1bee : c933            >            cmp #$33     ;test result
                       >            trap_ne
1bf0 : f003            >        beq skip0600
                       >        trap            ;failed not equal (non zero)
1bf2 : 20c740          >        jsr report_error
                       >
1bf5 :                 >skip0600
                       >
1bf5 : 68              >            pla         ;load status
1bf6 : 48              >            pha
                       >            cmp_flag 0
1bf7 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1bf9 : f003            >        beq skip0603
                       >        trap            ;failed not equal (non zero)
1bfb : 20c740          >        jsr report_error
                       >
1bfe :                 >skip0603
                       >
1bfe : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1bff : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1c01 : 48              >            pha         ;use stack to load status
1c02 : a9cc            >            lda #$cc     ;precharge accu
1c04 : 28              >            plp
                       >
1c05 : 7f5206          >        bbr 7,zpt,fail20594
1c08 : ff5206          >        bbs 7,zpt,ok20594
                       >        trap            ;bbs branch not taken
1c0b : 20c740          >        jsr report_error
                       >
1c0e :                 >fail20594 
                       >        trap            ;bbr branch taken
1c0e : 20c740          >        jsr report_error
                       >
1c11 :                 >ok20594   
                       >        tst_a $cc,$ff
1c11 : 08              >            php         ;save flags
1c12 : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
1c14 : f003            >        beq skip0610
                       >        trap            ;failed not equal (non zero)
1c16 : 20c740          >        jsr report_error
                       >
1c19 :                 >skip0610
                       >
1c19 : 68              >            pla         ;load status
1c1a : 48              >            pha
                       >            cmp_flag $ff
1c1b : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1c1d : f003            >        beq skip0613
                       >        trap            ;failed not equal (non zero)
1c1f : 20c740          >        jsr report_error
                       >
1c22 :                 >skip0613
                       >
1c22 : 28              >            plp         ;restore status
                       >
1c23 : a552            >        lda zpt
1c25 : c980            >        cmp #(1<<7)
                       >        trap_ne         ;zp altered
1c27 : f003            >        beq skip0615
                       >        trap            ;failed not equal (non zero)
1c29 : 20c740          >        jsr report_error
                       >
1c2c :                 >skip0615
                       >
1c2c : a97f            >        lda #$ff-(1<<7) ;testing 1 bit off
1c2e : 8552            >        sta zpt
                       >        set_a $33,0     ;with flags off
                       >            load_flag 0     
1c30 : a900            >            lda #0                  ;allow test to change I-flag (no mask)
                       >
1c32 : 48              >            pha         ;use stack to load status
1c33 : a933            >            lda #$33     ;precharge accu
1c35 : 28              >            plp
                       >
1c36 : ff5206          >        bbs 7,zpt,fail30594
1c39 : 7f5206          >        bbr 7,zpt,ok30594
                       >        trap            ;bbr branch not taken
1c3c : 20c740          >        jsr report_error
                       >
1c3f :                 >fail30594 
                       >        trap            ;bbs branch taken
1c3f : 20c740          >        jsr report_error
                       >
1c42 :                 >ok30594   
                       >        tst_a $33,0
1c42 : 08              >            php         ;save flags
1c43 : c933            >            cmp #$33     ;test result
                       >            trap_ne
1c45 : f003            >        beq skip0622
                       >        trap            ;failed not equal (non zero)
1c47 : 20c740          >        jsr report_error
                       >
1c4a :                 >skip0622
                       >
1c4a : 68              >            pla         ;load status
1c4b : 48              >            pha
                       >            cmp_flag 0
1c4c : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1c4e : f003            >        beq skip0625
                       >        trap            ;failed not equal (non zero)
1c50 : 20c740          >        jsr report_error
                       >
1c53 :                 >skip0625
                       >
1c53 : 28              >            plp         ;restore status
                       >
                       >        set_a $cc,$ff   ;with flags on
                       >            load_flag $ff   
1c54 : a9ff            >            lda #$ff                ;allow test to change I-flag (no mask)
                       >
1c56 : 48              >            pha         ;use stack to load status
1c57 : a9cc            >            lda #$cc     ;precharge accu
1c59 : 28              >            plp
                       >
1c5a : ff5206          >        bbs 7,zpt,fail40594
1c5d : 7f5206          >        bbr 7,zpt,ok40594
                       >        trap            ;bbr branch not taken
1c60 : 20c740          >        jsr report_error
                       >
1c63 :                 >fail40594 
                       >        trap            ;bbs branch taken
1c63 : 20c740          >        jsr report_error
                       >
1c66 :                 >ok40594   
                       >        tst_a $cc,$ff
1c66 : 08              >            php         ;save flags
1c67 : c9cc            >            cmp #$cc     ;test result
                       >            trap_ne
1c69 : f003            >        beq skip0632
                       >        trap            ;failed not equal (non zero)
1c6b : 20c740          >        jsr report_error
                       >
1c6e :                 >skip0632
                       >
1c6e : 68              >            pla         ;load status
1c6f : 48              >            pha
                       >            cmp_flag $ff
1c70 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1c72 : f003            >        beq skip0635
                       >        trap            ;failed not equal (non zero)
1c74 : 20c740          >        jsr report_error
                       >
1c77 :                 >skip0635
                       >
1c77 : 28              >            plp         ;restore status
                       >
1c78 : a552            >        lda zpt
1c7a : c97f            >        cmp #$ff-(1<<7)
                       >        trap_ne         ;zp altered
1c7c : f003            >        beq skip0637
                       >        trap            ;failed not equal (non zero)
1c7e : 20c740          >        jsr report_error
                       >
1c81 :                 >skip0637
                       >
                        
1c81 : e011                     cpx #$11
                                trap_ne         ;x overwritten
1c83 : f003            >        beq skip0639
                       >        trap            ;failed not equal (non zero)
1c85 : 20c740          >        jsr report_error
                       >
1c88 :                 >skip0639
                        
1c88 : c022                     cpy #$22
                                trap_ne         ;y overwritten
1c8a : f003            >        beq skip0641
                       >        trap            ;failed not equal (non zero)
1c8c : 20c740          >        jsr report_error
                       >
1c8f :                 >skip0641
                        
                                next_test 
1c8f : ad0211          >            lda test_case   ;previous test
1c92 : c906            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
1c94 : f003            >        beq skip0644
                       >        trap            ;failed not equal (non zero)
1c96 : 20c740          >        jsr report_error
                       >
1c99 :                 >skip0644
                       >
0007 =                 >test_num = test_num + 1
1c99 : a907            >            lda #test_num   ;*** next tests' number
1c9b : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                        bbrc    macro           ;\1 = bitnum
                                bbr \1,zpt,skip\?
                                eor #(1<<\1)       
                        skip\?
                                endm
                        bbsc    macro           ;\1 = bitnum
                                bbs \1,zpt,skip\?
                                eor #(1<<\1)       
                        skip\?
                                endm
                        
1c9e : a900                     lda #0          ;combined bit test
1ca0 : 8552                     sta zpt
1ca2 : a900             bbcl    lda #0
                                bbrc 0
1ca4 : 0f5202          >        bbr 0,zpt,skip0646
1ca7 : 4901            >        eor #(1<<0)       
1ca9 :                 >skip0646
                        
                                bbrc 1
1ca9 : 1f5202          >        bbr 1,zpt,skip0647
1cac : 4902            >        eor #(1<<1)       
1cae :                 >skip0647
                        
                                bbrc 2
1cae : 2f5202          >        bbr 2,zpt,skip0648
1cb1 : 4904            >        eor #(1<<2)       
1cb3 :                 >skip0648
                        
                                bbrc 3
1cb3 : 3f5202          >        bbr 3,zpt,skip0649
1cb6 : 4908            >        eor #(1<<3)       
1cb8 :                 >skip0649
                        
                                bbrc 4
1cb8 : 4f5202          >        bbr 4,zpt,skip0650
1cbb : 4910            >        eor #(1<<4)       
1cbd :                 >skip0650
                        
                                bbrc 5
1cbd : 5f5202          >        bbr 5,zpt,skip0651
1cc0 : 4920            >        eor #(1<<5)       
1cc2 :                 >skip0651
                        
                                bbrc 6
1cc2 : 6f5202          >        bbr 6,zpt,skip0652
1cc5 : 4940            >        eor #(1<<6)       
1cc7 :                 >skip0652
                        
                                bbrc 7
1cc7 : 7f5202          >        bbr 7,zpt,skip0653
1cca : 4980            >        eor #(1<<7)       
1ccc :                 >skip0653
                        
1ccc : 4552                     eor zpt
                                trap_ne         ;failed bbr bitnum in accu       
1cce : f003            >        beq skip0654
                       >        trap            ;failed not equal (non zero)
1cd0 : 20c740          >        jsr report_error
                       >
1cd3 :                 >skip0654
                        
1cd3 : a9ff                     lda #$ff
                                bbsc 0
1cd5 : 8f5202          >        bbs 0,zpt,skip0656
1cd8 : 4901            >        eor #(1<<0)       
1cda :                 >skip0656
                        
                                bbsc 1
1cda : 9f5202          >        bbs 1,zpt,skip0657
1cdd : 4902            >        eor #(1<<1)       
1cdf :                 >skip0657
                        
                                bbsc 2
1cdf : af5202          >        bbs 2,zpt,skip0658
1ce2 : 4904            >        eor #(1<<2)       
1ce4 :                 >skip0658
                        
                                bbsc 3
1ce4 : bf5202          >        bbs 3,zpt,skip0659
1ce7 : 4908            >        eor #(1<<3)       
1ce9 :                 >skip0659
                        
                                bbsc 4
1ce9 : cf5202          >        bbs 4,zpt,skip0660
1cec : 4910            >        eor #(1<<4)       
1cee :                 >skip0660
                        
                                bbsc 5
1cee : df5202          >        bbs 5,zpt,skip0661
1cf1 : 4920            >        eor #(1<<5)       
1cf3 :                 >skip0661
                        
                                bbsc 6
1cf3 : ef5202          >        bbs 6,zpt,skip0662
1cf6 : 4940            >        eor #(1<<6)       
1cf8 :                 >skip0662
                        
                                bbsc 7
1cf8 : ff5202          >        bbs 7,zpt,skip0663
1cfb : 4980            >        eor #(1<<7)       
1cfd :                 >skip0663
                        
1cfd : 4552                     eor zpt
                                trap_ne         ;failed bbs bitnum in accu       
1cff : f003            >        beq skip0664
                       >        trap            ;failed not equal (non zero)
1d01 : 20c740          >        jsr report_error
                       >
1d04 :                 >skip0664
                        
1d04 : e652                     inc zpt
1d06 : d09a                     bne bbcl
                                next_test            
1d08 : ad0211          >            lda test_case   ;previous test
1d0b : c907            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
1d0d : f003            >        beq skip0667
                       >        trap            ;failed not equal (non zero)
1d0f : 20c740          >        jsr report_error
                       >
1d12 :                 >skip0667
                       >
0008 =                 >test_num = test_num + 1
1d12 : a908            >            lda #test_num   ;*** next tests' number
1d14 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                            endif
                            
                        ; testing NOP
                        
                        nop_test    macro       ;\1 = opcode, \2 = # of bytes
                                    ldy #$42
                                    ldx #4-\2
                                    db  \1          ;test nop length
                                if \2 = 1
                                    dex
                                    dex
                                endif
                                if \2 = 2
                                    iny
                                    dex
                                endif
                                if \2 = 3
                                    iny
                                    iny
                                endif
                                    dex
                                    trap_ne         ;wrong number of bytes
                                    set_a $ff-\1,0
                                    db  \1          ;test nop integrity - flags off
                                    nop
                                    nop
                                    tst_a $ff-\1,0
                                    set_a $aa-\1,$ff
                                    db  \1          ;test nop integrity - flags on
                                    nop
                                    nop
                                    tst_a $aa-\1,$ff
                                    cpy #$42
                                    trap_ne         ;y changed
                                    cpx #0
                                    trap_ne         ;x changed
                                    endm
                        
                            if skip_nop = 0
                                nop_test $02,2
1d17 : a042            >            ldy #$42
1d19 : a202            >            ldx #4-2
1d1b : 02              >            db  $02          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
1d1c : c8              >            iny
1d1d : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
1d1e : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
1d1f : f003            >        beq skip0670
                       >        trap            ;failed not equal (non zero)
1d21 : 20c740          >        jsr report_error
                       >
1d24 :                 >skip0670
                       >
                       >            set_a $ff-$02,0
                       >            load_flag 0
1d24 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1d26 : 48              >            pha         ;use stack to load status
1d27 : a9fd            >            lda #$ff-$02     ;precharge accu
1d29 : 28              >            plp
                       >
1d2a : 02              >            db  $02          ;test nop integrity - flags off
1d2b : ea              >            nop
1d2c : ea              >            nop
                       >            tst_a $ff-$02,0
1d2d : 08              >            php         ;save flags
1d2e : c9fd            >            cmp #$ff-$02     ;test result
                       >            trap_ne
1d30 : f003            >        beq skip0675
                       >        trap            ;failed not equal (non zero)
1d32 : 20c740          >        jsr report_error
                       >
1d35 :                 >skip0675
                       >
1d35 : 68              >            pla         ;load status
1d36 : 48              >            pha
                       >            cmp_flag 0
1d37 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1d39 : f003            >        beq skip0678
                       >        trap            ;failed not equal (non zero)
1d3b : 20c740          >        jsr report_error
                       >
1d3e :                 >skip0678
                       >
1d3e : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$02,$ff
                       >            load_flag $ff
1d3f : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1d41 : 48              >            pha         ;use stack to load status
1d42 : a9a8            >            lda #$aa-$02     ;precharge accu
1d44 : 28              >            plp
                       >
1d45 : 02              >            db  $02          ;test nop integrity - flags on
1d46 : ea              >            nop
1d47 : ea              >            nop
                       >            tst_a $aa-$02,$ff
1d48 : 08              >            php         ;save flags
1d49 : c9a8            >            cmp #$aa-$02     ;test result
                       >            trap_ne
1d4b : f003            >        beq skip0683
                       >        trap            ;failed not equal (non zero)
1d4d : 20c740          >        jsr report_error
                       >
1d50 :                 >skip0683
                       >
1d50 : 68              >            pla         ;load status
1d51 : 48              >            pha
                       >            cmp_flag $ff
1d52 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1d54 : f003            >        beq skip0686
                       >        trap            ;failed not equal (non zero)
1d56 : 20c740          >        jsr report_error
                       >
1d59 :                 >skip0686
                       >
1d59 : 28              >            plp         ;restore status
                       >
1d5a : c042            >            cpy #$42
                       >            trap_ne         ;y changed
1d5c : f003            >        beq skip0688
                       >        trap            ;failed not equal (non zero)
1d5e : 20c740          >        jsr report_error
                       >
1d61 :                 >skip0688
                       >
1d61 : e000            >            cpx #0
                       >            trap_ne         ;x changed
1d63 : f003            >        beq skip0690
                       >        trap            ;failed not equal (non zero)
1d65 : 20c740          >        jsr report_error
                       >
1d68 :                 >skip0690
                       >
                        
                                nop_test $22,2
1d68 : a042            >            ldy #$42
1d6a : a202            >            ldx #4-2
1d6c : 22              >            db  $22          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
1d6d : c8              >            iny
1d6e : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
1d6f : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
1d70 : f003            >        beq skip0693
                       >        trap            ;failed not equal (non zero)
1d72 : 20c740          >        jsr report_error
                       >
1d75 :                 >skip0693
                       >
                       >            set_a $ff-$22,0
                       >            load_flag 0
1d75 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1d77 : 48              >            pha         ;use stack to load status
1d78 : a9dd            >            lda #$ff-$22     ;precharge accu
1d7a : 28              >            plp
                       >
1d7b : 22              >            db  $22          ;test nop integrity - flags off
1d7c : ea              >            nop
1d7d : ea              >            nop
                       >            tst_a $ff-$22,0
1d7e : 08              >            php         ;save flags
1d7f : c9dd            >            cmp #$ff-$22     ;test result
                       >            trap_ne
1d81 : f003            >        beq skip0698
                       >        trap            ;failed not equal (non zero)
1d83 : 20c740          >        jsr report_error
                       >
1d86 :                 >skip0698
                       >
1d86 : 68              >            pla         ;load status
1d87 : 48              >            pha
                       >            cmp_flag 0
1d88 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1d8a : f003            >        beq skip0701
                       >        trap            ;failed not equal (non zero)
1d8c : 20c740          >        jsr report_error
                       >
1d8f :                 >skip0701
                       >
1d8f : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$22,$ff
                       >            load_flag $ff
1d90 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1d92 : 48              >            pha         ;use stack to load status
1d93 : a988            >            lda #$aa-$22     ;precharge accu
1d95 : 28              >            plp
                       >
1d96 : 22              >            db  $22          ;test nop integrity - flags on
1d97 : ea              >            nop
1d98 : ea              >            nop
                       >            tst_a $aa-$22,$ff
1d99 : 08              >            php         ;save flags
1d9a : c988            >            cmp #$aa-$22     ;test result
                       >            trap_ne
1d9c : f003            >        beq skip0706
                       >        trap            ;failed not equal (non zero)
1d9e : 20c740          >        jsr report_error
                       >
1da1 :                 >skip0706
                       >
1da1 : 68              >            pla         ;load status
1da2 : 48              >            pha
                       >            cmp_flag $ff
1da3 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1da5 : f003            >        beq skip0709
                       >        trap            ;failed not equal (non zero)
1da7 : 20c740          >        jsr report_error
                       >
1daa :                 >skip0709
                       >
1daa : 28              >            plp         ;restore status
                       >
1dab : c042            >            cpy #$42
                       >            trap_ne         ;y changed
1dad : f003            >        beq skip0711
                       >        trap            ;failed not equal (non zero)
1daf : 20c740          >        jsr report_error
                       >
1db2 :                 >skip0711
                       >
1db2 : e000            >            cpx #0
                       >            trap_ne         ;x changed
1db4 : f003            >        beq skip0713
                       >        trap            ;failed not equal (non zero)
1db6 : 20c740          >        jsr report_error
                       >
1db9 :                 >skip0713
                       >
                        
                                nop_test $42,2
1db9 : a042            >            ldy #$42
1dbb : a202            >            ldx #4-2
1dbd : 42              >            db  $42          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
1dbe : c8              >            iny
1dbf : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
1dc0 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
1dc1 : f003            >        beq skip0716
                       >        trap            ;failed not equal (non zero)
1dc3 : 20c740          >        jsr report_error
                       >
1dc6 :                 >skip0716
                       >
                       >            set_a $ff-$42,0
                       >            load_flag 0
1dc6 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1dc8 : 48              >            pha         ;use stack to load status
1dc9 : a9bd            >            lda #$ff-$42     ;precharge accu
1dcb : 28              >            plp
                       >
1dcc : 42              >            db  $42          ;test nop integrity - flags off
1dcd : ea              >            nop
1dce : ea              >            nop
                       >            tst_a $ff-$42,0
1dcf : 08              >            php         ;save flags
1dd0 : c9bd            >            cmp #$ff-$42     ;test result
                       >            trap_ne
1dd2 : f003            >        beq skip0721
                       >        trap            ;failed not equal (non zero)
1dd4 : 20c740          >        jsr report_error
                       >
1dd7 :                 >skip0721
                       >
1dd7 : 68              >            pla         ;load status
1dd8 : 48              >            pha
                       >            cmp_flag 0
1dd9 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1ddb : f003            >        beq skip0724
                       >        trap            ;failed not equal (non zero)
1ddd : 20c740          >        jsr report_error
                       >
1de0 :                 >skip0724
                       >
1de0 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$42,$ff
                       >            load_flag $ff
1de1 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1de3 : 48              >            pha         ;use stack to load status
1de4 : a968            >            lda #$aa-$42     ;precharge accu
1de6 : 28              >            plp
                       >
1de7 : 42              >            db  $42          ;test nop integrity - flags on
1de8 : ea              >            nop
1de9 : ea              >            nop
                       >            tst_a $aa-$42,$ff
1dea : 08              >            php         ;save flags
1deb : c968            >            cmp #$aa-$42     ;test result
                       >            trap_ne
1ded : f003            >        beq skip0729
                       >        trap            ;failed not equal (non zero)
1def : 20c740          >        jsr report_error
                       >
1df2 :                 >skip0729
                       >
1df2 : 68              >            pla         ;load status
1df3 : 48              >            pha
                       >            cmp_flag $ff
1df4 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1df6 : f003            >        beq skip0732
                       >        trap            ;failed not equal (non zero)
1df8 : 20c740          >        jsr report_error
                       >
1dfb :                 >skip0732
                       >
1dfb : 28              >            plp         ;restore status
                       >
1dfc : c042            >            cpy #$42
                       >            trap_ne         ;y changed
1dfe : f003            >        beq skip0734
                       >        trap            ;failed not equal (non zero)
1e00 : 20c740          >        jsr report_error
                       >
1e03 :                 >skip0734
                       >
1e03 : e000            >            cpx #0
                       >            trap_ne         ;x changed
1e05 : f003            >        beq skip0736
                       >        trap            ;failed not equal (non zero)
1e07 : 20c740          >        jsr report_error
                       >
1e0a :                 >skip0736
                       >
                        
                                nop_test $62,2
1e0a : a042            >            ldy #$42
1e0c : a202            >            ldx #4-2
1e0e : 62              >            db  $62          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
1e0f : c8              >            iny
1e10 : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
1e11 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
1e12 : f003            >        beq skip0739
                       >        trap            ;failed not equal (non zero)
1e14 : 20c740          >        jsr report_error
                       >
1e17 :                 >skip0739
                       >
                       >            set_a $ff-$62,0
                       >            load_flag 0
1e17 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1e19 : 48              >            pha         ;use stack to load status
1e1a : a99d            >            lda #$ff-$62     ;precharge accu
1e1c : 28              >            plp
                       >
1e1d : 62              >            db  $62          ;test nop integrity - flags off
1e1e : ea              >            nop
1e1f : ea              >            nop
                       >            tst_a $ff-$62,0
1e20 : 08              >            php         ;save flags
1e21 : c99d            >            cmp #$ff-$62     ;test result
                       >            trap_ne
1e23 : f003            >        beq skip0744
                       >        trap            ;failed not equal (non zero)
1e25 : 20c740          >        jsr report_error
                       >
1e28 :                 >skip0744
                       >
1e28 : 68              >            pla         ;load status
1e29 : 48              >            pha
                       >            cmp_flag 0
1e2a : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1e2c : f003            >        beq skip0747
                       >        trap            ;failed not equal (non zero)
1e2e : 20c740          >        jsr report_error
                       >
1e31 :                 >skip0747
                       >
1e31 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$62,$ff
                       >            load_flag $ff
1e32 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1e34 : 48              >            pha         ;use stack to load status
1e35 : a948            >            lda #$aa-$62     ;precharge accu
1e37 : 28              >            plp
                       >
1e38 : 62              >            db  $62          ;test nop integrity - flags on
1e39 : ea              >            nop
1e3a : ea              >            nop
                       >            tst_a $aa-$62,$ff
1e3b : 08              >            php         ;save flags
1e3c : c948            >            cmp #$aa-$62     ;test result
                       >            trap_ne
1e3e : f003            >        beq skip0752
                       >        trap            ;failed not equal (non zero)
1e40 : 20c740          >        jsr report_error
                       >
1e43 :                 >skip0752
                       >
1e43 : 68              >            pla         ;load status
1e44 : 48              >            pha
                       >            cmp_flag $ff
1e45 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1e47 : f003            >        beq skip0755
                       >        trap            ;failed not equal (non zero)
1e49 : 20c740          >        jsr report_error
                       >
1e4c :                 >skip0755
                       >
1e4c : 28              >            plp         ;restore status
                       >
1e4d : c042            >            cpy #$42
                       >            trap_ne         ;y changed
1e4f : f003            >        beq skip0757
                       >        trap            ;failed not equal (non zero)
1e51 : 20c740          >        jsr report_error
                       >
1e54 :                 >skip0757
                       >
1e54 : e000            >            cpx #0
                       >            trap_ne         ;x changed
1e56 : f003            >        beq skip0759
                       >        trap            ;failed not equal (non zero)
1e58 : 20c740          >        jsr report_error
                       >
1e5b :                 >skip0759
                       >
                        
                                nop_test $82,2
1e5b : a042            >            ldy #$42
1e5d : a202            >            ldx #4-2
1e5f : 82              >            db  $82          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
1e60 : c8              >            iny
1e61 : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
1e62 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
1e63 : f003            >        beq skip0762
                       >        trap            ;failed not equal (non zero)
1e65 : 20c740          >        jsr report_error
                       >
1e68 :                 >skip0762
                       >
                       >            set_a $ff-$82,0
                       >            load_flag 0
1e68 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1e6a : 48              >            pha         ;use stack to load status
1e6b : a97d            >            lda #$ff-$82     ;precharge accu
1e6d : 28              >            plp
                       >
1e6e : 82              >            db  $82          ;test nop integrity - flags off
1e6f : ea              >            nop
1e70 : ea              >            nop
                       >            tst_a $ff-$82,0
1e71 : 08              >            php         ;save flags
1e72 : c97d            >            cmp #$ff-$82     ;test result
                       >            trap_ne
1e74 : f003            >        beq skip0767
                       >        trap            ;failed not equal (non zero)
1e76 : 20c740          >        jsr report_error
                       >
1e79 :                 >skip0767
                       >
1e79 : 68              >            pla         ;load status
1e7a : 48              >            pha
                       >            cmp_flag 0
1e7b : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1e7d : f003            >        beq skip0770
                       >        trap            ;failed not equal (non zero)
1e7f : 20c740          >        jsr report_error
                       >
1e82 :                 >skip0770
                       >
1e82 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$82,$ff
                       >            load_flag $ff
1e83 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1e85 : 48              >            pha         ;use stack to load status
1e86 : a928            >            lda #$aa-$82     ;precharge accu
1e88 : 28              >            plp
                       >
1e89 : 82              >            db  $82          ;test nop integrity - flags on
1e8a : ea              >            nop
1e8b : ea              >            nop
                       >            tst_a $aa-$82,$ff
1e8c : 08              >            php         ;save flags
1e8d : c928            >            cmp #$aa-$82     ;test result
                       >            trap_ne
1e8f : f003            >        beq skip0775
                       >        trap            ;failed not equal (non zero)
1e91 : 20c740          >        jsr report_error
                       >
1e94 :                 >skip0775
                       >
1e94 : 68              >            pla         ;load status
1e95 : 48              >            pha
                       >            cmp_flag $ff
1e96 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1e98 : f003            >        beq skip0778
                       >        trap            ;failed not equal (non zero)
1e9a : 20c740          >        jsr report_error
                       >
1e9d :                 >skip0778
                       >
1e9d : 28              >            plp         ;restore status
                       >
1e9e : c042            >            cpy #$42
                       >            trap_ne         ;y changed
1ea0 : f003            >        beq skip0780
                       >        trap            ;failed not equal (non zero)
1ea2 : 20c740          >        jsr report_error
                       >
1ea5 :                 >skip0780
                       >
1ea5 : e000            >            cpx #0
                       >            trap_ne         ;x changed
1ea7 : f003            >        beq skip0782
                       >        trap            ;failed not equal (non zero)
1ea9 : 20c740          >        jsr report_error
                       >
1eac :                 >skip0782
                       >
                        
                                nop_test $c2,2
1eac : a042            >            ldy #$42
1eae : a202            >            ldx #4-2
1eb0 : c2              >            db  $c2          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
1eb1 : c8              >            iny
1eb2 : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
1eb3 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
1eb4 : f003            >        beq skip0785
                       >        trap            ;failed not equal (non zero)
1eb6 : 20c740          >        jsr report_error
                       >
1eb9 :                 >skip0785
                       >
                       >            set_a $ff-$c2,0
                       >            load_flag 0
1eb9 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1ebb : 48              >            pha         ;use stack to load status
1ebc : a93d            >            lda #$ff-$c2     ;precharge accu
1ebe : 28              >            plp
                       >
1ebf : c2              >            db  $c2          ;test nop integrity - flags off
1ec0 : ea              >            nop
1ec1 : ea              >            nop
                       >            tst_a $ff-$c2,0
1ec2 : 08              >            php         ;save flags
1ec3 : c93d            >            cmp #$ff-$c2     ;test result
                       >            trap_ne
1ec5 : f003            >        beq skip0790
                       >        trap            ;failed not equal (non zero)
1ec7 : 20c740          >        jsr report_error
                       >
1eca :                 >skip0790
                       >
1eca : 68              >            pla         ;load status
1ecb : 48              >            pha
                       >            cmp_flag 0
1ecc : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1ece : f003            >        beq skip0793
                       >        trap            ;failed not equal (non zero)
1ed0 : 20c740          >        jsr report_error
                       >
1ed3 :                 >skip0793
                       >
1ed3 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$c2,$ff
                       >            load_flag $ff
1ed4 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1ed6 : 48              >            pha         ;use stack to load status
1ed7 : a9e8            >            lda #$aa-$c2     ;precharge accu
1ed9 : 28              >            plp
                       >
1eda : c2              >            db  $c2          ;test nop integrity - flags on
1edb : ea              >            nop
1edc : ea              >            nop
                       >            tst_a $aa-$c2,$ff
1edd : 08              >            php         ;save flags
1ede : c9e8            >            cmp #$aa-$c2     ;test result
                       >            trap_ne
1ee0 : f003            >        beq skip0798
                       >        trap            ;failed not equal (non zero)
1ee2 : 20c740          >        jsr report_error
                       >
1ee5 :                 >skip0798
                       >
1ee5 : 68              >            pla         ;load status
1ee6 : 48              >            pha
                       >            cmp_flag $ff
1ee7 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1ee9 : f003            >        beq skip0801
                       >        trap            ;failed not equal (non zero)
1eeb : 20c740          >        jsr report_error
                       >
1eee :                 >skip0801
                       >
1eee : 28              >            plp         ;restore status
                       >
1eef : c042            >            cpy #$42
                       >            trap_ne         ;y changed
1ef1 : f003            >        beq skip0803
                       >        trap            ;failed not equal (non zero)
1ef3 : 20c740          >        jsr report_error
                       >
1ef6 :                 >skip0803
                       >
1ef6 : e000            >            cpx #0
                       >            trap_ne         ;x changed
1ef8 : f003            >        beq skip0805
                       >        trap            ;failed not equal (non zero)
1efa : 20c740          >        jsr report_error
                       >
1efd :                 >skip0805
                       >
                        
                                nop_test $e2,2
1efd : a042            >            ldy #$42
1eff : a202            >            ldx #4-2
1f01 : e2              >            db  $e2          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
1f02 : c8              >            iny
1f03 : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
1f04 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
1f05 : f003            >        beq skip0808
                       >        trap            ;failed not equal (non zero)
1f07 : 20c740          >        jsr report_error
                       >
1f0a :                 >skip0808
                       >
                       >            set_a $ff-$e2,0
                       >            load_flag 0
1f0a : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1f0c : 48              >            pha         ;use stack to load status
1f0d : a91d            >            lda #$ff-$e2     ;precharge accu
1f0f : 28              >            plp
                       >
1f10 : e2              >            db  $e2          ;test nop integrity - flags off
1f11 : ea              >            nop
1f12 : ea              >            nop
                       >            tst_a $ff-$e2,0
1f13 : 08              >            php         ;save flags
1f14 : c91d            >            cmp #$ff-$e2     ;test result
                       >            trap_ne
1f16 : f003            >        beq skip0813
                       >        trap            ;failed not equal (non zero)
1f18 : 20c740          >        jsr report_error
                       >
1f1b :                 >skip0813
                       >
1f1b : 68              >            pla         ;load status
1f1c : 48              >            pha
                       >            cmp_flag 0
1f1d : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1f1f : f003            >        beq skip0816
                       >        trap            ;failed not equal (non zero)
1f21 : 20c740          >        jsr report_error
                       >
1f24 :                 >skip0816
                       >
1f24 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$e2,$ff
                       >            load_flag $ff
1f25 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1f27 : 48              >            pha         ;use stack to load status
1f28 : a9c8            >            lda #$aa-$e2     ;precharge accu
1f2a : 28              >            plp
                       >
1f2b : e2              >            db  $e2          ;test nop integrity - flags on
1f2c : ea              >            nop
1f2d : ea              >            nop
                       >            tst_a $aa-$e2,$ff
1f2e : 08              >            php         ;save flags
1f2f : c9c8            >            cmp #$aa-$e2     ;test result
                       >            trap_ne
1f31 : f003            >        beq skip0821
                       >        trap            ;failed not equal (non zero)
1f33 : 20c740          >        jsr report_error
                       >
1f36 :                 >skip0821
                       >
1f36 : 68              >            pla         ;load status
1f37 : 48              >            pha
                       >            cmp_flag $ff
1f38 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1f3a : f003            >        beq skip0824
                       >        trap            ;failed not equal (non zero)
1f3c : 20c740          >        jsr report_error
                       >
1f3f :                 >skip0824
                       >
1f3f : 28              >            plp         ;restore status
                       >
1f40 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
1f42 : f003            >        beq skip0826
                       >        trap            ;failed not equal (non zero)
1f44 : 20c740          >        jsr report_error
                       >
1f47 :                 >skip0826
                       >
1f47 : e000            >            cpx #0
                       >            trap_ne         ;x changed
1f49 : f003            >        beq skip0828
                       >        trap            ;failed not equal (non zero)
1f4b : 20c740          >        jsr report_error
                       >
1f4e :                 >skip0828
                       >
                        
                                nop_test $44,2
1f4e : a042            >            ldy #$42
1f50 : a202            >            ldx #4-2
1f52 : 44              >            db  $44          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
1f53 : c8              >            iny
1f54 : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
1f55 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
1f56 : f003            >        beq skip0831
                       >        trap            ;failed not equal (non zero)
1f58 : 20c740          >        jsr report_error
                       >
1f5b :                 >skip0831
                       >
                       >            set_a $ff-$44,0
                       >            load_flag 0
1f5b : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1f5d : 48              >            pha         ;use stack to load status
1f5e : a9bb            >            lda #$ff-$44     ;precharge accu
1f60 : 28              >            plp
                       >
1f61 : 44              >            db  $44          ;test nop integrity - flags off
1f62 : ea              >            nop
1f63 : ea              >            nop
                       >            tst_a $ff-$44,0
1f64 : 08              >            php         ;save flags
1f65 : c9bb            >            cmp #$ff-$44     ;test result
                       >            trap_ne
1f67 : f003            >        beq skip0836
                       >        trap            ;failed not equal (non zero)
1f69 : 20c740          >        jsr report_error
                       >
1f6c :                 >skip0836
                       >
1f6c : 68              >            pla         ;load status
1f6d : 48              >            pha
                       >            cmp_flag 0
1f6e : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1f70 : f003            >        beq skip0839
                       >        trap            ;failed not equal (non zero)
1f72 : 20c740          >        jsr report_error
                       >
1f75 :                 >skip0839
                       >
1f75 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$44,$ff
                       >            load_flag $ff
1f76 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1f78 : 48              >            pha         ;use stack to load status
1f79 : a966            >            lda #$aa-$44     ;precharge accu
1f7b : 28              >            plp
                       >
1f7c : 44              >            db  $44          ;test nop integrity - flags on
1f7d : ea              >            nop
1f7e : ea              >            nop
                       >            tst_a $aa-$44,$ff
1f7f : 08              >            php         ;save flags
1f80 : c966            >            cmp #$aa-$44     ;test result
                       >            trap_ne
1f82 : f003            >        beq skip0844
                       >        trap            ;failed not equal (non zero)
1f84 : 20c740          >        jsr report_error
                       >
1f87 :                 >skip0844
                       >
1f87 : 68              >            pla         ;load status
1f88 : 48              >            pha
                       >            cmp_flag $ff
1f89 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1f8b : f003            >        beq skip0847
                       >        trap            ;failed not equal (non zero)
1f8d : 20c740          >        jsr report_error
                       >
1f90 :                 >skip0847
                       >
1f90 : 28              >            plp         ;restore status
                       >
1f91 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
1f93 : f003            >        beq skip0849
                       >        trap            ;failed not equal (non zero)
1f95 : 20c740          >        jsr report_error
                       >
1f98 :                 >skip0849
                       >
1f98 : e000            >            cpx #0
                       >            trap_ne         ;x changed
1f9a : f003            >        beq skip0851
                       >        trap            ;failed not equal (non zero)
1f9c : 20c740          >        jsr report_error
                       >
1f9f :                 >skip0851
                       >
                        
                                nop_test $54,2
1f9f : a042            >            ldy #$42
1fa1 : a202            >            ldx #4-2
1fa3 : 54              >            db  $54          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
1fa4 : c8              >            iny
1fa5 : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
1fa6 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
1fa7 : f003            >        beq skip0854
                       >        trap            ;failed not equal (non zero)
1fa9 : 20c740          >        jsr report_error
                       >
1fac :                 >skip0854
                       >
                       >            set_a $ff-$54,0
                       >            load_flag 0
1fac : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1fae : 48              >            pha         ;use stack to load status
1faf : a9ab            >            lda #$ff-$54     ;precharge accu
1fb1 : 28              >            plp
                       >
1fb2 : 54              >            db  $54          ;test nop integrity - flags off
1fb3 : ea              >            nop
1fb4 : ea              >            nop
                       >            tst_a $ff-$54,0
1fb5 : 08              >            php         ;save flags
1fb6 : c9ab            >            cmp #$ff-$54     ;test result
                       >            trap_ne
1fb8 : f003            >        beq skip0859
                       >        trap            ;failed not equal (non zero)
1fba : 20c740          >        jsr report_error
                       >
1fbd :                 >skip0859
                       >
1fbd : 68              >            pla         ;load status
1fbe : 48              >            pha
                       >            cmp_flag 0
1fbf : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1fc1 : f003            >        beq skip0862
                       >        trap            ;failed not equal (non zero)
1fc3 : 20c740          >        jsr report_error
                       >
1fc6 :                 >skip0862
                       >
1fc6 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$54,$ff
                       >            load_flag $ff
1fc7 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
1fc9 : 48              >            pha         ;use stack to load status
1fca : a956            >            lda #$aa-$54     ;precharge accu
1fcc : 28              >            plp
                       >
1fcd : 54              >            db  $54          ;test nop integrity - flags on
1fce : ea              >            nop
1fcf : ea              >            nop
                       >            tst_a $aa-$54,$ff
1fd0 : 08              >            php         ;save flags
1fd1 : c956            >            cmp #$aa-$54     ;test result
                       >            trap_ne
1fd3 : f003            >        beq skip0867
                       >        trap            ;failed not equal (non zero)
1fd5 : 20c740          >        jsr report_error
                       >
1fd8 :                 >skip0867
                       >
1fd8 : 68              >            pla         ;load status
1fd9 : 48              >            pha
                       >            cmp_flag $ff
1fda : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
1fdc : f003            >        beq skip0870
                       >        trap            ;failed not equal (non zero)
1fde : 20c740          >        jsr report_error
                       >
1fe1 :                 >skip0870
                       >
1fe1 : 28              >            plp         ;restore status
                       >
1fe2 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
1fe4 : f003            >        beq skip0872
                       >        trap            ;failed not equal (non zero)
1fe6 : 20c740          >        jsr report_error
                       >
1fe9 :                 >skip0872
                       >
1fe9 : e000            >            cpx #0
                       >            trap_ne         ;x changed
1feb : f003            >        beq skip0874
                       >        trap            ;failed not equal (non zero)
1fed : 20c740          >        jsr report_error
                       >
1ff0 :                 >skip0874
                       >
                        
                                nop_test $d4,2
1ff0 : a042            >            ldy #$42
1ff2 : a202            >            ldx #4-2
1ff4 : d4              >            db  $d4          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
1ff5 : c8              >            iny
1ff6 : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
1ff7 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
1ff8 : f003            >        beq skip0877
                       >        trap            ;failed not equal (non zero)
1ffa : 20c740          >        jsr report_error
                       >
1ffd :                 >skip0877
                       >
                       >            set_a $ff-$d4,0
                       >            load_flag 0
1ffd : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
1fff : 48              >            pha         ;use stack to load status
2000 : a92b            >            lda #$ff-$d4     ;precharge accu
2002 : 28              >            plp
                       >
2003 : d4              >            db  $d4          ;test nop integrity - flags off
2004 : ea              >            nop
2005 : ea              >            nop
                       >            tst_a $ff-$d4,0
2006 : 08              >            php         ;save flags
2007 : c92b            >            cmp #$ff-$d4     ;test result
                       >            trap_ne
2009 : f003            >        beq skip0882
                       >        trap            ;failed not equal (non zero)
200b : 20c740          >        jsr report_error
                       >
200e :                 >skip0882
                       >
200e : 68              >            pla         ;load status
200f : 48              >            pha
                       >            cmp_flag 0
2010 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2012 : f003            >        beq skip0885
                       >        trap            ;failed not equal (non zero)
2014 : 20c740          >        jsr report_error
                       >
2017 :                 >skip0885
                       >
2017 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$d4,$ff
                       >            load_flag $ff
2018 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
201a : 48              >            pha         ;use stack to load status
201b : a9d6            >            lda #$aa-$d4     ;precharge accu
201d : 28              >            plp
                       >
201e : d4              >            db  $d4          ;test nop integrity - flags on
201f : ea              >            nop
2020 : ea              >            nop
                       >            tst_a $aa-$d4,$ff
2021 : 08              >            php         ;save flags
2022 : c9d6            >            cmp #$aa-$d4     ;test result
                       >            trap_ne
2024 : f003            >        beq skip0890
                       >        trap            ;failed not equal (non zero)
2026 : 20c740          >        jsr report_error
                       >
2029 :                 >skip0890
                       >
2029 : 68              >            pla         ;load status
202a : 48              >            pha
                       >            cmp_flag $ff
202b : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
202d : f003            >        beq skip0893
                       >        trap            ;failed not equal (non zero)
202f : 20c740          >        jsr report_error
                       >
2032 :                 >skip0893
                       >
2032 : 28              >            plp         ;restore status
                       >
2033 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2035 : f003            >        beq skip0895
                       >        trap            ;failed not equal (non zero)
2037 : 20c740          >        jsr report_error
                       >
203a :                 >skip0895
                       >
203a : e000            >            cpx #0
                       >            trap_ne         ;x changed
203c : f003            >        beq skip0897
                       >        trap            ;failed not equal (non zero)
203e : 20c740          >        jsr report_error
                       >
2041 :                 >skip0897
                       >
                        
                                nop_test $f4,2
2041 : a042            >            ldy #$42
2043 : a202            >            ldx #4-2
2045 : f4              >            db  $f4          ;test nop length
                       >        if 2 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 2 = 2
2046 : c8              >            iny
2047 : ca              >            dex
                       >        endif
                       >        if 2 = 3
                       >            iny
                       >            iny
                       >        endif
2048 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2049 : f003            >        beq skip0900
                       >        trap            ;failed not equal (non zero)
204b : 20c740          >        jsr report_error
                       >
204e :                 >skip0900
                       >
                       >            set_a $ff-$f4,0
                       >            load_flag 0
204e : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2050 : 48              >            pha         ;use stack to load status
2051 : a90b            >            lda #$ff-$f4     ;precharge accu
2053 : 28              >            plp
                       >
2054 : f4              >            db  $f4          ;test nop integrity - flags off
2055 : ea              >            nop
2056 : ea              >            nop
                       >            tst_a $ff-$f4,0
2057 : 08              >            php         ;save flags
2058 : c90b            >            cmp #$ff-$f4     ;test result
                       >            trap_ne
205a : f003            >        beq skip0905
                       >        trap            ;failed not equal (non zero)
205c : 20c740          >        jsr report_error
                       >
205f :                 >skip0905
                       >
205f : 68              >            pla         ;load status
2060 : 48              >            pha
                       >            cmp_flag 0
2061 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2063 : f003            >        beq skip0908
                       >        trap            ;failed not equal (non zero)
2065 : 20c740          >        jsr report_error
                       >
2068 :                 >skip0908
                       >
2068 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$f4,$ff
                       >            load_flag $ff
2069 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
206b : 48              >            pha         ;use stack to load status
206c : a9b6            >            lda #$aa-$f4     ;precharge accu
206e : 28              >            plp
                       >
206f : f4              >            db  $f4          ;test nop integrity - flags on
2070 : ea              >            nop
2071 : ea              >            nop
                       >            tst_a $aa-$f4,$ff
2072 : 08              >            php         ;save flags
2073 : c9b6            >            cmp #$aa-$f4     ;test result
                       >            trap_ne
2075 : f003            >        beq skip0913
                       >        trap            ;failed not equal (non zero)
2077 : 20c740          >        jsr report_error
                       >
207a :                 >skip0913
                       >
207a : 68              >            pla         ;load status
207b : 48              >            pha
                       >            cmp_flag $ff
207c : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
207e : f003            >        beq skip0916
                       >        trap            ;failed not equal (non zero)
2080 : 20c740          >        jsr report_error
                       >
2083 :                 >skip0916
                       >
2083 : 28              >            plp         ;restore status
                       >
2084 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2086 : f003            >        beq skip0918
                       >        trap            ;failed not equal (non zero)
2088 : 20c740          >        jsr report_error
                       >
208b :                 >skip0918
                       >
208b : e000            >            cpx #0
                       >            trap_ne         ;x changed
208d : f003            >        beq skip0920
                       >        trap            ;failed not equal (non zero)
208f : 20c740          >        jsr report_error
                       >
2092 :                 >skip0920
                       >
                        
                                nop_test $5c,3
2092 : a042            >            ldy #$42
2094 : a201            >            ldx #4-3
2096 : 5c              >            db  $5c          ;test nop length
                       >        if 3 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 3 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 3 = 3
2097 : c8              >            iny
2098 : c8              >            iny
                       >        endif
2099 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
209a : f003            >        beq skip0923
                       >        trap            ;failed not equal (non zero)
209c : 20c740          >        jsr report_error
                       >
209f :                 >skip0923
                       >
                       >            set_a $ff-$5c,0
                       >            load_flag 0
209f : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
20a1 : 48              >            pha         ;use stack to load status
20a2 : a9a3            >            lda #$ff-$5c     ;precharge accu
20a4 : 28              >            plp
                       >
20a5 : 5c              >            db  $5c          ;test nop integrity - flags off
20a6 : ea              >            nop
20a7 : ea              >            nop
                       >            tst_a $ff-$5c,0
20a8 : 08              >            php         ;save flags
20a9 : c9a3            >            cmp #$ff-$5c     ;test result
                       >            trap_ne
20ab : f003            >        beq skip0928
                       >        trap            ;failed not equal (non zero)
20ad : 20c740          >        jsr report_error
                       >
20b0 :                 >skip0928
                       >
20b0 : 68              >            pla         ;load status
20b1 : 48              >            pha
                       >            cmp_flag 0
20b2 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
20b4 : f003            >        beq skip0931
                       >        trap            ;failed not equal (non zero)
20b6 : 20c740          >        jsr report_error
                       >
20b9 :                 >skip0931
                       >
20b9 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$5c,$ff
                       >            load_flag $ff
20ba : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
20bc : 48              >            pha         ;use stack to load status
20bd : a94e            >            lda #$aa-$5c     ;precharge accu
20bf : 28              >            plp
                       >
20c0 : 5c              >            db  $5c          ;test nop integrity - flags on
20c1 : ea              >            nop
20c2 : ea              >            nop
                       >            tst_a $aa-$5c,$ff
20c3 : 08              >            php         ;save flags
20c4 : c94e            >            cmp #$aa-$5c     ;test result
                       >            trap_ne
20c6 : f003            >        beq skip0936
                       >        trap            ;failed not equal (non zero)
20c8 : 20c740          >        jsr report_error
                       >
20cb :                 >skip0936
                       >
20cb : 68              >            pla         ;load status
20cc : 48              >            pha
                       >            cmp_flag $ff
20cd : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
20cf : f003            >        beq skip0939
                       >        trap            ;failed not equal (non zero)
20d1 : 20c740          >        jsr report_error
                       >
20d4 :                 >skip0939
                       >
20d4 : 28              >            plp         ;restore status
                       >
20d5 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
20d7 : f003            >        beq skip0941
                       >        trap            ;failed not equal (non zero)
20d9 : 20c740          >        jsr report_error
                       >
20dc :                 >skip0941
                       >
20dc : e000            >            cpx #0
                       >            trap_ne         ;x changed
20de : f003            >        beq skip0943
                       >        trap            ;failed not equal (non zero)
20e0 : 20c740          >        jsr report_error
                       >
20e3 :                 >skip0943
                       >
                        
                                nop_test $dc,3
20e3 : a042            >            ldy #$42
20e5 : a201            >            ldx #4-3
20e7 : dc              >            db  $dc          ;test nop length
                       >        if 3 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 3 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 3 = 3
20e8 : c8              >            iny
20e9 : c8              >            iny
                       >        endif
20ea : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
20eb : f003            >        beq skip0946
                       >        trap            ;failed not equal (non zero)
20ed : 20c740          >        jsr report_error
                       >
20f0 :                 >skip0946
                       >
                       >            set_a $ff-$dc,0
                       >            load_flag 0
20f0 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
20f2 : 48              >            pha         ;use stack to load status
20f3 : a923            >            lda #$ff-$dc     ;precharge accu
20f5 : 28              >            plp
                       >
20f6 : dc              >            db  $dc          ;test nop integrity - flags off
20f7 : ea              >            nop
20f8 : ea              >            nop
                       >            tst_a $ff-$dc,0
20f9 : 08              >            php         ;save flags
20fa : c923            >            cmp #$ff-$dc     ;test result
                       >            trap_ne
20fc : f003            >        beq skip0951
                       >        trap            ;failed not equal (non zero)
20fe : 20c740          >        jsr report_error
                       >
2101 :                 >skip0951
                       >
2101 : 68              >            pla         ;load status
2102 : 48              >            pha
                       >            cmp_flag 0
2103 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2105 : f003            >        beq skip0954
                       >        trap            ;failed not equal (non zero)
2107 : 20c740          >        jsr report_error
                       >
210a :                 >skip0954
                       >
210a : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$dc,$ff
                       >            load_flag $ff
210b : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
210d : 48              >            pha         ;use stack to load status
210e : a9ce            >            lda #$aa-$dc     ;precharge accu
2110 : 28              >            plp
                       >
2111 : dc              >            db  $dc          ;test nop integrity - flags on
2112 : ea              >            nop
2113 : ea              >            nop
                       >            tst_a $aa-$dc,$ff
2114 : 08              >            php         ;save flags
2115 : c9ce            >            cmp #$aa-$dc     ;test result
                       >            trap_ne
2117 : f003            >        beq skip0959
                       >        trap            ;failed not equal (non zero)
2119 : 20c740          >        jsr report_error
                       >
211c :                 >skip0959
                       >
211c : 68              >            pla         ;load status
211d : 48              >            pha
                       >            cmp_flag $ff
211e : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2120 : f003            >        beq skip0962
                       >        trap            ;failed not equal (non zero)
2122 : 20c740          >        jsr report_error
                       >
2125 :                 >skip0962
                       >
2125 : 28              >            plp         ;restore status
                       >
2126 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2128 : f003            >        beq skip0964
                       >        trap            ;failed not equal (non zero)
212a : 20c740          >        jsr report_error
                       >
212d :                 >skip0964
                       >
212d : e000            >            cpx #0
                       >            trap_ne         ;x changed
212f : f003            >        beq skip0966
                       >        trap            ;failed not equal (non zero)
2131 : 20c740          >        jsr report_error
                       >
2134 :                 >skip0966
                       >
                        
                                nop_test $fc,3
2134 : a042            >            ldy #$42
2136 : a201            >            ldx #4-3
2138 : fc              >            db  $fc          ;test nop length
                       >        if 3 = 1
                       >            dex
                       >            dex
                       >        endif
                       >        if 3 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 3 = 3
2139 : c8              >            iny
213a : c8              >            iny
                       >        endif
213b : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
213c : f003            >        beq skip0969
                       >        trap            ;failed not equal (non zero)
213e : 20c740          >        jsr report_error
                       >
2141 :                 >skip0969
                       >
                       >            set_a $ff-$fc,0
                       >            load_flag 0
2141 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2143 : 48              >            pha         ;use stack to load status
2144 : a903            >            lda #$ff-$fc     ;precharge accu
2146 : 28              >            plp
                       >
2147 : fc              >            db  $fc          ;test nop integrity - flags off
2148 : ea              >            nop
2149 : ea              >            nop
                       >            tst_a $ff-$fc,0
214a : 08              >            php         ;save flags
214b : c903            >            cmp #$ff-$fc     ;test result
                       >            trap_ne
214d : f003            >        beq skip0974
                       >        trap            ;failed not equal (non zero)
214f : 20c740          >        jsr report_error
                       >
2152 :                 >skip0974
                       >
2152 : 68              >            pla         ;load status
2153 : 48              >            pha
                       >            cmp_flag 0
2154 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2156 : f003            >        beq skip0977
                       >        trap            ;failed not equal (non zero)
2158 : 20c740          >        jsr report_error
                       >
215b :                 >skip0977
                       >
215b : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$fc,$ff
                       >            load_flag $ff
215c : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
215e : 48              >            pha         ;use stack to load status
215f : a9ae            >            lda #$aa-$fc     ;precharge accu
2161 : 28              >            plp
                       >
2162 : fc              >            db  $fc          ;test nop integrity - flags on
2163 : ea              >            nop
2164 : ea              >            nop
                       >            tst_a $aa-$fc,$ff
2165 : 08              >            php         ;save flags
2166 : c9ae            >            cmp #$aa-$fc     ;test result
                       >            trap_ne
2168 : f003            >        beq skip0982
                       >        trap            ;failed not equal (non zero)
216a : 20c740          >        jsr report_error
                       >
216d :                 >skip0982
                       >
216d : 68              >            pla         ;load status
216e : 48              >            pha
                       >            cmp_flag $ff
216f : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2171 : f003            >        beq skip0985
                       >        trap            ;failed not equal (non zero)
2173 : 20c740          >        jsr report_error
                       >
2176 :                 >skip0985
                       >
2176 : 28              >            plp         ;restore status
                       >
2177 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2179 : f003            >        beq skip0987
                       >        trap            ;failed not equal (non zero)
217b : 20c740          >        jsr report_error
                       >
217e :                 >skip0987
                       >
217e : e000            >            cpx #0
                       >            trap_ne         ;x changed
2180 : f003            >        beq skip0989
                       >        trap            ;failed not equal (non zero)
2182 : 20c740          >        jsr report_error
                       >
2185 :                 >skip0989
                       >
                        
                                nop_test $03,1
2185 : a042            >            ldy #$42
2187 : a203            >            ldx #4-1
2189 : 03              >            db  $03          ;test nop length
                       >        if 1 = 1
218a : ca              >            dex
218b : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
218c : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
218d : f003            >        beq skip0992
                       >        trap            ;failed not equal (non zero)
218f : 20c740          >        jsr report_error
                       >
2192 :                 >skip0992
                       >
                       >            set_a $ff-$03,0
                       >            load_flag 0
2192 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2194 : 48              >            pha         ;use stack to load status
2195 : a9fc            >            lda #$ff-$03     ;precharge accu
2197 : 28              >            plp
                       >
2198 : 03              >            db  $03          ;test nop integrity - flags off
2199 : ea              >            nop
219a : ea              >            nop
                       >            tst_a $ff-$03,0
219b : 08              >            php         ;save flags
219c : c9fc            >            cmp #$ff-$03     ;test result
                       >            trap_ne
219e : f003            >        beq skip0997
                       >        trap            ;failed not equal (non zero)
21a0 : 20c740          >        jsr report_error
                       >
21a3 :                 >skip0997
                       >
21a3 : 68              >            pla         ;load status
21a4 : 48              >            pha
                       >            cmp_flag 0
21a5 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
21a7 : f003            >        beq skip1000
                       >        trap            ;failed not equal (non zero)
21a9 : 20c740          >        jsr report_error
                       >
21ac :                 >skip1000
                       >
21ac : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$03,$ff
                       >            load_flag $ff
21ad : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
21af : 48              >            pha         ;use stack to load status
21b0 : a9a7            >            lda #$aa-$03     ;precharge accu
21b2 : 28              >            plp
                       >
21b3 : 03              >            db  $03          ;test nop integrity - flags on
21b4 : ea              >            nop
21b5 : ea              >            nop
                       >            tst_a $aa-$03,$ff
21b6 : 08              >            php         ;save flags
21b7 : c9a7            >            cmp #$aa-$03     ;test result
                       >            trap_ne
21b9 : f003            >        beq skip1005
                       >        trap            ;failed not equal (non zero)
21bb : 20c740          >        jsr report_error
                       >
21be :                 >skip1005
                       >
21be : 68              >            pla         ;load status
21bf : 48              >            pha
                       >            cmp_flag $ff
21c0 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
21c2 : f003            >        beq skip1008
                       >        trap            ;failed not equal (non zero)
21c4 : 20c740          >        jsr report_error
                       >
21c7 :                 >skip1008
                       >
21c7 : 28              >            plp         ;restore status
                       >
21c8 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
21ca : f003            >        beq skip1010
                       >        trap            ;failed not equal (non zero)
21cc : 20c740          >        jsr report_error
                       >
21cf :                 >skip1010
                       >
21cf : e000            >            cpx #0
                       >            trap_ne         ;x changed
21d1 : f003            >        beq skip1012
                       >        trap            ;failed not equal (non zero)
21d3 : 20c740          >        jsr report_error
                       >
21d6 :                 >skip1012
                       >
                        
                                nop_test $13,1
21d6 : a042            >            ldy #$42
21d8 : a203            >            ldx #4-1
21da : 13              >            db  $13          ;test nop length
                       >        if 1 = 1
21db : ca              >            dex
21dc : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
21dd : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
21de : f003            >        beq skip1015
                       >        trap            ;failed not equal (non zero)
21e0 : 20c740          >        jsr report_error
                       >
21e3 :                 >skip1015
                       >
                       >            set_a $ff-$13,0
                       >            load_flag 0
21e3 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
21e5 : 48              >            pha         ;use stack to load status
21e6 : a9ec            >            lda #$ff-$13     ;precharge accu
21e8 : 28              >            plp
                       >
21e9 : 13              >            db  $13          ;test nop integrity - flags off
21ea : ea              >            nop
21eb : ea              >            nop
                       >            tst_a $ff-$13,0
21ec : 08              >            php         ;save flags
21ed : c9ec            >            cmp #$ff-$13     ;test result
                       >            trap_ne
21ef : f003            >        beq skip1020
                       >        trap            ;failed not equal (non zero)
21f1 : 20c740          >        jsr report_error
                       >
21f4 :                 >skip1020
                       >
21f4 : 68              >            pla         ;load status
21f5 : 48              >            pha
                       >            cmp_flag 0
21f6 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
21f8 : f003            >        beq skip1023
                       >        trap            ;failed not equal (non zero)
21fa : 20c740          >        jsr report_error
                       >
21fd :                 >skip1023
                       >
21fd : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$13,$ff
                       >            load_flag $ff
21fe : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2200 : 48              >            pha         ;use stack to load status
2201 : a997            >            lda #$aa-$13     ;precharge accu
2203 : 28              >            plp
                       >
2204 : 13              >            db  $13          ;test nop integrity - flags on
2205 : ea              >            nop
2206 : ea              >            nop
                       >            tst_a $aa-$13,$ff
2207 : 08              >            php         ;save flags
2208 : c997            >            cmp #$aa-$13     ;test result
                       >            trap_ne
220a : f003            >        beq skip1028
                       >        trap            ;failed not equal (non zero)
220c : 20c740          >        jsr report_error
                       >
220f :                 >skip1028
                       >
220f : 68              >            pla         ;load status
2210 : 48              >            pha
                       >            cmp_flag $ff
2211 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2213 : f003            >        beq skip1031
                       >        trap            ;failed not equal (non zero)
2215 : 20c740          >        jsr report_error
                       >
2218 :                 >skip1031
                       >
2218 : 28              >            plp         ;restore status
                       >
2219 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
221b : f003            >        beq skip1033
                       >        trap            ;failed not equal (non zero)
221d : 20c740          >        jsr report_error
                       >
2220 :                 >skip1033
                       >
2220 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2222 : f003            >        beq skip1035
                       >        trap            ;failed not equal (non zero)
2224 : 20c740          >        jsr report_error
                       >
2227 :                 >skip1035
                       >
                        
                                nop_test $23,1
2227 : a042            >            ldy #$42
2229 : a203            >            ldx #4-1
222b : 23              >            db  $23          ;test nop length
                       >        if 1 = 1
222c : ca              >            dex
222d : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
222e : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
222f : f003            >        beq skip1038
                       >        trap            ;failed not equal (non zero)
2231 : 20c740          >        jsr report_error
                       >
2234 :                 >skip1038
                       >
                       >            set_a $ff-$23,0
                       >            load_flag 0
2234 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2236 : 48              >            pha         ;use stack to load status
2237 : a9dc            >            lda #$ff-$23     ;precharge accu
2239 : 28              >            plp
                       >
223a : 23              >            db  $23          ;test nop integrity - flags off
223b : ea              >            nop
223c : ea              >            nop
                       >            tst_a $ff-$23,0
223d : 08              >            php         ;save flags
223e : c9dc            >            cmp #$ff-$23     ;test result
                       >            trap_ne
2240 : f003            >        beq skip1043
                       >        trap            ;failed not equal (non zero)
2242 : 20c740          >        jsr report_error
                       >
2245 :                 >skip1043
                       >
2245 : 68              >            pla         ;load status
2246 : 48              >            pha
                       >            cmp_flag 0
2247 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2249 : f003            >        beq skip1046
                       >        trap            ;failed not equal (non zero)
224b : 20c740          >        jsr report_error
                       >
224e :                 >skip1046
                       >
224e : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$23,$ff
                       >            load_flag $ff
224f : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2251 : 48              >            pha         ;use stack to load status
2252 : a987            >            lda #$aa-$23     ;precharge accu
2254 : 28              >            plp
                       >
2255 : 23              >            db  $23          ;test nop integrity - flags on
2256 : ea              >            nop
2257 : ea              >            nop
                       >            tst_a $aa-$23,$ff
2258 : 08              >            php         ;save flags
2259 : c987            >            cmp #$aa-$23     ;test result
                       >            trap_ne
225b : f003            >        beq skip1051
                       >        trap            ;failed not equal (non zero)
225d : 20c740          >        jsr report_error
                       >
2260 :                 >skip1051
                       >
2260 : 68              >            pla         ;load status
2261 : 48              >            pha
                       >            cmp_flag $ff
2262 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2264 : f003            >        beq skip1054
                       >        trap            ;failed not equal (non zero)
2266 : 20c740          >        jsr report_error
                       >
2269 :                 >skip1054
                       >
2269 : 28              >            plp         ;restore status
                       >
226a : c042            >            cpy #$42
                       >            trap_ne         ;y changed
226c : f003            >        beq skip1056
                       >        trap            ;failed not equal (non zero)
226e : 20c740          >        jsr report_error
                       >
2271 :                 >skip1056
                       >
2271 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2273 : f003            >        beq skip1058
                       >        trap            ;failed not equal (non zero)
2275 : 20c740          >        jsr report_error
                       >
2278 :                 >skip1058
                       >
                        
                                nop_test $33,1
2278 : a042            >            ldy #$42
227a : a203            >            ldx #4-1
227c : 33              >            db  $33          ;test nop length
                       >        if 1 = 1
227d : ca              >            dex
227e : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
227f : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2280 : f003            >        beq skip1061
                       >        trap            ;failed not equal (non zero)
2282 : 20c740          >        jsr report_error
                       >
2285 :                 >skip1061
                       >
                       >            set_a $ff-$33,0
                       >            load_flag 0
2285 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2287 : 48              >            pha         ;use stack to load status
2288 : a9cc            >            lda #$ff-$33     ;precharge accu
228a : 28              >            plp
                       >
228b : 33              >            db  $33          ;test nop integrity - flags off
228c : ea              >            nop
228d : ea              >            nop
                       >            tst_a $ff-$33,0
228e : 08              >            php         ;save flags
228f : c9cc            >            cmp #$ff-$33     ;test result
                       >            trap_ne
2291 : f003            >        beq skip1066
                       >        trap            ;failed not equal (non zero)
2293 : 20c740          >        jsr report_error
                       >
2296 :                 >skip1066
                       >
2296 : 68              >            pla         ;load status
2297 : 48              >            pha
                       >            cmp_flag 0
2298 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
229a : f003            >        beq skip1069
                       >        trap            ;failed not equal (non zero)
229c : 20c740          >        jsr report_error
                       >
229f :                 >skip1069
                       >
229f : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$33,$ff
                       >            load_flag $ff
22a0 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
22a2 : 48              >            pha         ;use stack to load status
22a3 : a977            >            lda #$aa-$33     ;precharge accu
22a5 : 28              >            plp
                       >
22a6 : 33              >            db  $33          ;test nop integrity - flags on
22a7 : ea              >            nop
22a8 : ea              >            nop
                       >            tst_a $aa-$33,$ff
22a9 : 08              >            php         ;save flags
22aa : c977            >            cmp #$aa-$33     ;test result
                       >            trap_ne
22ac : f003            >        beq skip1074
                       >        trap            ;failed not equal (non zero)
22ae : 20c740          >        jsr report_error
                       >
22b1 :                 >skip1074
                       >
22b1 : 68              >            pla         ;load status
22b2 : 48              >            pha
                       >            cmp_flag $ff
22b3 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
22b5 : f003            >        beq skip1077
                       >        trap            ;failed not equal (non zero)
22b7 : 20c740          >        jsr report_error
                       >
22ba :                 >skip1077
                       >
22ba : 28              >            plp         ;restore status
                       >
22bb : c042            >            cpy #$42
                       >            trap_ne         ;y changed
22bd : f003            >        beq skip1079
                       >        trap            ;failed not equal (non zero)
22bf : 20c740          >        jsr report_error
                       >
22c2 :                 >skip1079
                       >
22c2 : e000            >            cpx #0
                       >            trap_ne         ;x changed
22c4 : f003            >        beq skip1081
                       >        trap            ;failed not equal (non zero)
22c6 : 20c740          >        jsr report_error
                       >
22c9 :                 >skip1081
                       >
                        
                                nop_test $43,1
22c9 : a042            >            ldy #$42
22cb : a203            >            ldx #4-1
22cd : 43              >            db  $43          ;test nop length
                       >        if 1 = 1
22ce : ca              >            dex
22cf : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
22d0 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
22d1 : f003            >        beq skip1084
                       >        trap            ;failed not equal (non zero)
22d3 : 20c740          >        jsr report_error
                       >
22d6 :                 >skip1084
                       >
                       >            set_a $ff-$43,0
                       >            load_flag 0
22d6 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
22d8 : 48              >            pha         ;use stack to load status
22d9 : a9bc            >            lda #$ff-$43     ;precharge accu
22db : 28              >            plp
                       >
22dc : 43              >            db  $43          ;test nop integrity - flags off
22dd : ea              >            nop
22de : ea              >            nop
                       >            tst_a $ff-$43,0
22df : 08              >            php         ;save flags
22e0 : c9bc            >            cmp #$ff-$43     ;test result
                       >            trap_ne
22e2 : f003            >        beq skip1089
                       >        trap            ;failed not equal (non zero)
22e4 : 20c740          >        jsr report_error
                       >
22e7 :                 >skip1089
                       >
22e7 : 68              >            pla         ;load status
22e8 : 48              >            pha
                       >            cmp_flag 0
22e9 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
22eb : f003            >        beq skip1092
                       >        trap            ;failed not equal (non zero)
22ed : 20c740          >        jsr report_error
                       >
22f0 :                 >skip1092
                       >
22f0 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$43,$ff
                       >            load_flag $ff
22f1 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
22f3 : 48              >            pha         ;use stack to load status
22f4 : a967            >            lda #$aa-$43     ;precharge accu
22f6 : 28              >            plp
                       >
22f7 : 43              >            db  $43          ;test nop integrity - flags on
22f8 : ea              >            nop
22f9 : ea              >            nop
                       >            tst_a $aa-$43,$ff
22fa : 08              >            php         ;save flags
22fb : c967            >            cmp #$aa-$43     ;test result
                       >            trap_ne
22fd : f003            >        beq skip1097
                       >        trap            ;failed not equal (non zero)
22ff : 20c740          >        jsr report_error
                       >
2302 :                 >skip1097
                       >
2302 : 68              >            pla         ;load status
2303 : 48              >            pha
                       >            cmp_flag $ff
2304 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2306 : f003            >        beq skip1100
                       >        trap            ;failed not equal (non zero)
2308 : 20c740          >        jsr report_error
                       >
230b :                 >skip1100
                       >
230b : 28              >            plp         ;restore status
                       >
230c : c042            >            cpy #$42
                       >            trap_ne         ;y changed
230e : f003            >        beq skip1102
                       >        trap            ;failed not equal (non zero)
2310 : 20c740          >        jsr report_error
                       >
2313 :                 >skip1102
                       >
2313 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2315 : f003            >        beq skip1104
                       >        trap            ;failed not equal (non zero)
2317 : 20c740          >        jsr report_error
                       >
231a :                 >skip1104
                       >
                        
                                nop_test $53,1
231a : a042            >            ldy #$42
231c : a203            >            ldx #4-1
231e : 53              >            db  $53          ;test nop length
                       >        if 1 = 1
231f : ca              >            dex
2320 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2321 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2322 : f003            >        beq skip1107
                       >        trap            ;failed not equal (non zero)
2324 : 20c740          >        jsr report_error
                       >
2327 :                 >skip1107
                       >
                       >            set_a $ff-$53,0
                       >            load_flag 0
2327 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2329 : 48              >            pha         ;use stack to load status
232a : a9ac            >            lda #$ff-$53     ;precharge accu
232c : 28              >            plp
                       >
232d : 53              >            db  $53          ;test nop integrity - flags off
232e : ea              >            nop
232f : ea              >            nop
                       >            tst_a $ff-$53,0
2330 : 08              >            php         ;save flags
2331 : c9ac            >            cmp #$ff-$53     ;test result
                       >            trap_ne
2333 : f003            >        beq skip1112
                       >        trap            ;failed not equal (non zero)
2335 : 20c740          >        jsr report_error
                       >
2338 :                 >skip1112
                       >
2338 : 68              >            pla         ;load status
2339 : 48              >            pha
                       >            cmp_flag 0
233a : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
233c : f003            >        beq skip1115
                       >        trap            ;failed not equal (non zero)
233e : 20c740          >        jsr report_error
                       >
2341 :                 >skip1115
                       >
2341 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$53,$ff
                       >            load_flag $ff
2342 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2344 : 48              >            pha         ;use stack to load status
2345 : a957            >            lda #$aa-$53     ;precharge accu
2347 : 28              >            plp
                       >
2348 : 53              >            db  $53          ;test nop integrity - flags on
2349 : ea              >            nop
234a : ea              >            nop
                       >            tst_a $aa-$53,$ff
234b : 08              >            php         ;save flags
234c : c957            >            cmp #$aa-$53     ;test result
                       >            trap_ne
234e : f003            >        beq skip1120
                       >        trap            ;failed not equal (non zero)
2350 : 20c740          >        jsr report_error
                       >
2353 :                 >skip1120
                       >
2353 : 68              >            pla         ;load status
2354 : 48              >            pha
                       >            cmp_flag $ff
2355 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2357 : f003            >        beq skip1123
                       >        trap            ;failed not equal (non zero)
2359 : 20c740          >        jsr report_error
                       >
235c :                 >skip1123
                       >
235c : 28              >            plp         ;restore status
                       >
235d : c042            >            cpy #$42
                       >            trap_ne         ;y changed
235f : f003            >        beq skip1125
                       >        trap            ;failed not equal (non zero)
2361 : 20c740          >        jsr report_error
                       >
2364 :                 >skip1125
                       >
2364 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2366 : f003            >        beq skip1127
                       >        trap            ;failed not equal (non zero)
2368 : 20c740          >        jsr report_error
                       >
236b :                 >skip1127
                       >
                        
                                nop_test $63,1
236b : a042            >            ldy #$42
236d : a203            >            ldx #4-1
236f : 63              >            db  $63          ;test nop length
                       >        if 1 = 1
2370 : ca              >            dex
2371 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2372 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2373 : f003            >        beq skip1130
                       >        trap            ;failed not equal (non zero)
2375 : 20c740          >        jsr report_error
                       >
2378 :                 >skip1130
                       >
                       >            set_a $ff-$63,0
                       >            load_flag 0
2378 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
237a : 48              >            pha         ;use stack to load status
237b : a99c            >            lda #$ff-$63     ;precharge accu
237d : 28              >            plp
                       >
237e : 63              >            db  $63          ;test nop integrity - flags off
237f : ea              >            nop
2380 : ea              >            nop
                       >            tst_a $ff-$63,0
2381 : 08              >            php         ;save flags
2382 : c99c            >            cmp #$ff-$63     ;test result
                       >            trap_ne
2384 : f003            >        beq skip1135
                       >        trap            ;failed not equal (non zero)
2386 : 20c740          >        jsr report_error
                       >
2389 :                 >skip1135
                       >
2389 : 68              >            pla         ;load status
238a : 48              >            pha
                       >            cmp_flag 0
238b : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
238d : f003            >        beq skip1138
                       >        trap            ;failed not equal (non zero)
238f : 20c740          >        jsr report_error
                       >
2392 :                 >skip1138
                       >
2392 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$63,$ff
                       >            load_flag $ff
2393 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2395 : 48              >            pha         ;use stack to load status
2396 : a947            >            lda #$aa-$63     ;precharge accu
2398 : 28              >            plp
                       >
2399 : 63              >            db  $63          ;test nop integrity - flags on
239a : ea              >            nop
239b : ea              >            nop
                       >            tst_a $aa-$63,$ff
239c : 08              >            php         ;save flags
239d : c947            >            cmp #$aa-$63     ;test result
                       >            trap_ne
239f : f003            >        beq skip1143
                       >        trap            ;failed not equal (non zero)
23a1 : 20c740          >        jsr report_error
                       >
23a4 :                 >skip1143
                       >
23a4 : 68              >            pla         ;load status
23a5 : 48              >            pha
                       >            cmp_flag $ff
23a6 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
23a8 : f003            >        beq skip1146
                       >        trap            ;failed not equal (non zero)
23aa : 20c740          >        jsr report_error
                       >
23ad :                 >skip1146
                       >
23ad : 28              >            plp         ;restore status
                       >
23ae : c042            >            cpy #$42
                       >            trap_ne         ;y changed
23b0 : f003            >        beq skip1148
                       >        trap            ;failed not equal (non zero)
23b2 : 20c740          >        jsr report_error
                       >
23b5 :                 >skip1148
                       >
23b5 : e000            >            cpx #0
                       >            trap_ne         ;x changed
23b7 : f003            >        beq skip1150
                       >        trap            ;failed not equal (non zero)
23b9 : 20c740          >        jsr report_error
                       >
23bc :                 >skip1150
                       >
                        
                                nop_test $73,1
23bc : a042            >            ldy #$42
23be : a203            >            ldx #4-1
23c0 : 73              >            db  $73          ;test nop length
                       >        if 1 = 1
23c1 : ca              >            dex
23c2 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
23c3 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
23c4 : f003            >        beq skip1153
                       >        trap            ;failed not equal (non zero)
23c6 : 20c740          >        jsr report_error
                       >
23c9 :                 >skip1153
                       >
                       >            set_a $ff-$73,0
                       >            load_flag 0
23c9 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
23cb : 48              >            pha         ;use stack to load status
23cc : a98c            >            lda #$ff-$73     ;precharge accu
23ce : 28              >            plp
                       >
23cf : 73              >            db  $73          ;test nop integrity - flags off
23d0 : ea              >            nop
23d1 : ea              >            nop
                       >            tst_a $ff-$73,0
23d2 : 08              >            php         ;save flags
23d3 : c98c            >            cmp #$ff-$73     ;test result
                       >            trap_ne
23d5 : f003            >        beq skip1158
                       >        trap            ;failed not equal (non zero)
23d7 : 20c740          >        jsr report_error
                       >
23da :                 >skip1158
                       >
23da : 68              >            pla         ;load status
23db : 48              >            pha
                       >            cmp_flag 0
23dc : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
23de : f003            >        beq skip1161
                       >        trap            ;failed not equal (non zero)
23e0 : 20c740          >        jsr report_error
                       >
23e3 :                 >skip1161
                       >
23e3 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$73,$ff
                       >            load_flag $ff
23e4 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
23e6 : 48              >            pha         ;use stack to load status
23e7 : a937            >            lda #$aa-$73     ;precharge accu
23e9 : 28              >            plp
                       >
23ea : 73              >            db  $73          ;test nop integrity - flags on
23eb : ea              >            nop
23ec : ea              >            nop
                       >            tst_a $aa-$73,$ff
23ed : 08              >            php         ;save flags
23ee : c937            >            cmp #$aa-$73     ;test result
                       >            trap_ne
23f0 : f003            >        beq skip1166
                       >        trap            ;failed not equal (non zero)
23f2 : 20c740          >        jsr report_error
                       >
23f5 :                 >skip1166
                       >
23f5 : 68              >            pla         ;load status
23f6 : 48              >            pha
                       >            cmp_flag $ff
23f7 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
23f9 : f003            >        beq skip1169
                       >        trap            ;failed not equal (non zero)
23fb : 20c740          >        jsr report_error
                       >
23fe :                 >skip1169
                       >
23fe : 28              >            plp         ;restore status
                       >
23ff : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2401 : f003            >        beq skip1171
                       >        trap            ;failed not equal (non zero)
2403 : 20c740          >        jsr report_error
                       >
2406 :                 >skip1171
                       >
2406 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2408 : f003            >        beq skip1173
                       >        trap            ;failed not equal (non zero)
240a : 20c740          >        jsr report_error
                       >
240d :                 >skip1173
                       >
                        
                                nop_test $83,1
240d : a042            >            ldy #$42
240f : a203            >            ldx #4-1
2411 : 83              >            db  $83          ;test nop length
                       >        if 1 = 1
2412 : ca              >            dex
2413 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2414 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2415 : f003            >        beq skip1176
                       >        trap            ;failed not equal (non zero)
2417 : 20c740          >        jsr report_error
                       >
241a :                 >skip1176
                       >
                       >            set_a $ff-$83,0
                       >            load_flag 0
241a : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
241c : 48              >            pha         ;use stack to load status
241d : a97c            >            lda #$ff-$83     ;precharge accu
241f : 28              >            plp
                       >
2420 : 83              >            db  $83          ;test nop integrity - flags off
2421 : ea              >            nop
2422 : ea              >            nop
                       >            tst_a $ff-$83,0
2423 : 08              >            php         ;save flags
2424 : c97c            >            cmp #$ff-$83     ;test result
                       >            trap_ne
2426 : f003            >        beq skip1181
                       >        trap            ;failed not equal (non zero)
2428 : 20c740          >        jsr report_error
                       >
242b :                 >skip1181
                       >
242b : 68              >            pla         ;load status
242c : 48              >            pha
                       >            cmp_flag 0
242d : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
242f : f003            >        beq skip1184
                       >        trap            ;failed not equal (non zero)
2431 : 20c740          >        jsr report_error
                       >
2434 :                 >skip1184
                       >
2434 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$83,$ff
                       >            load_flag $ff
2435 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2437 : 48              >            pha         ;use stack to load status
2438 : a927            >            lda #$aa-$83     ;precharge accu
243a : 28              >            plp
                       >
243b : 83              >            db  $83          ;test nop integrity - flags on
243c : ea              >            nop
243d : ea              >            nop
                       >            tst_a $aa-$83,$ff
243e : 08              >            php         ;save flags
243f : c927            >            cmp #$aa-$83     ;test result
                       >            trap_ne
2441 : f003            >        beq skip1189
                       >        trap            ;failed not equal (non zero)
2443 : 20c740          >        jsr report_error
                       >
2446 :                 >skip1189
                       >
2446 : 68              >            pla         ;load status
2447 : 48              >            pha
                       >            cmp_flag $ff
2448 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
244a : f003            >        beq skip1192
                       >        trap            ;failed not equal (non zero)
244c : 20c740          >        jsr report_error
                       >
244f :                 >skip1192
                       >
244f : 28              >            plp         ;restore status
                       >
2450 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2452 : f003            >        beq skip1194
                       >        trap            ;failed not equal (non zero)
2454 : 20c740          >        jsr report_error
                       >
2457 :                 >skip1194
                       >
2457 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2459 : f003            >        beq skip1196
                       >        trap            ;failed not equal (non zero)
245b : 20c740          >        jsr report_error
                       >
245e :                 >skip1196
                       >
                        
                                nop_test $93,1
245e : a042            >            ldy #$42
2460 : a203            >            ldx #4-1
2462 : 93              >            db  $93          ;test nop length
                       >        if 1 = 1
2463 : ca              >            dex
2464 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2465 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2466 : f003            >        beq skip1199
                       >        trap            ;failed not equal (non zero)
2468 : 20c740          >        jsr report_error
                       >
246b :                 >skip1199
                       >
                       >            set_a $ff-$93,0
                       >            load_flag 0
246b : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
246d : 48              >            pha         ;use stack to load status
246e : a96c            >            lda #$ff-$93     ;precharge accu
2470 : 28              >            plp
                       >
2471 : 93              >            db  $93          ;test nop integrity - flags off
2472 : ea              >            nop
2473 : ea              >            nop
                       >            tst_a $ff-$93,0
2474 : 08              >            php         ;save flags
2475 : c96c            >            cmp #$ff-$93     ;test result
                       >            trap_ne
2477 : f003            >        beq skip1204
                       >        trap            ;failed not equal (non zero)
2479 : 20c740          >        jsr report_error
                       >
247c :                 >skip1204
                       >
247c : 68              >            pla         ;load status
247d : 48              >            pha
                       >            cmp_flag 0
247e : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2480 : f003            >        beq skip1207
                       >        trap            ;failed not equal (non zero)
2482 : 20c740          >        jsr report_error
                       >
2485 :                 >skip1207
                       >
2485 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$93,$ff
                       >            load_flag $ff
2486 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2488 : 48              >            pha         ;use stack to load status
2489 : a917            >            lda #$aa-$93     ;precharge accu
248b : 28              >            plp
                       >
248c : 93              >            db  $93          ;test nop integrity - flags on
248d : ea              >            nop
248e : ea              >            nop
                       >            tst_a $aa-$93,$ff
248f : 08              >            php         ;save flags
2490 : c917            >            cmp #$aa-$93     ;test result
                       >            trap_ne
2492 : f003            >        beq skip1212
                       >        trap            ;failed not equal (non zero)
2494 : 20c740          >        jsr report_error
                       >
2497 :                 >skip1212
                       >
2497 : 68              >            pla         ;load status
2498 : 48              >            pha
                       >            cmp_flag $ff
2499 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
249b : f003            >        beq skip1215
                       >        trap            ;failed not equal (non zero)
249d : 20c740          >        jsr report_error
                       >
24a0 :                 >skip1215
                       >
24a0 : 28              >            plp         ;restore status
                       >
24a1 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
24a3 : f003            >        beq skip1217
                       >        trap            ;failed not equal (non zero)
24a5 : 20c740          >        jsr report_error
                       >
24a8 :                 >skip1217
                       >
24a8 : e000            >            cpx #0
                       >            trap_ne         ;x changed
24aa : f003            >        beq skip1219
                       >        trap            ;failed not equal (non zero)
24ac : 20c740          >        jsr report_error
                       >
24af :                 >skip1219
                       >
                        
                                nop_test $a3,1
24af : a042            >            ldy #$42
24b1 : a203            >            ldx #4-1
24b3 : a3              >            db  $a3          ;test nop length
                       >        if 1 = 1
24b4 : ca              >            dex
24b5 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
24b6 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
24b7 : f003            >        beq skip1222
                       >        trap            ;failed not equal (non zero)
24b9 : 20c740          >        jsr report_error
                       >
24bc :                 >skip1222
                       >
                       >            set_a $ff-$a3,0
                       >            load_flag 0
24bc : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
24be : 48              >            pha         ;use stack to load status
24bf : a95c            >            lda #$ff-$a3     ;precharge accu
24c1 : 28              >            plp
                       >
24c2 : a3              >            db  $a3          ;test nop integrity - flags off
24c3 : ea              >            nop
24c4 : ea              >            nop
                       >            tst_a $ff-$a3,0
24c5 : 08              >            php         ;save flags
24c6 : c95c            >            cmp #$ff-$a3     ;test result
                       >            trap_ne
24c8 : f003            >        beq skip1227
                       >        trap            ;failed not equal (non zero)
24ca : 20c740          >        jsr report_error
                       >
24cd :                 >skip1227
                       >
24cd : 68              >            pla         ;load status
24ce : 48              >            pha
                       >            cmp_flag 0
24cf : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
24d1 : f003            >        beq skip1230
                       >        trap            ;failed not equal (non zero)
24d3 : 20c740          >        jsr report_error
                       >
24d6 :                 >skip1230
                       >
24d6 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$a3,$ff
                       >            load_flag $ff
24d7 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
24d9 : 48              >            pha         ;use stack to load status
24da : a907            >            lda #$aa-$a3     ;precharge accu
24dc : 28              >            plp
                       >
24dd : a3              >            db  $a3          ;test nop integrity - flags on
24de : ea              >            nop
24df : ea              >            nop
                       >            tst_a $aa-$a3,$ff
24e0 : 08              >            php         ;save flags
24e1 : c907            >            cmp #$aa-$a3     ;test result
                       >            trap_ne
24e3 : f003            >        beq skip1235
                       >        trap            ;failed not equal (non zero)
24e5 : 20c740          >        jsr report_error
                       >
24e8 :                 >skip1235
                       >
24e8 : 68              >            pla         ;load status
24e9 : 48              >            pha
                       >            cmp_flag $ff
24ea : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
24ec : f003            >        beq skip1238
                       >        trap            ;failed not equal (non zero)
24ee : 20c740          >        jsr report_error
                       >
24f1 :                 >skip1238
                       >
24f1 : 28              >            plp         ;restore status
                       >
24f2 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
24f4 : f003            >        beq skip1240
                       >        trap            ;failed not equal (non zero)
24f6 : 20c740          >        jsr report_error
                       >
24f9 :                 >skip1240
                       >
24f9 : e000            >            cpx #0
                       >            trap_ne         ;x changed
24fb : f003            >        beq skip1242
                       >        trap            ;failed not equal (non zero)
24fd : 20c740          >        jsr report_error
                       >
2500 :                 >skip1242
                       >
                        
                                nop_test $b3,1
2500 : a042            >            ldy #$42
2502 : a203            >            ldx #4-1
2504 : b3              >            db  $b3          ;test nop length
                       >        if 1 = 1
2505 : ca              >            dex
2506 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2507 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2508 : f003            >        beq skip1245
                       >        trap            ;failed not equal (non zero)
250a : 20c740          >        jsr report_error
                       >
250d :                 >skip1245
                       >
                       >            set_a $ff-$b3,0
                       >            load_flag 0
250d : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
250f : 48              >            pha         ;use stack to load status
2510 : a94c            >            lda #$ff-$b3     ;precharge accu
2512 : 28              >            plp
                       >
2513 : b3              >            db  $b3          ;test nop integrity - flags off
2514 : ea              >            nop
2515 : ea              >            nop
                       >            tst_a $ff-$b3,0
2516 : 08              >            php         ;save flags
2517 : c94c            >            cmp #$ff-$b3     ;test result
                       >            trap_ne
2519 : f003            >        beq skip1250
                       >        trap            ;failed not equal (non zero)
251b : 20c740          >        jsr report_error
                       >
251e :                 >skip1250
                       >
251e : 68              >            pla         ;load status
251f : 48              >            pha
                       >            cmp_flag 0
2520 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2522 : f003            >        beq skip1253
                       >        trap            ;failed not equal (non zero)
2524 : 20c740          >        jsr report_error
                       >
2527 :                 >skip1253
                       >
2527 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$b3,$ff
                       >            load_flag $ff
2528 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
252a : 48              >            pha         ;use stack to load status
252b : a9f7            >            lda #$aa-$b3     ;precharge accu
252d : 28              >            plp
                       >
252e : b3              >            db  $b3          ;test nop integrity - flags on
252f : ea              >            nop
2530 : ea              >            nop
                       >            tst_a $aa-$b3,$ff
2531 : 08              >            php         ;save flags
2532 : c9f7            >            cmp #$aa-$b3     ;test result
                       >            trap_ne
2534 : f003            >        beq skip1258
                       >        trap            ;failed not equal (non zero)
2536 : 20c740          >        jsr report_error
                       >
2539 :                 >skip1258
                       >
2539 : 68              >            pla         ;load status
253a : 48              >            pha
                       >            cmp_flag $ff
253b : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
253d : f003            >        beq skip1261
                       >        trap            ;failed not equal (non zero)
253f : 20c740          >        jsr report_error
                       >
2542 :                 >skip1261
                       >
2542 : 28              >            plp         ;restore status
                       >
2543 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2545 : f003            >        beq skip1263
                       >        trap            ;failed not equal (non zero)
2547 : 20c740          >        jsr report_error
                       >
254a :                 >skip1263
                       >
254a : e000            >            cpx #0
                       >            trap_ne         ;x changed
254c : f003            >        beq skip1265
                       >        trap            ;failed not equal (non zero)
254e : 20c740          >        jsr report_error
                       >
2551 :                 >skip1265
                       >
                        
                                nop_test $c3,1
2551 : a042            >            ldy #$42
2553 : a203            >            ldx #4-1
2555 : c3              >            db  $c3          ;test nop length
                       >        if 1 = 1
2556 : ca              >            dex
2557 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2558 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2559 : f003            >        beq skip1268
                       >        trap            ;failed not equal (non zero)
255b : 20c740          >        jsr report_error
                       >
255e :                 >skip1268
                       >
                       >            set_a $ff-$c3,0
                       >            load_flag 0
255e : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2560 : 48              >            pha         ;use stack to load status
2561 : a93c            >            lda #$ff-$c3     ;precharge accu
2563 : 28              >            plp
                       >
2564 : c3              >            db  $c3          ;test nop integrity - flags off
2565 : ea              >            nop
2566 : ea              >            nop
                       >            tst_a $ff-$c3,0
2567 : 08              >            php         ;save flags
2568 : c93c            >            cmp #$ff-$c3     ;test result
                       >            trap_ne
256a : f003            >        beq skip1273
                       >        trap            ;failed not equal (non zero)
256c : 20c740          >        jsr report_error
                       >
256f :                 >skip1273
                       >
256f : 68              >            pla         ;load status
2570 : 48              >            pha
                       >            cmp_flag 0
2571 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2573 : f003            >        beq skip1276
                       >        trap            ;failed not equal (non zero)
2575 : 20c740          >        jsr report_error
                       >
2578 :                 >skip1276
                       >
2578 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$c3,$ff
                       >            load_flag $ff
2579 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
257b : 48              >            pha         ;use stack to load status
257c : a9e7            >            lda #$aa-$c3     ;precharge accu
257e : 28              >            plp
                       >
257f : c3              >            db  $c3          ;test nop integrity - flags on
2580 : ea              >            nop
2581 : ea              >            nop
                       >            tst_a $aa-$c3,$ff
2582 : 08              >            php         ;save flags
2583 : c9e7            >            cmp #$aa-$c3     ;test result
                       >            trap_ne
2585 : f003            >        beq skip1281
                       >        trap            ;failed not equal (non zero)
2587 : 20c740          >        jsr report_error
                       >
258a :                 >skip1281
                       >
258a : 68              >            pla         ;load status
258b : 48              >            pha
                       >            cmp_flag $ff
258c : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
258e : f003            >        beq skip1284
                       >        trap            ;failed not equal (non zero)
2590 : 20c740          >        jsr report_error
                       >
2593 :                 >skip1284
                       >
2593 : 28              >            plp         ;restore status
                       >
2594 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2596 : f003            >        beq skip1286
                       >        trap            ;failed not equal (non zero)
2598 : 20c740          >        jsr report_error
                       >
259b :                 >skip1286
                       >
259b : e000            >            cpx #0
                       >            trap_ne         ;x changed
259d : f003            >        beq skip1288
                       >        trap            ;failed not equal (non zero)
259f : 20c740          >        jsr report_error
                       >
25a2 :                 >skip1288
                       >
                        
                                nop_test $d3,1
25a2 : a042            >            ldy #$42
25a4 : a203            >            ldx #4-1
25a6 : d3              >            db  $d3          ;test nop length
                       >        if 1 = 1
25a7 : ca              >            dex
25a8 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
25a9 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
25aa : f003            >        beq skip1291
                       >        trap            ;failed not equal (non zero)
25ac : 20c740          >        jsr report_error
                       >
25af :                 >skip1291
                       >
                       >            set_a $ff-$d3,0
                       >            load_flag 0
25af : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
25b1 : 48              >            pha         ;use stack to load status
25b2 : a92c            >            lda #$ff-$d3     ;precharge accu
25b4 : 28              >            plp
                       >
25b5 : d3              >            db  $d3          ;test nop integrity - flags off
25b6 : ea              >            nop
25b7 : ea              >            nop
                       >            tst_a $ff-$d3,0
25b8 : 08              >            php         ;save flags
25b9 : c92c            >            cmp #$ff-$d3     ;test result
                       >            trap_ne
25bb : f003            >        beq skip1296
                       >        trap            ;failed not equal (non zero)
25bd : 20c740          >        jsr report_error
                       >
25c0 :                 >skip1296
                       >
25c0 : 68              >            pla         ;load status
25c1 : 48              >            pha
                       >            cmp_flag 0
25c2 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
25c4 : f003            >        beq skip1299
                       >        trap            ;failed not equal (non zero)
25c6 : 20c740          >        jsr report_error
                       >
25c9 :                 >skip1299
                       >
25c9 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$d3,$ff
                       >            load_flag $ff
25ca : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
25cc : 48              >            pha         ;use stack to load status
25cd : a9d7            >            lda #$aa-$d3     ;precharge accu
25cf : 28              >            plp
                       >
25d0 : d3              >            db  $d3          ;test nop integrity - flags on
25d1 : ea              >            nop
25d2 : ea              >            nop
                       >            tst_a $aa-$d3,$ff
25d3 : 08              >            php         ;save flags
25d4 : c9d7            >            cmp #$aa-$d3     ;test result
                       >            trap_ne
25d6 : f003            >        beq skip1304
                       >        trap            ;failed not equal (non zero)
25d8 : 20c740          >        jsr report_error
                       >
25db :                 >skip1304
                       >
25db : 68              >            pla         ;load status
25dc : 48              >            pha
                       >            cmp_flag $ff
25dd : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
25df : f003            >        beq skip1307
                       >        trap            ;failed not equal (non zero)
25e1 : 20c740          >        jsr report_error
                       >
25e4 :                 >skip1307
                       >
25e4 : 28              >            plp         ;restore status
                       >
25e5 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
25e7 : f003            >        beq skip1309
                       >        trap            ;failed not equal (non zero)
25e9 : 20c740          >        jsr report_error
                       >
25ec :                 >skip1309
                       >
25ec : e000            >            cpx #0
                       >            trap_ne         ;x changed
25ee : f003            >        beq skip1311
                       >        trap            ;failed not equal (non zero)
25f0 : 20c740          >        jsr report_error
                       >
25f3 :                 >skip1311
                       >
                        
                                nop_test $e3,1
25f3 : a042            >            ldy #$42
25f5 : a203            >            ldx #4-1
25f7 : e3              >            db  $e3          ;test nop length
                       >        if 1 = 1
25f8 : ca              >            dex
25f9 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
25fa : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
25fb : f003            >        beq skip1314
                       >        trap            ;failed not equal (non zero)
25fd : 20c740          >        jsr report_error
                       >
2600 :                 >skip1314
                       >
                       >            set_a $ff-$e3,0
                       >            load_flag 0
2600 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2602 : 48              >            pha         ;use stack to load status
2603 : a91c            >            lda #$ff-$e3     ;precharge accu
2605 : 28              >            plp
                       >
2606 : e3              >            db  $e3          ;test nop integrity - flags off
2607 : ea              >            nop
2608 : ea              >            nop
                       >            tst_a $ff-$e3,0
2609 : 08              >            php         ;save flags
260a : c91c            >            cmp #$ff-$e3     ;test result
                       >            trap_ne
260c : f003            >        beq skip1319
                       >        trap            ;failed not equal (non zero)
260e : 20c740          >        jsr report_error
                       >
2611 :                 >skip1319
                       >
2611 : 68              >            pla         ;load status
2612 : 48              >            pha
                       >            cmp_flag 0
2613 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2615 : f003            >        beq skip1322
                       >        trap            ;failed not equal (non zero)
2617 : 20c740          >        jsr report_error
                       >
261a :                 >skip1322
                       >
261a : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$e3,$ff
                       >            load_flag $ff
261b : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
261d : 48              >            pha         ;use stack to load status
261e : a9c7            >            lda #$aa-$e3     ;precharge accu
2620 : 28              >            plp
                       >
2621 : e3              >            db  $e3          ;test nop integrity - flags on
2622 : ea              >            nop
2623 : ea              >            nop
                       >            tst_a $aa-$e3,$ff
2624 : 08              >            php         ;save flags
2625 : c9c7            >            cmp #$aa-$e3     ;test result
                       >            trap_ne
2627 : f003            >        beq skip1327
                       >        trap            ;failed not equal (non zero)
2629 : 20c740          >        jsr report_error
                       >
262c :                 >skip1327
                       >
262c : 68              >            pla         ;load status
262d : 48              >            pha
                       >            cmp_flag $ff
262e : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2630 : f003            >        beq skip1330
                       >        trap            ;failed not equal (non zero)
2632 : 20c740          >        jsr report_error
                       >
2635 :                 >skip1330
                       >
2635 : 28              >            plp         ;restore status
                       >
2636 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2638 : f003            >        beq skip1332
                       >        trap            ;failed not equal (non zero)
263a : 20c740          >        jsr report_error
                       >
263d :                 >skip1332
                       >
263d : e000            >            cpx #0
                       >            trap_ne         ;x changed
263f : f003            >        beq skip1334
                       >        trap            ;failed not equal (non zero)
2641 : 20c740          >        jsr report_error
                       >
2644 :                 >skip1334
                       >
                        
                                nop_test $f3,1
2644 : a042            >            ldy #$42
2646 : a203            >            ldx #4-1
2648 : f3              >            db  $f3          ;test nop length
                       >        if 1 = 1
2649 : ca              >            dex
264a : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
264b : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
264c : f003            >        beq skip1337
                       >        trap            ;failed not equal (non zero)
264e : 20c740          >        jsr report_error
                       >
2651 :                 >skip1337
                       >
                       >            set_a $ff-$f3,0
                       >            load_flag 0
2651 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2653 : 48              >            pha         ;use stack to load status
2654 : a90c            >            lda #$ff-$f3     ;precharge accu
2656 : 28              >            plp
                       >
2657 : f3              >            db  $f3          ;test nop integrity - flags off
2658 : ea              >            nop
2659 : ea              >            nop
                       >            tst_a $ff-$f3,0
265a : 08              >            php         ;save flags
265b : c90c            >            cmp #$ff-$f3     ;test result
                       >            trap_ne
265d : f003            >        beq skip1342
                       >        trap            ;failed not equal (non zero)
265f : 20c740          >        jsr report_error
                       >
2662 :                 >skip1342
                       >
2662 : 68              >            pla         ;load status
2663 : 48              >            pha
                       >            cmp_flag 0
2664 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2666 : f003            >        beq skip1345
                       >        trap            ;failed not equal (non zero)
2668 : 20c740          >        jsr report_error
                       >
266b :                 >skip1345
                       >
266b : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$f3,$ff
                       >            load_flag $ff
266c : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
266e : 48              >            pha         ;use stack to load status
266f : a9b7            >            lda #$aa-$f3     ;precharge accu
2671 : 28              >            plp
                       >
2672 : f3              >            db  $f3          ;test nop integrity - flags on
2673 : ea              >            nop
2674 : ea              >            nop
                       >            tst_a $aa-$f3,$ff
2675 : 08              >            php         ;save flags
2676 : c9b7            >            cmp #$aa-$f3     ;test result
                       >            trap_ne
2678 : f003            >        beq skip1350
                       >        trap            ;failed not equal (non zero)
267a : 20c740          >        jsr report_error
                       >
267d :                 >skip1350
                       >
267d : 68              >            pla         ;load status
267e : 48              >            pha
                       >            cmp_flag $ff
267f : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2681 : f003            >        beq skip1353
                       >        trap            ;failed not equal (non zero)
2683 : 20c740          >        jsr report_error
                       >
2686 :                 >skip1353
                       >
2686 : 28              >            plp         ;restore status
                       >
2687 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2689 : f003            >        beq skip1355
                       >        trap            ;failed not equal (non zero)
268b : 20c740          >        jsr report_error
                       >
268e :                 >skip1355
                       >
268e : e000            >            cpx #0
                       >            trap_ne         ;x changed
2690 : f003            >        beq skip1357
                       >        trap            ;failed not equal (non zero)
2692 : 20c740          >        jsr report_error
                       >
2695 :                 >skip1357
                       >
                        
                                nop_test $0b,1
2695 : a042            >            ldy #$42
2697 : a203            >            ldx #4-1
2699 : 0b              >            db  $0b          ;test nop length
                       >        if 1 = 1
269a : ca              >            dex
269b : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
269c : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
269d : f003            >        beq skip1360
                       >        trap            ;failed not equal (non zero)
269f : 20c740          >        jsr report_error
                       >
26a2 :                 >skip1360
                       >
                       >            set_a $ff-$0b,0
                       >            load_flag 0
26a2 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
26a4 : 48              >            pha         ;use stack to load status
26a5 : a9f4            >            lda #$ff-$0b     ;precharge accu
26a7 : 28              >            plp
                       >
26a8 : 0b              >            db  $0b          ;test nop integrity - flags off
26a9 : ea              >            nop
26aa : ea              >            nop
                       >            tst_a $ff-$0b,0
26ab : 08              >            php         ;save flags
26ac : c9f4            >            cmp #$ff-$0b     ;test result
                       >            trap_ne
26ae : f003            >        beq skip1365
                       >        trap            ;failed not equal (non zero)
26b0 : 20c740          >        jsr report_error
                       >
26b3 :                 >skip1365
                       >
26b3 : 68              >            pla         ;load status
26b4 : 48              >            pha
                       >            cmp_flag 0
26b5 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
26b7 : f003            >        beq skip1368
                       >        trap            ;failed not equal (non zero)
26b9 : 20c740          >        jsr report_error
                       >
26bc :                 >skip1368
                       >
26bc : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$0b,$ff
                       >            load_flag $ff
26bd : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
26bf : 48              >            pha         ;use stack to load status
26c0 : a99f            >            lda #$aa-$0b     ;precharge accu
26c2 : 28              >            plp
                       >
26c3 : 0b              >            db  $0b          ;test nop integrity - flags on
26c4 : ea              >            nop
26c5 : ea              >            nop
                       >            tst_a $aa-$0b,$ff
26c6 : 08              >            php         ;save flags
26c7 : c99f            >            cmp #$aa-$0b     ;test result
                       >            trap_ne
26c9 : f003            >        beq skip1373
                       >        trap            ;failed not equal (non zero)
26cb : 20c740          >        jsr report_error
                       >
26ce :                 >skip1373
                       >
26ce : 68              >            pla         ;load status
26cf : 48              >            pha
                       >            cmp_flag $ff
26d0 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
26d2 : f003            >        beq skip1376
                       >        trap            ;failed not equal (non zero)
26d4 : 20c740          >        jsr report_error
                       >
26d7 :                 >skip1376
                       >
26d7 : 28              >            plp         ;restore status
                       >
26d8 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
26da : f003            >        beq skip1378
                       >        trap            ;failed not equal (non zero)
26dc : 20c740          >        jsr report_error
                       >
26df :                 >skip1378
                       >
26df : e000            >            cpx #0
                       >            trap_ne         ;x changed
26e1 : f003            >        beq skip1380
                       >        trap            ;failed not equal (non zero)
26e3 : 20c740          >        jsr report_error
                       >
26e6 :                 >skip1380
                       >
                        
                                nop_test $1b,1
26e6 : a042            >            ldy #$42
26e8 : a203            >            ldx #4-1
26ea : 1b              >            db  $1b          ;test nop length
                       >        if 1 = 1
26eb : ca              >            dex
26ec : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
26ed : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
26ee : f003            >        beq skip1383
                       >        trap            ;failed not equal (non zero)
26f0 : 20c740          >        jsr report_error
                       >
26f3 :                 >skip1383
                       >
                       >            set_a $ff-$1b,0
                       >            load_flag 0
26f3 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
26f5 : 48              >            pha         ;use stack to load status
26f6 : a9e4            >            lda #$ff-$1b     ;precharge accu
26f8 : 28              >            plp
                       >
26f9 : 1b              >            db  $1b          ;test nop integrity - flags off
26fa : ea              >            nop
26fb : ea              >            nop
                       >            tst_a $ff-$1b,0
26fc : 08              >            php         ;save flags
26fd : c9e4            >            cmp #$ff-$1b     ;test result
                       >            trap_ne
26ff : f003            >        beq skip1388
                       >        trap            ;failed not equal (non zero)
2701 : 20c740          >        jsr report_error
                       >
2704 :                 >skip1388
                       >
2704 : 68              >            pla         ;load status
2705 : 48              >            pha
                       >            cmp_flag 0
2706 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2708 : f003            >        beq skip1391
                       >        trap            ;failed not equal (non zero)
270a : 20c740          >        jsr report_error
                       >
270d :                 >skip1391
                       >
270d : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$1b,$ff
                       >            load_flag $ff
270e : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2710 : 48              >            pha         ;use stack to load status
2711 : a98f            >            lda #$aa-$1b     ;precharge accu
2713 : 28              >            plp
                       >
2714 : 1b              >            db  $1b          ;test nop integrity - flags on
2715 : ea              >            nop
2716 : ea              >            nop
                       >            tst_a $aa-$1b,$ff
2717 : 08              >            php         ;save flags
2718 : c98f            >            cmp #$aa-$1b     ;test result
                       >            trap_ne
271a : f003            >        beq skip1396
                       >        trap            ;failed not equal (non zero)
271c : 20c740          >        jsr report_error
                       >
271f :                 >skip1396
                       >
271f : 68              >            pla         ;load status
2720 : 48              >            pha
                       >            cmp_flag $ff
2721 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2723 : f003            >        beq skip1399
                       >        trap            ;failed not equal (non zero)
2725 : 20c740          >        jsr report_error
                       >
2728 :                 >skip1399
                       >
2728 : 28              >            plp         ;restore status
                       >
2729 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
272b : f003            >        beq skip1401
                       >        trap            ;failed not equal (non zero)
272d : 20c740          >        jsr report_error
                       >
2730 :                 >skip1401
                       >
2730 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2732 : f003            >        beq skip1403
                       >        trap            ;failed not equal (non zero)
2734 : 20c740          >        jsr report_error
                       >
2737 :                 >skip1403
                       >
                        
                                nop_test $2b,1
2737 : a042            >            ldy #$42
2739 : a203            >            ldx #4-1
273b : 2b              >            db  $2b          ;test nop length
                       >        if 1 = 1
273c : ca              >            dex
273d : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
273e : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
273f : f003            >        beq skip1406
                       >        trap            ;failed not equal (non zero)
2741 : 20c740          >        jsr report_error
                       >
2744 :                 >skip1406
                       >
                       >            set_a $ff-$2b,0
                       >            load_flag 0
2744 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2746 : 48              >            pha         ;use stack to load status
2747 : a9d4            >            lda #$ff-$2b     ;precharge accu
2749 : 28              >            plp
                       >
274a : 2b              >            db  $2b          ;test nop integrity - flags off
274b : ea              >            nop
274c : ea              >            nop
                       >            tst_a $ff-$2b,0
274d : 08              >            php         ;save flags
274e : c9d4            >            cmp #$ff-$2b     ;test result
                       >            trap_ne
2750 : f003            >        beq skip1411
                       >        trap            ;failed not equal (non zero)
2752 : 20c740          >        jsr report_error
                       >
2755 :                 >skip1411
                       >
2755 : 68              >            pla         ;load status
2756 : 48              >            pha
                       >            cmp_flag 0
2757 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2759 : f003            >        beq skip1414
                       >        trap            ;failed not equal (non zero)
275b : 20c740          >        jsr report_error
                       >
275e :                 >skip1414
                       >
275e : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$2b,$ff
                       >            load_flag $ff
275f : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2761 : 48              >            pha         ;use stack to load status
2762 : a97f            >            lda #$aa-$2b     ;precharge accu
2764 : 28              >            plp
                       >
2765 : 2b              >            db  $2b          ;test nop integrity - flags on
2766 : ea              >            nop
2767 : ea              >            nop
                       >            tst_a $aa-$2b,$ff
2768 : 08              >            php         ;save flags
2769 : c97f            >            cmp #$aa-$2b     ;test result
                       >            trap_ne
276b : f003            >        beq skip1419
                       >        trap            ;failed not equal (non zero)
276d : 20c740          >        jsr report_error
                       >
2770 :                 >skip1419
                       >
2770 : 68              >            pla         ;load status
2771 : 48              >            pha
                       >            cmp_flag $ff
2772 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2774 : f003            >        beq skip1422
                       >        trap            ;failed not equal (non zero)
2776 : 20c740          >        jsr report_error
                       >
2779 :                 >skip1422
                       >
2779 : 28              >            plp         ;restore status
                       >
277a : c042            >            cpy #$42
                       >            trap_ne         ;y changed
277c : f003            >        beq skip1424
                       >        trap            ;failed not equal (non zero)
277e : 20c740          >        jsr report_error
                       >
2781 :                 >skip1424
                       >
2781 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2783 : f003            >        beq skip1426
                       >        trap            ;failed not equal (non zero)
2785 : 20c740          >        jsr report_error
                       >
2788 :                 >skip1426
                       >
                        
                                nop_test $3b,1
2788 : a042            >            ldy #$42
278a : a203            >            ldx #4-1
278c : 3b              >            db  $3b          ;test nop length
                       >        if 1 = 1
278d : ca              >            dex
278e : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
278f : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2790 : f003            >        beq skip1429
                       >        trap            ;failed not equal (non zero)
2792 : 20c740          >        jsr report_error
                       >
2795 :                 >skip1429
                       >
                       >            set_a $ff-$3b,0
                       >            load_flag 0
2795 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2797 : 48              >            pha         ;use stack to load status
2798 : a9c4            >            lda #$ff-$3b     ;precharge accu
279a : 28              >            plp
                       >
279b : 3b              >            db  $3b          ;test nop integrity - flags off
279c : ea              >            nop
279d : ea              >            nop
                       >            tst_a $ff-$3b,0
279e : 08              >            php         ;save flags
279f : c9c4            >            cmp #$ff-$3b     ;test result
                       >            trap_ne
27a1 : f003            >        beq skip1434
                       >        trap            ;failed not equal (non zero)
27a3 : 20c740          >        jsr report_error
                       >
27a6 :                 >skip1434
                       >
27a6 : 68              >            pla         ;load status
27a7 : 48              >            pha
                       >            cmp_flag 0
27a8 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
27aa : f003            >        beq skip1437
                       >        trap            ;failed not equal (non zero)
27ac : 20c740          >        jsr report_error
                       >
27af :                 >skip1437
                       >
27af : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$3b,$ff
                       >            load_flag $ff
27b0 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
27b2 : 48              >            pha         ;use stack to load status
27b3 : a96f            >            lda #$aa-$3b     ;precharge accu
27b5 : 28              >            plp
                       >
27b6 : 3b              >            db  $3b          ;test nop integrity - flags on
27b7 : ea              >            nop
27b8 : ea              >            nop
                       >            tst_a $aa-$3b,$ff
27b9 : 08              >            php         ;save flags
27ba : c96f            >            cmp #$aa-$3b     ;test result
                       >            trap_ne
27bc : f003            >        beq skip1442
                       >        trap            ;failed not equal (non zero)
27be : 20c740          >        jsr report_error
                       >
27c1 :                 >skip1442
                       >
27c1 : 68              >            pla         ;load status
27c2 : 48              >            pha
                       >            cmp_flag $ff
27c3 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
27c5 : f003            >        beq skip1445
                       >        trap            ;failed not equal (non zero)
27c7 : 20c740          >        jsr report_error
                       >
27ca :                 >skip1445
                       >
27ca : 28              >            plp         ;restore status
                       >
27cb : c042            >            cpy #$42
                       >            trap_ne         ;y changed
27cd : f003            >        beq skip1447
                       >        trap            ;failed not equal (non zero)
27cf : 20c740          >        jsr report_error
                       >
27d2 :                 >skip1447
                       >
27d2 : e000            >            cpx #0
                       >            trap_ne         ;x changed
27d4 : f003            >        beq skip1449
                       >        trap            ;failed not equal (non zero)
27d6 : 20c740          >        jsr report_error
                       >
27d9 :                 >skip1449
                       >
                        
                                nop_test $4b,1
27d9 : a042            >            ldy #$42
27db : a203            >            ldx #4-1
27dd : 4b              >            db  $4b          ;test nop length
                       >        if 1 = 1
27de : ca              >            dex
27df : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
27e0 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
27e1 : f003            >        beq skip1452
                       >        trap            ;failed not equal (non zero)
27e3 : 20c740          >        jsr report_error
                       >
27e6 :                 >skip1452
                       >
                       >            set_a $ff-$4b,0
                       >            load_flag 0
27e6 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
27e8 : 48              >            pha         ;use stack to load status
27e9 : a9b4            >            lda #$ff-$4b     ;precharge accu
27eb : 28              >            plp
                       >
27ec : 4b              >            db  $4b          ;test nop integrity - flags off
27ed : ea              >            nop
27ee : ea              >            nop
                       >            tst_a $ff-$4b,0
27ef : 08              >            php         ;save flags
27f0 : c9b4            >            cmp #$ff-$4b     ;test result
                       >            trap_ne
27f2 : f003            >        beq skip1457
                       >        trap            ;failed not equal (non zero)
27f4 : 20c740          >        jsr report_error
                       >
27f7 :                 >skip1457
                       >
27f7 : 68              >            pla         ;load status
27f8 : 48              >            pha
                       >            cmp_flag 0
27f9 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
27fb : f003            >        beq skip1460
                       >        trap            ;failed not equal (non zero)
27fd : 20c740          >        jsr report_error
                       >
2800 :                 >skip1460
                       >
2800 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$4b,$ff
                       >            load_flag $ff
2801 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2803 : 48              >            pha         ;use stack to load status
2804 : a95f            >            lda #$aa-$4b     ;precharge accu
2806 : 28              >            plp
                       >
2807 : 4b              >            db  $4b          ;test nop integrity - flags on
2808 : ea              >            nop
2809 : ea              >            nop
                       >            tst_a $aa-$4b,$ff
280a : 08              >            php         ;save flags
280b : c95f            >            cmp #$aa-$4b     ;test result
                       >            trap_ne
280d : f003            >        beq skip1465
                       >        trap            ;failed not equal (non zero)
280f : 20c740          >        jsr report_error
                       >
2812 :                 >skip1465
                       >
2812 : 68              >            pla         ;load status
2813 : 48              >            pha
                       >            cmp_flag $ff
2814 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2816 : f003            >        beq skip1468
                       >        trap            ;failed not equal (non zero)
2818 : 20c740          >        jsr report_error
                       >
281b :                 >skip1468
                       >
281b : 28              >            plp         ;restore status
                       >
281c : c042            >            cpy #$42
                       >            trap_ne         ;y changed
281e : f003            >        beq skip1470
                       >        trap            ;failed not equal (non zero)
2820 : 20c740          >        jsr report_error
                       >
2823 :                 >skip1470
                       >
2823 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2825 : f003            >        beq skip1472
                       >        trap            ;failed not equal (non zero)
2827 : 20c740          >        jsr report_error
                       >
282a :                 >skip1472
                       >
                        
                                nop_test $5b,1
282a : a042            >            ldy #$42
282c : a203            >            ldx #4-1
282e : 5b              >            db  $5b          ;test nop length
                       >        if 1 = 1
282f : ca              >            dex
2830 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2831 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2832 : f003            >        beq skip1475
                       >        trap            ;failed not equal (non zero)
2834 : 20c740          >        jsr report_error
                       >
2837 :                 >skip1475
                       >
                       >            set_a $ff-$5b,0
                       >            load_flag 0
2837 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2839 : 48              >            pha         ;use stack to load status
283a : a9a4            >            lda #$ff-$5b     ;precharge accu
283c : 28              >            plp
                       >
283d : 5b              >            db  $5b          ;test nop integrity - flags off
283e : ea              >            nop
283f : ea              >            nop
                       >            tst_a $ff-$5b,0
2840 : 08              >            php         ;save flags
2841 : c9a4            >            cmp #$ff-$5b     ;test result
                       >            trap_ne
2843 : f003            >        beq skip1480
                       >        trap            ;failed not equal (non zero)
2845 : 20c740          >        jsr report_error
                       >
2848 :                 >skip1480
                       >
2848 : 68              >            pla         ;load status
2849 : 48              >            pha
                       >            cmp_flag 0
284a : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
284c : f003            >        beq skip1483
                       >        trap            ;failed not equal (non zero)
284e : 20c740          >        jsr report_error
                       >
2851 :                 >skip1483
                       >
2851 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$5b,$ff
                       >            load_flag $ff
2852 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2854 : 48              >            pha         ;use stack to load status
2855 : a94f            >            lda #$aa-$5b     ;precharge accu
2857 : 28              >            plp
                       >
2858 : 5b              >            db  $5b          ;test nop integrity - flags on
2859 : ea              >            nop
285a : ea              >            nop
                       >            tst_a $aa-$5b,$ff
285b : 08              >            php         ;save flags
285c : c94f            >            cmp #$aa-$5b     ;test result
                       >            trap_ne
285e : f003            >        beq skip1488
                       >        trap            ;failed not equal (non zero)
2860 : 20c740          >        jsr report_error
                       >
2863 :                 >skip1488
                       >
2863 : 68              >            pla         ;load status
2864 : 48              >            pha
                       >            cmp_flag $ff
2865 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2867 : f003            >        beq skip1491
                       >        trap            ;failed not equal (non zero)
2869 : 20c740          >        jsr report_error
                       >
286c :                 >skip1491
                       >
286c : 28              >            plp         ;restore status
                       >
286d : c042            >            cpy #$42
                       >            trap_ne         ;y changed
286f : f003            >        beq skip1493
                       >        trap            ;failed not equal (non zero)
2871 : 20c740          >        jsr report_error
                       >
2874 :                 >skip1493
                       >
2874 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2876 : f003            >        beq skip1495
                       >        trap            ;failed not equal (non zero)
2878 : 20c740          >        jsr report_error
                       >
287b :                 >skip1495
                       >
                        
                                nop_test $6b,1
287b : a042            >            ldy #$42
287d : a203            >            ldx #4-1
287f : 6b              >            db  $6b          ;test nop length
                       >        if 1 = 1
2880 : ca              >            dex
2881 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2882 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2883 : f003            >        beq skip1498
                       >        trap            ;failed not equal (non zero)
2885 : 20c740          >        jsr report_error
                       >
2888 :                 >skip1498
                       >
                       >            set_a $ff-$6b,0
                       >            load_flag 0
2888 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
288a : 48              >            pha         ;use stack to load status
288b : a994            >            lda #$ff-$6b     ;precharge accu
288d : 28              >            plp
                       >
288e : 6b              >            db  $6b          ;test nop integrity - flags off
288f : ea              >            nop
2890 : ea              >            nop
                       >            tst_a $ff-$6b,0
2891 : 08              >            php         ;save flags
2892 : c994            >            cmp #$ff-$6b     ;test result
                       >            trap_ne
2894 : f003            >        beq skip1503
                       >        trap            ;failed not equal (non zero)
2896 : 20c740          >        jsr report_error
                       >
2899 :                 >skip1503
                       >
2899 : 68              >            pla         ;load status
289a : 48              >            pha
                       >            cmp_flag 0
289b : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
289d : f003            >        beq skip1506
                       >        trap            ;failed not equal (non zero)
289f : 20c740          >        jsr report_error
                       >
28a2 :                 >skip1506
                       >
28a2 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$6b,$ff
                       >            load_flag $ff
28a3 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
28a5 : 48              >            pha         ;use stack to load status
28a6 : a93f            >            lda #$aa-$6b     ;precharge accu
28a8 : 28              >            plp
                       >
28a9 : 6b              >            db  $6b          ;test nop integrity - flags on
28aa : ea              >            nop
28ab : ea              >            nop
                       >            tst_a $aa-$6b,$ff
28ac : 08              >            php         ;save flags
28ad : c93f            >            cmp #$aa-$6b     ;test result
                       >            trap_ne
28af : f003            >        beq skip1511
                       >        trap            ;failed not equal (non zero)
28b1 : 20c740          >        jsr report_error
                       >
28b4 :                 >skip1511
                       >
28b4 : 68              >            pla         ;load status
28b5 : 48              >            pha
                       >            cmp_flag $ff
28b6 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
28b8 : f003            >        beq skip1514
                       >        trap            ;failed not equal (non zero)
28ba : 20c740          >        jsr report_error
                       >
28bd :                 >skip1514
                       >
28bd : 28              >            plp         ;restore status
                       >
28be : c042            >            cpy #$42
                       >            trap_ne         ;y changed
28c0 : f003            >        beq skip1516
                       >        trap            ;failed not equal (non zero)
28c2 : 20c740          >        jsr report_error
                       >
28c5 :                 >skip1516
                       >
28c5 : e000            >            cpx #0
                       >            trap_ne         ;x changed
28c7 : f003            >        beq skip1518
                       >        trap            ;failed not equal (non zero)
28c9 : 20c740          >        jsr report_error
                       >
28cc :                 >skip1518
                       >
                        
                                nop_test $7b,1
28cc : a042            >            ldy #$42
28ce : a203            >            ldx #4-1
28d0 : 7b              >            db  $7b          ;test nop length
                       >        if 1 = 1
28d1 : ca              >            dex
28d2 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
28d3 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
28d4 : f003            >        beq skip1521
                       >        trap            ;failed not equal (non zero)
28d6 : 20c740          >        jsr report_error
                       >
28d9 :                 >skip1521
                       >
                       >            set_a $ff-$7b,0
                       >            load_flag 0
28d9 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
28db : 48              >            pha         ;use stack to load status
28dc : a984            >            lda #$ff-$7b     ;precharge accu
28de : 28              >            plp
                       >
28df : 7b              >            db  $7b          ;test nop integrity - flags off
28e0 : ea              >            nop
28e1 : ea              >            nop
                       >            tst_a $ff-$7b,0
28e2 : 08              >            php         ;save flags
28e3 : c984            >            cmp #$ff-$7b     ;test result
                       >            trap_ne
28e5 : f003            >        beq skip1526
                       >        trap            ;failed not equal (non zero)
28e7 : 20c740          >        jsr report_error
                       >
28ea :                 >skip1526
                       >
28ea : 68              >            pla         ;load status
28eb : 48              >            pha
                       >            cmp_flag 0
28ec : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
28ee : f003            >        beq skip1529
                       >        trap            ;failed not equal (non zero)
28f0 : 20c740          >        jsr report_error
                       >
28f3 :                 >skip1529
                       >
28f3 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$7b,$ff
                       >            load_flag $ff
28f4 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
28f6 : 48              >            pha         ;use stack to load status
28f7 : a92f            >            lda #$aa-$7b     ;precharge accu
28f9 : 28              >            plp
                       >
28fa : 7b              >            db  $7b          ;test nop integrity - flags on
28fb : ea              >            nop
28fc : ea              >            nop
                       >            tst_a $aa-$7b,$ff
28fd : 08              >            php         ;save flags
28fe : c92f            >            cmp #$aa-$7b     ;test result
                       >            trap_ne
2900 : f003            >        beq skip1534
                       >        trap            ;failed not equal (non zero)
2902 : 20c740          >        jsr report_error
                       >
2905 :                 >skip1534
                       >
2905 : 68              >            pla         ;load status
2906 : 48              >            pha
                       >            cmp_flag $ff
2907 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2909 : f003            >        beq skip1537
                       >        trap            ;failed not equal (non zero)
290b : 20c740          >        jsr report_error
                       >
290e :                 >skip1537
                       >
290e : 28              >            plp         ;restore status
                       >
290f : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2911 : f003            >        beq skip1539
                       >        trap            ;failed not equal (non zero)
2913 : 20c740          >        jsr report_error
                       >
2916 :                 >skip1539
                       >
2916 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2918 : f003            >        beq skip1541
                       >        trap            ;failed not equal (non zero)
291a : 20c740          >        jsr report_error
                       >
291d :                 >skip1541
                       >
                        
                                nop_test $8b,1
291d : a042            >            ldy #$42
291f : a203            >            ldx #4-1
2921 : 8b              >            db  $8b          ;test nop length
                       >        if 1 = 1
2922 : ca              >            dex
2923 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2924 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2925 : f003            >        beq skip1544
                       >        trap            ;failed not equal (non zero)
2927 : 20c740          >        jsr report_error
                       >
292a :                 >skip1544
                       >
                       >            set_a $ff-$8b,0
                       >            load_flag 0
292a : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
292c : 48              >            pha         ;use stack to load status
292d : a974            >            lda #$ff-$8b     ;precharge accu
292f : 28              >            plp
                       >
2930 : 8b              >            db  $8b          ;test nop integrity - flags off
2931 : ea              >            nop
2932 : ea              >            nop
                       >            tst_a $ff-$8b,0
2933 : 08              >            php         ;save flags
2934 : c974            >            cmp #$ff-$8b     ;test result
                       >            trap_ne
2936 : f003            >        beq skip1549
                       >        trap            ;failed not equal (non zero)
2938 : 20c740          >        jsr report_error
                       >
293b :                 >skip1549
                       >
293b : 68              >            pla         ;load status
293c : 48              >            pha
                       >            cmp_flag 0
293d : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
293f : f003            >        beq skip1552
                       >        trap            ;failed not equal (non zero)
2941 : 20c740          >        jsr report_error
                       >
2944 :                 >skip1552
                       >
2944 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$8b,$ff
                       >            load_flag $ff
2945 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2947 : 48              >            pha         ;use stack to load status
2948 : a91f            >            lda #$aa-$8b     ;precharge accu
294a : 28              >            plp
                       >
294b : 8b              >            db  $8b          ;test nop integrity - flags on
294c : ea              >            nop
294d : ea              >            nop
                       >            tst_a $aa-$8b,$ff
294e : 08              >            php         ;save flags
294f : c91f            >            cmp #$aa-$8b     ;test result
                       >            trap_ne
2951 : f003            >        beq skip1557
                       >        trap            ;failed not equal (non zero)
2953 : 20c740          >        jsr report_error
                       >
2956 :                 >skip1557
                       >
2956 : 68              >            pla         ;load status
2957 : 48              >            pha
                       >            cmp_flag $ff
2958 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
295a : f003            >        beq skip1560
                       >        trap            ;failed not equal (non zero)
295c : 20c740          >        jsr report_error
                       >
295f :                 >skip1560
                       >
295f : 28              >            plp         ;restore status
                       >
2960 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2962 : f003            >        beq skip1562
                       >        trap            ;failed not equal (non zero)
2964 : 20c740          >        jsr report_error
                       >
2967 :                 >skip1562
                       >
2967 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2969 : f003            >        beq skip1564
                       >        trap            ;failed not equal (non zero)
296b : 20c740          >        jsr report_error
                       >
296e :                 >skip1564
                       >
                        
                                nop_test $9b,1
296e : a042            >            ldy #$42
2970 : a203            >            ldx #4-1
2972 : 9b              >            db  $9b          ;test nop length
                       >        if 1 = 1
2973 : ca              >            dex
2974 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2975 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2976 : f003            >        beq skip1567
                       >        trap            ;failed not equal (non zero)
2978 : 20c740          >        jsr report_error
                       >
297b :                 >skip1567
                       >
                       >            set_a $ff-$9b,0
                       >            load_flag 0
297b : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
297d : 48              >            pha         ;use stack to load status
297e : a964            >            lda #$ff-$9b     ;precharge accu
2980 : 28              >            plp
                       >
2981 : 9b              >            db  $9b          ;test nop integrity - flags off
2982 : ea              >            nop
2983 : ea              >            nop
                       >            tst_a $ff-$9b,0
2984 : 08              >            php         ;save flags
2985 : c964            >            cmp #$ff-$9b     ;test result
                       >            trap_ne
2987 : f003            >        beq skip1572
                       >        trap            ;failed not equal (non zero)
2989 : 20c740          >        jsr report_error
                       >
298c :                 >skip1572
                       >
298c : 68              >            pla         ;load status
298d : 48              >            pha
                       >            cmp_flag 0
298e : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2990 : f003            >        beq skip1575
                       >        trap            ;failed not equal (non zero)
2992 : 20c740          >        jsr report_error
                       >
2995 :                 >skip1575
                       >
2995 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$9b,$ff
                       >            load_flag $ff
2996 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2998 : 48              >            pha         ;use stack to load status
2999 : a90f            >            lda #$aa-$9b     ;precharge accu
299b : 28              >            plp
                       >
299c : 9b              >            db  $9b          ;test nop integrity - flags on
299d : ea              >            nop
299e : ea              >            nop
                       >            tst_a $aa-$9b,$ff
299f : 08              >            php         ;save flags
29a0 : c90f            >            cmp #$aa-$9b     ;test result
                       >            trap_ne
29a2 : f003            >        beq skip1580
                       >        trap            ;failed not equal (non zero)
29a4 : 20c740          >        jsr report_error
                       >
29a7 :                 >skip1580
                       >
29a7 : 68              >            pla         ;load status
29a8 : 48              >            pha
                       >            cmp_flag $ff
29a9 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
29ab : f003            >        beq skip1583
                       >        trap            ;failed not equal (non zero)
29ad : 20c740          >        jsr report_error
                       >
29b0 :                 >skip1583
                       >
29b0 : 28              >            plp         ;restore status
                       >
29b1 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
29b3 : f003            >        beq skip1585
                       >        trap            ;failed not equal (non zero)
29b5 : 20c740          >        jsr report_error
                       >
29b8 :                 >skip1585
                       >
29b8 : e000            >            cpx #0
                       >            trap_ne         ;x changed
29ba : f003            >        beq skip1587
                       >        trap            ;failed not equal (non zero)
29bc : 20c740          >        jsr report_error
                       >
29bf :                 >skip1587
                       >
                        
                                nop_test $ab,1
29bf : a042            >            ldy #$42
29c1 : a203            >            ldx #4-1
29c3 : ab              >            db  $ab          ;test nop length
                       >        if 1 = 1
29c4 : ca              >            dex
29c5 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
29c6 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
29c7 : f003            >        beq skip1590
                       >        trap            ;failed not equal (non zero)
29c9 : 20c740          >        jsr report_error
                       >
29cc :                 >skip1590
                       >
                       >            set_a $ff-$ab,0
                       >            load_flag 0
29cc : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
29ce : 48              >            pha         ;use stack to load status
29cf : a954            >            lda #$ff-$ab     ;precharge accu
29d1 : 28              >            plp
                       >
29d2 : ab              >            db  $ab          ;test nop integrity - flags off
29d3 : ea              >            nop
29d4 : ea              >            nop
                       >            tst_a $ff-$ab,0
29d5 : 08              >            php         ;save flags
29d6 : c954            >            cmp #$ff-$ab     ;test result
                       >            trap_ne
29d8 : f003            >        beq skip1595
                       >        trap            ;failed not equal (non zero)
29da : 20c740          >        jsr report_error
                       >
29dd :                 >skip1595
                       >
29dd : 68              >            pla         ;load status
29de : 48              >            pha
                       >            cmp_flag 0
29df : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
29e1 : f003            >        beq skip1598
                       >        trap            ;failed not equal (non zero)
29e3 : 20c740          >        jsr report_error
                       >
29e6 :                 >skip1598
                       >
29e6 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$ab,$ff
                       >            load_flag $ff
29e7 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
29e9 : 48              >            pha         ;use stack to load status
29ea : a9ff            >            lda #$aa-$ab     ;precharge accu
29ec : 28              >            plp
                       >
29ed : ab              >            db  $ab          ;test nop integrity - flags on
29ee : ea              >            nop
29ef : ea              >            nop
                       >            tst_a $aa-$ab,$ff
29f0 : 08              >            php         ;save flags
29f1 : c9ff            >            cmp #$aa-$ab     ;test result
                       >            trap_ne
29f3 : f003            >        beq skip1603
                       >        trap            ;failed not equal (non zero)
29f5 : 20c740          >        jsr report_error
                       >
29f8 :                 >skip1603
                       >
29f8 : 68              >            pla         ;load status
29f9 : 48              >            pha
                       >            cmp_flag $ff
29fa : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
29fc : f003            >        beq skip1606
                       >        trap            ;failed not equal (non zero)
29fe : 20c740          >        jsr report_error
                       >
2a01 :                 >skip1606
                       >
2a01 : 28              >            plp         ;restore status
                       >
2a02 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2a04 : f003            >        beq skip1608
                       >        trap            ;failed not equal (non zero)
2a06 : 20c740          >        jsr report_error
                       >
2a09 :                 >skip1608
                       >
2a09 : e000            >            cpx #0
                       >            trap_ne         ;x changed
2a0b : f003            >        beq skip1610
                       >        trap            ;failed not equal (non zero)
2a0d : 20c740          >        jsr report_error
                       >
2a10 :                 >skip1610
                       >
                        
                                nop_test $bb,1
2a10 : a042            >            ldy #$42
2a12 : a203            >            ldx #4-1
2a14 : bb              >            db  $bb          ;test nop length
                       >        if 1 = 1
2a15 : ca              >            dex
2a16 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2a17 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2a18 : f003            >        beq skip1613
                       >        trap            ;failed not equal (non zero)
2a1a : 20c740          >        jsr report_error
                       >
2a1d :                 >skip1613
                       >
                       >            set_a $ff-$bb,0
                       >            load_flag 0
2a1d : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2a1f : 48              >            pha         ;use stack to load status
2a20 : a944            >            lda #$ff-$bb     ;precharge accu
2a22 : 28              >            plp
                       >
2a23 : bb              >            db  $bb          ;test nop integrity - flags off
2a24 : ea              >            nop
2a25 : ea              >            nop
                       >            tst_a $ff-$bb,0
2a26 : 08              >            php         ;save flags
2a27 : c944            >            cmp #$ff-$bb     ;test result
                       >            trap_ne
2a29 : f003            >        beq skip1618
                       >        trap            ;failed not equal (non zero)
2a2b : 20c740          >        jsr report_error
                       >
2a2e :                 >skip1618
                       >
2a2e : 68              >            pla         ;load status
2a2f : 48              >            pha
                       >            cmp_flag 0
2a30 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2a32 : f003            >        beq skip1621
                       >        trap            ;failed not equal (non zero)
2a34 : 20c740          >        jsr report_error
                       >
2a37 :                 >skip1621
                       >
2a37 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$bb,$ff
                       >            load_flag $ff
2a38 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2a3a : 48              >            pha         ;use stack to load status
2a3b : a9ef            >            lda #$aa-$bb     ;precharge accu
2a3d : 28              >            plp
                       >
2a3e : bb              >            db  $bb          ;test nop integrity - flags on
2a3f : ea              >            nop
2a40 : ea              >            nop
                       >            tst_a $aa-$bb,$ff
2a41 : 08              >            php         ;save flags
2a42 : c9ef            >            cmp #$aa-$bb     ;test result
                       >            trap_ne
2a44 : f003            >        beq skip1626
                       >        trap            ;failed not equal (non zero)
2a46 : 20c740          >        jsr report_error
                       >
2a49 :                 >skip1626
                       >
2a49 : 68              >            pla         ;load status
2a4a : 48              >            pha
                       >            cmp_flag $ff
2a4b : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2a4d : f003            >        beq skip1629
                       >        trap            ;failed not equal (non zero)
2a4f : 20c740          >        jsr report_error
                       >
2a52 :                 >skip1629
                       >
2a52 : 28              >            plp         ;restore status
                       >
2a53 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2a55 : f003            >        beq skip1631
                       >        trap            ;failed not equal (non zero)
2a57 : 20c740          >        jsr report_error
                       >
2a5a :                 >skip1631
                       >
2a5a : e000            >            cpx #0
                       >            trap_ne         ;x changed
2a5c : f003            >        beq skip1633
                       >        trap            ;failed not equal (non zero)
2a5e : 20c740          >        jsr report_error
                       >
2a61 :                 >skip1633
                       >
                        
                                nop_test $eb,1
2a61 : a042            >            ldy #$42
2a63 : a203            >            ldx #4-1
2a65 : eb              >            db  $eb          ;test nop length
                       >        if 1 = 1
2a66 : ca              >            dex
2a67 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2a68 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2a69 : f003            >        beq skip1636
                       >        trap            ;failed not equal (non zero)
2a6b : 20c740          >        jsr report_error
                       >
2a6e :                 >skip1636
                       >
                       >            set_a $ff-$eb,0
                       >            load_flag 0
2a6e : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2a70 : 48              >            pha         ;use stack to load status
2a71 : a914            >            lda #$ff-$eb     ;precharge accu
2a73 : 28              >            plp
                       >
2a74 : eb              >            db  $eb          ;test nop integrity - flags off
2a75 : ea              >            nop
2a76 : ea              >            nop
                       >            tst_a $ff-$eb,0
2a77 : 08              >            php         ;save flags
2a78 : c914            >            cmp #$ff-$eb     ;test result
                       >            trap_ne
2a7a : f003            >        beq skip1641
                       >        trap            ;failed not equal (non zero)
2a7c : 20c740          >        jsr report_error
                       >
2a7f :                 >skip1641
                       >
2a7f : 68              >            pla         ;load status
2a80 : 48              >            pha
                       >            cmp_flag 0
2a81 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2a83 : f003            >        beq skip1644
                       >        trap            ;failed not equal (non zero)
2a85 : 20c740          >        jsr report_error
                       >
2a88 :                 >skip1644
                       >
2a88 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$eb,$ff
                       >            load_flag $ff
2a89 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2a8b : 48              >            pha         ;use stack to load status
2a8c : a9bf            >            lda #$aa-$eb     ;precharge accu
2a8e : 28              >            plp
                       >
2a8f : eb              >            db  $eb          ;test nop integrity - flags on
2a90 : ea              >            nop
2a91 : ea              >            nop
                       >            tst_a $aa-$eb,$ff
2a92 : 08              >            php         ;save flags
2a93 : c9bf            >            cmp #$aa-$eb     ;test result
                       >            trap_ne
2a95 : f003            >        beq skip1649
                       >        trap            ;failed not equal (non zero)
2a97 : 20c740          >        jsr report_error
                       >
2a9a :                 >skip1649
                       >
2a9a : 68              >            pla         ;load status
2a9b : 48              >            pha
                       >            cmp_flag $ff
2a9c : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2a9e : f003            >        beq skip1652
                       >        trap            ;failed not equal (non zero)
2aa0 : 20c740          >        jsr report_error
                       >
2aa3 :                 >skip1652
                       >
2aa3 : 28              >            plp         ;restore status
                       >
2aa4 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2aa6 : f003            >        beq skip1654
                       >        trap            ;failed not equal (non zero)
2aa8 : 20c740          >        jsr report_error
                       >
2aab :                 >skip1654
                       >
2aab : e000            >            cpx #0
                       >            trap_ne         ;x changed
2aad : f003            >        beq skip1656
                       >        trap            ;failed not equal (non zero)
2aaf : 20c740          >        jsr report_error
                       >
2ab2 :                 >skip1656
                       >
                        
                                nop_test $fb,1
2ab2 : a042            >            ldy #$42
2ab4 : a203            >            ldx #4-1
2ab6 : fb              >            db  $fb          ;test nop length
                       >        if 1 = 1
2ab7 : ca              >            dex
2ab8 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2ab9 : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2aba : f003            >        beq skip1659
                       >        trap            ;failed not equal (non zero)
2abc : 20c740          >        jsr report_error
                       >
2abf :                 >skip1659
                       >
                       >            set_a $ff-$fb,0
                       >            load_flag 0
2abf : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2ac1 : 48              >            pha         ;use stack to load status
2ac2 : a904            >            lda #$ff-$fb     ;precharge accu
2ac4 : 28              >            plp
                       >
2ac5 : fb              >            db  $fb          ;test nop integrity - flags off
2ac6 : ea              >            nop
2ac7 : ea              >            nop
                       >            tst_a $ff-$fb,0
2ac8 : 08              >            php         ;save flags
2ac9 : c904            >            cmp #$ff-$fb     ;test result
                       >            trap_ne
2acb : f003            >        beq skip1664
                       >        trap            ;failed not equal (non zero)
2acd : 20c740          >        jsr report_error
                       >
2ad0 :                 >skip1664
                       >
2ad0 : 68              >            pla         ;load status
2ad1 : 48              >            pha
                       >            cmp_flag 0
2ad2 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2ad4 : f003            >        beq skip1667
                       >        trap            ;failed not equal (non zero)
2ad6 : 20c740          >        jsr report_error
                       >
2ad9 :                 >skip1667
                       >
2ad9 : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$fb,$ff
                       >            load_flag $ff
2ada : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2adc : 48              >            pha         ;use stack to load status
2add : a9af            >            lda #$aa-$fb     ;precharge accu
2adf : 28              >            plp
                       >
2ae0 : fb              >            db  $fb          ;test nop integrity - flags on
2ae1 : ea              >            nop
2ae2 : ea              >            nop
                       >            tst_a $aa-$fb,$ff
2ae3 : 08              >            php         ;save flags
2ae4 : c9af            >            cmp #$aa-$fb     ;test result
                       >            trap_ne
2ae6 : f003            >        beq skip1672
                       >        trap            ;failed not equal (non zero)
2ae8 : 20c740          >        jsr report_error
                       >
2aeb :                 >skip1672
                       >
2aeb : 68              >            pla         ;load status
2aec : 48              >            pha
                       >            cmp_flag $ff
2aed : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2aef : f003            >        beq skip1675
                       >        trap            ;failed not equal (non zero)
2af1 : 20c740          >        jsr report_error
                       >
2af4 :                 >skip1675
                       >
2af4 : 28              >            plp         ;restore status
                       >
2af5 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2af7 : f003            >        beq skip1677
                       >        trap            ;failed not equal (non zero)
2af9 : 20c740          >        jsr report_error
                       >
2afc :                 >skip1677
                       >
2afc : e000            >            cpx #0
                       >            trap_ne         ;x changed
2afe : f003            >        beq skip1679
                       >        trap            ;failed not equal (non zero)
2b00 : 20c740          >        jsr report_error
                       >
2b03 :                 >skip1679
                       >
                        
                            if rkwl_wdc_op = 0      ;NOPs not available on Rockwell & WDC 65C02
                                nop_test $07,1
                                nop_test $17,1
                                nop_test $27,1
                                nop_test $37,1
                                nop_test $47,1
                                nop_test $57,1
                                nop_test $67,1
                                nop_test $77,1
                                nop_test $87,1
                                nop_test $97,1
                                nop_test $a7,1
                                nop_test $b7,1
                                nop_test $c7,1
                                nop_test $d7,1
                                nop_test $e7,1
                                nop_test $f7,1
                                nop_test $0f,1
                                nop_test $1f,1
                                nop_test $2f,1
                                nop_test $3f,1
                                nop_test $4f,1
                                nop_test $5f,1
                                nop_test $6f,1
                                nop_test $7f,1
                                nop_test $8f,1
                                nop_test $9f,1
                                nop_test $af,1
                                nop_test $bf,1
                                nop_test $cf,1
                                nop_test $df,1
                                nop_test $ef,1
                                nop_test $ff,1
                            endif
                            if  wdc_op = 0          ;NOPs not available on WDC 65C02 (WAI, STP)
                                nop_test $cb,1
2b03 : a042            >            ldy #$42
2b05 : a203            >            ldx #4-1
2b07 : cb              >            db  $cb          ;test nop length
                       >        if 1 = 1
2b08 : ca              >            dex
2b09 : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2b0a : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2b0b : f003            >        beq skip1682
                       >        trap            ;failed not equal (non zero)
2b0d : 20c740          >        jsr report_error
                       >
2b10 :                 >skip1682
                       >
                       >            set_a $ff-$cb,0
                       >            load_flag 0
2b10 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2b12 : 48              >            pha         ;use stack to load status
2b13 : a934            >            lda #$ff-$cb     ;precharge accu
2b15 : 28              >            plp
                       >
2b16 : cb              >            db  $cb          ;test nop integrity - flags off
2b17 : ea              >            nop
2b18 : ea              >            nop
                       >            tst_a $ff-$cb,0
2b19 : 08              >            php         ;save flags
2b1a : c934            >            cmp #$ff-$cb     ;test result
                       >            trap_ne
2b1c : f003            >        beq skip1687
                       >        trap            ;failed not equal (non zero)
2b1e : 20c740          >        jsr report_error
                       >
2b21 :                 >skip1687
                       >
2b21 : 68              >            pla         ;load status
2b22 : 48              >            pha
                       >            cmp_flag 0
2b23 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2b25 : f003            >        beq skip1690
                       >        trap            ;failed not equal (non zero)
2b27 : 20c740          >        jsr report_error
                       >
2b2a :                 >skip1690
                       >
2b2a : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$cb,$ff
                       >            load_flag $ff
2b2b : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2b2d : 48              >            pha         ;use stack to load status
2b2e : a9df            >            lda #$aa-$cb     ;precharge accu
2b30 : 28              >            plp
                       >
2b31 : cb              >            db  $cb          ;test nop integrity - flags on
2b32 : ea              >            nop
2b33 : ea              >            nop
                       >            tst_a $aa-$cb,$ff
2b34 : 08              >            php         ;save flags
2b35 : c9df            >            cmp #$aa-$cb     ;test result
                       >            trap_ne
2b37 : f003            >        beq skip1695
                       >        trap            ;failed not equal (non zero)
2b39 : 20c740          >        jsr report_error
                       >
2b3c :                 >skip1695
                       >
2b3c : 68              >            pla         ;load status
2b3d : 48              >            pha
                       >            cmp_flag $ff
2b3e : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2b40 : f003            >        beq skip1698
                       >        trap            ;failed not equal (non zero)
2b42 : 20c740          >        jsr report_error
                       >
2b45 :                 >skip1698
                       >
2b45 : 28              >            plp         ;restore status
                       >
2b46 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2b48 : f003            >        beq skip1700
                       >        trap            ;failed not equal (non zero)
2b4a : 20c740          >        jsr report_error
                       >
2b4d :                 >skip1700
                       >
2b4d : e000            >            cpx #0
                       >            trap_ne         ;x changed
2b4f : f003            >        beq skip1702
                       >        trap            ;failed not equal (non zero)
2b51 : 20c740          >        jsr report_error
                       >
2b54 :                 >skip1702
                       >
                        
                                nop_test $db,1
2b54 : a042            >            ldy #$42
2b56 : a203            >            ldx #4-1
2b58 : db              >            db  $db          ;test nop length
                       >        if 1 = 1
2b59 : ca              >            dex
2b5a : ca              >            dex
                       >        endif
                       >        if 1 = 2
                       >            iny
                       >            dex
                       >        endif
                       >        if 1 = 3
                       >            iny
                       >            iny
                       >        endif
2b5b : ca              >            dex
                       >            trap_ne         ;wrong number of bytes
2b5c : f003            >        beq skip1705
                       >        trap            ;failed not equal (non zero)
2b5e : 20c740          >        jsr report_error
                       >
2b61 :                 >skip1705
                       >
                       >            set_a $ff-$db,0
                       >            load_flag 0
2b61 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2b63 : 48              >            pha         ;use stack to load status
2b64 : a924            >            lda #$ff-$db     ;precharge accu
2b66 : 28              >            plp
                       >
2b67 : db              >            db  $db          ;test nop integrity - flags off
2b68 : ea              >            nop
2b69 : ea              >            nop
                       >            tst_a $ff-$db,0
2b6a : 08              >            php         ;save flags
2b6b : c924            >            cmp #$ff-$db     ;test result
                       >            trap_ne
2b6d : f003            >        beq skip1710
                       >        trap            ;failed not equal (non zero)
2b6f : 20c740          >        jsr report_error
                       >
2b72 :                 >skip1710
                       >
2b72 : 68              >            pla         ;load status
2b73 : 48              >            pha
                       >            cmp_flag 0
2b74 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2b76 : f003            >        beq skip1713
                       >        trap            ;failed not equal (non zero)
2b78 : 20c740          >        jsr report_error
                       >
2b7b :                 >skip1713
                       >
2b7b : 28              >            plp         ;restore status
                       >
                       >            set_a $aa-$db,$ff
                       >            load_flag $ff
2b7c : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2b7e : 48              >            pha         ;use stack to load status
2b7f : a9cf            >            lda #$aa-$db     ;precharge accu
2b81 : 28              >            plp
                       >
2b82 : db              >            db  $db          ;test nop integrity - flags on
2b83 : ea              >            nop
2b84 : ea              >            nop
                       >            tst_a $aa-$db,$ff
2b85 : 08              >            php         ;save flags
2b86 : c9cf            >            cmp #$aa-$db     ;test result
                       >            trap_ne
2b88 : f003            >        beq skip1718
                       >        trap            ;failed not equal (non zero)
2b8a : 20c740          >        jsr report_error
                       >
2b8d :                 >skip1718
                       >
2b8d : 68              >            pla         ;load status
2b8e : 48              >            pha
                       >            cmp_flag $ff
2b8f : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2b91 : f003            >        beq skip1721
                       >        trap            ;failed not equal (non zero)
2b93 : 20c740          >        jsr report_error
                       >
2b96 :                 >skip1721
                       >
2b96 : 28              >            plp         ;restore status
                       >
2b97 : c042            >            cpy #$42
                       >            trap_ne         ;y changed
2b99 : f003            >        beq skip1723
                       >        trap            ;failed not equal (non zero)
2b9b : 20c740          >        jsr report_error
                       >
2b9e :                 >skip1723
                       >
2b9e : e000            >            cpx #0
                       >            trap_ne         ;x changed
2ba0 : f003            >        beq skip1725
                       >        trap            ;failed not equal (non zero)
2ba2 : 20c740          >        jsr report_error
                       >
2ba5 :                 >skip1725
                       >
                        
                            endif
                                next_test
2ba5 : ad0211          >            lda test_case   ;previous test
2ba8 : c908            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
2baa : f003            >        beq skip1728
                       >        trap            ;failed not equal (non zero)
2bac : 20c740          >        jsr report_error
                       >
2baf :                 >skip1728
                       >
0009 =                 >test_num = test_num + 1
2baf : a909            >            lda #test_num   ;*** next tests' number
2bb1 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                            endif
                                    
                        ; jump indirect (test page cross bug is fixed)
2bb4 : a203                     ldx #3          ;prepare table
2bb6 : bdc23f           ji1     lda ji_adr,x
2bb9 : 9dfd11                   sta ji_tab,x
2bbc : ca                       dex
2bbd : 10f7                     bpl ji1
2bbf : a943                     lda #hi(ji_px) ;high address if page cross bug
2bc1 : 8d0011                   sta pg_x
                                set_stat 0
                       >            load_flag 0
2bc4 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2bc6 : 48              >            pha         ;use stack to load status
2bc7 : 28              >            plp
                        
2bc8 : a949                     lda #'I'
2bca : a24e                     ldx #'N'
2bcc : a044                     ldy #'D'        ;N=0, V=0, Z=0, C=0
2bce : 6cfd11                   jmp (ji_tab)
2bd1 : ea                       nop
                                trap_ne         ;runover protection
2bd2 : f003            >        beq skip1732
                       >        trap            ;failed not equal (non zero)
2bd4 : 20c740          >        jsr report_error
                       >
2bd7 :                 >skip1732
                        
                        
2bd7 : 88                       dey
2bd8 : 88                       dey
2bd9 : 08               ji_ret  php             ;either SP or Y count will fail, if we do not hit
2bda : 88                       dey
2bdb : 88                       dey
2bdc : 88                       dey
2bdd : 28                       plp
                                trap_eq         ;returned flags OK?
2bde : d003            >        bne skip1734
                       >        trap           ;failed equal (zero)
2be0 : 20c740          >        jsr report_error
                       >
2be3 :                 >skip1734
                        
                                trap_pl
2be3 : 3003            >        bmi skip1736
                       >        trap            ;failed plus (bit 7 clear)
2be5 : 20c740          >        jsr report_error
                       >
2be8 :                 >skip1736
                        
                                trap_cc
2be8 : b003            >        bcs skip1738
                       >        trap            ;failed carry clear
2bea : 20c740          >        jsr report_error
                       >
2bed :                 >skip1738
                        
                                trap_vc
2bed : 7003            >        bvs skip1740
                       >        trap            ;failed overflow clear
2bef : 20c740          >        jsr report_error
                       >
2bf2 :                 >skip1740
                        
2bf2 : c9e3                     cmp #('I'^$aa)  ;returned registers OK?
                                trap_ne
2bf4 : f003            >        beq skip1742
                       >        trap            ;failed not equal (non zero)
2bf6 : 20c740          >        jsr report_error
                       >
2bf9 :                 >skip1742
                        
2bf9 : e04f                     cpx #('N'+1)
                                trap_ne
2bfb : f003            >        beq skip1744
                       >        trap            ;failed not equal (non zero)
2bfd : 20c740          >        jsr report_error
                       >
2c00 :                 >skip1744
                        
2c00 : c03e                     cpy #('D'-6)
                                trap_ne
2c02 : f003            >        beq skip1746
                       >        trap            ;failed not equal (non zero)
2c04 : 20c740          >        jsr report_error
                       >
2c07 :                 >skip1746
                        
2c07 : ba                       tsx             ;SP check
2c08 : e0ff                     cpx #$ff
                                trap_ne
2c0a : f003            >        beq skip1748
                       >        trap            ;failed not equal (non zero)
2c0c : 20c740          >        jsr report_error
                       >
2c0f :                 >skip1748
                        
                                next_test
2c0f : ad0211          >            lda test_case   ;previous test
2c12 : c909            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
2c14 : f003            >        beq skip1751
                       >        trap            ;failed not equal (non zero)
2c16 : 20c740          >        jsr report_error
                       >
2c19 :                 >skip1751
                       >
000a =                 >test_num = test_num + 1
2c19 : a90a            >            lda #test_num   ;*** next tests' number
2c1b : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                        ; jump indexed indirect
2c1e : a20b                     ldx #11         ;prepare table
2c20 : bd1640           jxi1    lda jxi_adr,x
2c23 : 9df911                   sta jxi_tab,x
2c26 : ca                       dex
2c27 : 10f7                     bpl jxi1
2c29 : a943                     lda #hi(jxi_px) ;high address if page cross bug
2c2b : 8d0011                   sta pg_x
                                set_stat 0
                       >            load_flag 0
2c2e : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2c30 : 48              >            pha         ;use stack to load status
2c31 : 28              >            plp
                        
2c32 : a958                     lda #'X'
2c34 : a204                     ldx #4
2c36 : a049                     ldy #'I'        ;N=0, V=0, Z=0, C=0
2c38 : 7cf911                   jmp (jxi_tab,x)
2c3b : ea                       nop
                                trap_ne         ;runover protection
2c3c : f003            >        beq skip1755
                       >        trap            ;failed not equal (non zero)
2c3e : 20c740          >        jsr report_error
                       >
2c41 :                 >skip1755
                        
                        
2c41 : 88                       dey
2c42 : 88                       dey
2c43 : 08               jxi_ret php             ;either SP or Y count will fail, if we do not hit
2c44 : 88                       dey
2c45 : 88                       dey
2c46 : 88                       dey
2c47 : 28                       plp
                                trap_eq         ;returned flags OK?
2c48 : d003            >        bne skip1757
                       >        trap           ;failed equal (zero)
2c4a : 20c740          >        jsr report_error
                       >
2c4d :                 >skip1757
                        
                                trap_pl
2c4d : 3003            >        bmi skip1759
                       >        trap            ;failed plus (bit 7 clear)
2c4f : 20c740          >        jsr report_error
                       >
2c52 :                 >skip1759
                        
                                trap_cc
2c52 : b003            >        bcs skip1761
                       >        trap            ;failed carry clear
2c54 : 20c740          >        jsr report_error
                       >
2c57 :                 >skip1761
                        
                                trap_vc
2c57 : 7003            >        bvs skip1763
                       >        trap            ;failed overflow clear
2c59 : 20c740          >        jsr report_error
                       >
2c5c :                 >skip1763
                        
2c5c : c9f2                     cmp #('X'^$aa)  ;returned registers OK?
                                trap_ne
2c5e : f003            >        beq skip1765
                       >        trap            ;failed not equal (non zero)
2c60 : 20c740          >        jsr report_error
                       >
2c63 :                 >skip1765
                        
2c63 : e006                     cpx #6
                                trap_ne
2c65 : f003            >        beq skip1767
                       >        trap            ;failed not equal (non zero)
2c67 : 20c740          >        jsr report_error
                       >
2c6a :                 >skip1767
                        
2c6a : c043                     cpy #('I'-6)
                                trap_ne
2c6c : f003            >        beq skip1769
                       >        trap            ;failed not equal (non zero)
2c6e : 20c740          >        jsr report_error
                       >
2c71 :                 >skip1769
                        
2c71 : ba                       tsx             ;SP check
2c72 : e0ff                     cpx #$ff
                                trap_ne
2c74 : f003            >        beq skip1771
                       >        trap            ;failed not equal (non zero)
2c76 : 20c740          >        jsr report_error
                       >
2c79 :                 >skip1771
                        
                        
2c79 : a995                     lda #lo(jxp_ok) ;test with index causing a page cross
2c7b : 8d0012                   sta jxp_tab
2c7e : a92c                     lda #hi(jxp_ok)
2c80 : 8d0112                   sta jxp_tab+1
2c83 : a992                     lda #lo(jxp_px)
2c85 : 8d0011                   sta pg_x
2c88 : a92c                     lda #hi(jxp_px)
2c8a : 8d0111                   sta pg_x+1
2c8d : a2ff                     ldx #$ff
2c8f : 7c0111                   jmp (jxp_tab-$ff,x)
                                
2c92 :                  jxp_px  
                                trap            ;page cross by index to wrong page
2c92 : 20c740          >        jsr report_error
                        
                        
2c95 :                  jxp_ok
                                next_test
2c95 : ad0211          >            lda test_case   ;previous test
2c98 : c90a            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
2c9a : f003            >        beq skip1775
                       >        trap            ;failed not equal (non zero)
2c9c : 20c740          >        jsr report_error
                       >
2c9f :                 >skip1775
                       >
000b =                 >test_num = test_num + 1
2c9f : a90b            >            lda #test_num   ;*** next tests' number
2ca1 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                            if ROM_vectors = 1
                        ; test BRK clears decimal mode
                                load_flag 0     ;with interrupts enabled if allowed!
                                pha
                                lda #'B'
                                ldx #'R'
                                ldy #'K'
                                plp             ;N=0, V=0, Z=0, C=0
                                brk
                                dey             ;should not be executed
                        brk_ret0                ;address of break return
                                php             ;either SP or Y count will fail, if we do not hit
                                dey
                                dey
                                dey
                                cmp #'B'^$aa    ;returned registers OK?
                                ;the IRQ vector was never executed if A & X stay unmodified
                                trap_ne
                                cpx #'R'+1
                                trap_ne
                                cpy #'K'-6
                                trap_ne
                                pla             ;returned flags OK (unchanged)?
                                cmp_flag 0
                                trap_ne
                                tsx             ;sp?
                                cpx #$ff
                                trap_ne
                        ;pass 2
                                load_flag $ff   ;with interrupts disabled if allowed!
                                pha
                                lda #$ff-'B'
                                ldx #$ff-'R'
                                ldy #$ff-'K'
                                plp             ;N=1, V=1, Z=1, C=1
                                brk
                                dey             ;should not be executed
                        brk_ret1                ;address of break return
                                php             ;either SP or Y count will fail, if we do not hit
                                dey
                                dey
                                dey
                                cmp #($ff-'B')^$aa  ;returned registers OK?
                                ;the IRQ vector was never executed if A & X stay unmodified
                                trap_ne
                                cpx #$ff-'R'+1
                                trap_ne
                                cpy #$ff-'K'-6
                                trap_ne
                                pla             ;returned flags OK (unchanged)?
                                cmp_flag $ff
                                trap_ne
                                tsx             ;sp?
                                cpx #$ff
                                trap_ne
                                next_test
                            endif
                         
                        ; testing accumulator increment/decrement INC A & DEC A
2ca4 : a2ac                     ldx #$ac    ;protect x & y
2ca6 : a0dc                     ldy #$dc
                                set_a $fe,$ff
                       >            load_flag $ff
2ca8 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2caa : 48              >            pha         ;use stack to load status
2cab : a9fe            >            lda #$fe     ;precharge accu
2cad : 28              >            plp
                        
2cae : 1a                       inc a           ;ff
                                tst_as $ff,$ff-zero
2caf : 48              >            pha
2cb0 : 08              >            php         ;save flags
2cb1 : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
2cb3 : f003            >        beq skip1780
                       >        trap            ;failed not equal (non zero)
2cb5 : 20c740          >        jsr report_error
                       >
2cb8 :                 >skip1780
                       >
2cb8 : 68              >            pla         ;load status
2cb9 : 48              >            pha
                       >            cmp_flag $ff-zero
2cba : c9fd            >            cmp #($ff-zero|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2cbc : f003            >        beq skip1783
                       >        trap            ;failed not equal (non zero)
2cbe : 20c740          >        jsr report_error
                       >
2cc1 :                 >skip1783
                       >
2cc1 : 28              >            plp         ;restore status
2cc2 : 68              >            pla
                        
2cc3 : 1a                       inc a           ;00
                                tst_as 0,$ff-minus
2cc4 : 48              >            pha
2cc5 : 08              >            php         ;save flags
2cc6 : c900            >            cmp #0     ;test result
                       >            trap_ne
2cc8 : f003            >        beq skip1786
                       >        trap            ;failed not equal (non zero)
2cca : 20c740          >        jsr report_error
                       >
2ccd :                 >skip1786
                       >
2ccd : 68              >            pla         ;load status
2cce : 48              >            pha
                       >            cmp_flag $ff-minus
2ccf : c97f            >            cmp #($ff-minus|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2cd1 : f003            >        beq skip1789
                       >        trap            ;failed not equal (non zero)
2cd3 : 20c740          >        jsr report_error
                       >
2cd6 :                 >skip1789
                       >
2cd6 : 28              >            plp         ;restore status
2cd7 : 68              >            pla
                        
2cd8 : 1a                       inc a           ;01
                                tst_as 1,$ff-minus-zero
2cd9 : 48              >            pha
2cda : 08              >            php         ;save flags
2cdb : c901            >            cmp #1     ;test result
                       >            trap_ne
2cdd : f003            >        beq skip1792
                       >        trap            ;failed not equal (non zero)
2cdf : 20c740          >        jsr report_error
                       >
2ce2 :                 >skip1792
                       >
2ce2 : 68              >            pla         ;load status
2ce3 : 48              >            pha
                       >            cmp_flag $ff-minus-zero
2ce4 : c97d            >            cmp #($ff-minus-zero|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2ce6 : f003            >        beq skip1795
                       >        trap            ;failed not equal (non zero)
2ce8 : 20c740          >        jsr report_error
                       >
2ceb :                 >skip1795
                       >
2ceb : 28              >            plp         ;restore status
2cec : 68              >            pla
                        
2ced : 3a                       dec a           ;00
                                tst_as 0,$ff-minus
2cee : 48              >            pha
2cef : 08              >            php         ;save flags
2cf0 : c900            >            cmp #0     ;test result
                       >            trap_ne
2cf2 : f003            >        beq skip1798
                       >        trap            ;failed not equal (non zero)
2cf4 : 20c740          >        jsr report_error
                       >
2cf7 :                 >skip1798
                       >
2cf7 : 68              >            pla         ;load status
2cf8 : 48              >            pha
                       >            cmp_flag $ff-minus
2cf9 : c97f            >            cmp #($ff-minus|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2cfb : f003            >        beq skip1801
                       >        trap            ;failed not equal (non zero)
2cfd : 20c740          >        jsr report_error
                       >
2d00 :                 >skip1801
                       >
2d00 : 28              >            plp         ;restore status
2d01 : 68              >            pla
                        
2d02 : 3a                       dec a           ;ff
                                tst_as $ff,$ff-zero
2d03 : 48              >            pha
2d04 : 08              >            php         ;save flags
2d05 : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
2d07 : f003            >        beq skip1804
                       >        trap            ;failed not equal (non zero)
2d09 : 20c740          >        jsr report_error
                       >
2d0c :                 >skip1804
                       >
2d0c : 68              >            pla         ;load status
2d0d : 48              >            pha
                       >            cmp_flag $ff-zero
2d0e : c9fd            >            cmp #($ff-zero|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2d10 : f003            >        beq skip1807
                       >        trap            ;failed not equal (non zero)
2d12 : 20c740          >        jsr report_error
                       >
2d15 :                 >skip1807
                       >
2d15 : 28              >            plp         ;restore status
2d16 : 68              >            pla
                        
2d17 : 3a                       dec a           ;fe
                                set_a $fe,0
                       >            load_flag 0
2d18 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2d1a : 48              >            pha         ;use stack to load status
2d1b : a9fe            >            lda #$fe     ;precharge accu
2d1d : 28              >            plp
                        
2d1e : 1a                       inc a           ;ff
                                tst_as $ff,minus
2d1f : 48              >            pha
2d20 : 08              >            php         ;save flags
2d21 : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
2d23 : f003            >        beq skip1812
                       >        trap            ;failed not equal (non zero)
2d25 : 20c740          >        jsr report_error
                       >
2d28 :                 >skip1812
                       >
2d28 : 68              >            pla         ;load status
2d29 : 48              >            pha
                       >            cmp_flag minus
2d2a : c9b0            >            cmp #(minus|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2d2c : f003            >        beq skip1815
                       >        trap            ;failed not equal (non zero)
2d2e : 20c740          >        jsr report_error
                       >
2d31 :                 >skip1815
                       >
2d31 : 28              >            plp         ;restore status
2d32 : 68              >            pla
                        
2d33 : 1a                       inc a           ;00
                                tst_as 0,zero
2d34 : 48              >            pha
2d35 : 08              >            php         ;save flags
2d36 : c900            >            cmp #0     ;test result
                       >            trap_ne
2d38 : f003            >        beq skip1818
                       >        trap            ;failed not equal (non zero)
2d3a : 20c740          >        jsr report_error
                       >
2d3d :                 >skip1818
                       >
2d3d : 68              >            pla         ;load status
2d3e : 48              >            pha
                       >            cmp_flag zero
2d3f : c932            >            cmp #(zero|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2d41 : f003            >        beq skip1821
                       >        trap            ;failed not equal (non zero)
2d43 : 20c740          >        jsr report_error
                       >
2d46 :                 >skip1821
                       >
2d46 : 28              >            plp         ;restore status
2d47 : 68              >            pla
                        
2d48 : 1a                       inc a           ;01
                                tst_as 1,0
2d49 : 48              >            pha
2d4a : 08              >            php         ;save flags
2d4b : c901            >            cmp #1     ;test result
                       >            trap_ne
2d4d : f003            >        beq skip1824
                       >        trap            ;failed not equal (non zero)
2d4f : 20c740          >        jsr report_error
                       >
2d52 :                 >skip1824
                       >
2d52 : 68              >            pla         ;load status
2d53 : 48              >            pha
                       >            cmp_flag 0
2d54 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2d56 : f003            >        beq skip1827
                       >        trap            ;failed not equal (non zero)
2d58 : 20c740          >        jsr report_error
                       >
2d5b :                 >skip1827
                       >
2d5b : 28              >            plp         ;restore status
2d5c : 68              >            pla
                        
2d5d : 3a                       dec a           ;00
                                tst_as 0,zero
2d5e : 48              >            pha
2d5f : 08              >            php         ;save flags
2d60 : c900            >            cmp #0     ;test result
                       >            trap_ne
2d62 : f003            >        beq skip1830
                       >        trap            ;failed not equal (non zero)
2d64 : 20c740          >        jsr report_error
                       >
2d67 :                 >skip1830
                       >
2d67 : 68              >            pla         ;load status
2d68 : 48              >            pha
                       >            cmp_flag zero
2d69 : c932            >            cmp #(zero|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2d6b : f003            >        beq skip1833
                       >        trap            ;failed not equal (non zero)
2d6d : 20c740          >        jsr report_error
                       >
2d70 :                 >skip1833
                       >
2d70 : 28              >            plp         ;restore status
2d71 : 68              >            pla
                        
2d72 : 3a                       dec a           ;ff
                                tst_as $ff,minus
2d73 : 48              >            pha
2d74 : 08              >            php         ;save flags
2d75 : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
2d77 : f003            >        beq skip1836
                       >        trap            ;failed not equal (non zero)
2d79 : 20c740          >        jsr report_error
                       >
2d7c :                 >skip1836
                       >
2d7c : 68              >            pla         ;load status
2d7d : 48              >            pha
                       >            cmp_flag minus
2d7e : c9b0            >            cmp #(minus|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2d80 : f003            >        beq skip1839
                       >        trap            ;failed not equal (non zero)
2d82 : 20c740          >        jsr report_error
                       >
2d85 :                 >skip1839
                       >
2d85 : 28              >            plp         ;restore status
2d86 : 68              >            pla
                        
2d87 : e0ac                     cpx #$ac
                                trap_ne     ;x altered during test
2d89 : f003            >        beq skip1841
                       >        trap            ;failed not equal (non zero)
2d8b : 20c740          >        jsr report_error
                       >
2d8e :                 >skip1841
                        
2d8e : c0dc                     cpy #$dc
                                trap_ne     ;y altered during test
2d90 : f003            >        beq skip1843
                       >        trap            ;failed not equal (non zero)
2d92 : 20c740          >        jsr report_error
                       >
2d95 :                 >skip1843
                        
2d95 : ba                       tsx
2d96 : e0ff                     cpx #$ff
                                trap_ne     ;sp push/pop mismatch
2d98 : f003            >        beq skip1845
                       >        trap            ;failed not equal (non zero)
2d9a : 20c740          >        jsr report_error
                       >
2d9d :                 >skip1845
                        
                                next_test
2d9d : ad0211          >            lda test_case   ;previous test
2da0 : c90b            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
2da2 : f003            >        beq skip1848
                       >        trap            ;failed not equal (non zero)
2da4 : 20c740          >        jsr report_error
                       >
2da7 :                 >skip1848
                       >
000c =                 >test_num = test_num + 1
2da7 : a90c            >            lda #test_num   ;*** next tests' number
2da9 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                        ; testing load / store accumulator LDA / STA (zp)
2dac : a299                     ldx #$99    ;protect x & y
2dae : a066                     ldy #$66
                                set_stat 0  
                       >            load_flag 0  
2db0 : a900            >            lda #0               ;allow test to change I-flag (no mask)
                       >
2db2 : 48              >            pha         ;use stack to load status
2db3 : 28              >            plp
                        
2db4 : b26a                     lda (ind1)
2db6 : 08                       php         ;test stores do not alter flags
2db7 : 49c3                     eor #$c3
2db9 : 28                       plp
2dba : 9276                     sta (indt)
2dbc : 08                       php         ;flags after load/store sequence
2dbd : 49c3                     eor #$c3
2dbf : c9c3                     cmp #$c3    ;test result
                                trap_ne
2dc1 : f003            >        beq skip1852
                       >        trap            ;failed not equal (non zero)
2dc3 : 20c740          >        jsr report_error
                       >
2dc6 :                 >skip1852
                        
2dc6 : 68                       pla         ;load status
                                eor_flag 0
2dc7 : 4930            >            eor #0|fao         ;invert expected flags + always on bits
                        
2dc9 : cd1511                   cmp fLDx    ;test flags
                                trap_ne
2dcc : f003            >        beq skip1855
                       >        trap            ;failed not equal (non zero)
2dce : 20c740          >        jsr report_error
                       >
2dd1 :                 >skip1855
                        
                                set_stat 0
                       >            load_flag 0
2dd1 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2dd3 : 48              >            pha         ;use stack to load status
2dd4 : 28              >            plp
                        
2dd5 : b26c                     lda (ind1+2)
2dd7 : 08                       php         ;test stores do not alter flags
2dd8 : 49c3                     eor #$c3
2dda : 28                       plp
2ddb : 9278                     sta (indt+2)
2ddd : 08                       php         ;flags after load/store sequence
2dde : 49c3                     eor #$c3
2de0 : c982                     cmp #$82    ;test result
                                trap_ne
2de2 : f003            >        beq skip1859
                       >        trap            ;failed not equal (non zero)
2de4 : 20c740          >        jsr report_error
                       >
2de7 :                 >skip1859
                        
2de7 : 68                       pla         ;load status
                                eor_flag 0
2de8 : 4930            >            eor #0|fao         ;invert expected flags + always on bits
                        
2dea : cd1611                   cmp fLDx+1  ;test flags
                                trap_ne
2ded : f003            >        beq skip1862
                       >        trap            ;failed not equal (non zero)
2def : 20c740          >        jsr report_error
                       >
2df2 :                 >skip1862
                        
                                set_stat 0
                       >            load_flag 0
2df2 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2df4 : 48              >            pha         ;use stack to load status
2df5 : 28              >            plp
                        
2df6 : b26e                     lda (ind1+4)
2df8 : 08                       php         ;test stores do not alter flags
2df9 : 49c3                     eor #$c3
2dfb : 28                       plp
2dfc : 927a                     sta (indt+4)
2dfe : 08                       php         ;flags after load/store sequence
2dff : 49c3                     eor #$c3
2e01 : c941                     cmp #$41    ;test result
                                trap_ne
2e03 : f003            >        beq skip1866
                       >        trap            ;failed not equal (non zero)
2e05 : 20c740          >        jsr report_error
                       >
2e08 :                 >skip1866
                        
2e08 : 68                       pla         ;load status
                                eor_flag 0
2e09 : 4930            >            eor #0|fao         ;invert expected flags + always on bits
                        
2e0b : cd1711                   cmp fLDx+2  ;test flags
                                trap_ne
2e0e : f003            >        beq skip1869
                       >        trap            ;failed not equal (non zero)
2e10 : 20c740          >        jsr report_error
                       >
2e13 :                 >skip1869
                        
                                set_stat 0
                       >            load_flag 0
2e13 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2e15 : 48              >            pha         ;use stack to load status
2e16 : 28              >            plp
                        
2e17 : b270                     lda (ind1+6)
2e19 : 08                       php         ;test stores do not alter flags
2e1a : 49c3                     eor #$c3
2e1c : 28                       plp
2e1d : 927c                     sta (indt+6)
2e1f : 08                       php         ;flags after load/store sequence
2e20 : 49c3                     eor #$c3
2e22 : c900                     cmp #0      ;test result
                                trap_ne
2e24 : f003            >        beq skip1873
                       >        trap            ;failed not equal (non zero)
2e26 : 20c740          >        jsr report_error
                       >
2e29 :                 >skip1873
                        
2e29 : 68                       pla         ;load status
                                eor_flag 0
2e2a : 4930            >            eor #0|fao         ;invert expected flags + always on bits
                        
2e2c : cd1811                   cmp fLDx+3  ;test flags
                                trap_ne
2e2f : f003            >        beq skip1876
                       >        trap            ;failed not equal (non zero)
2e31 : 20c740          >        jsr report_error
                       >
2e34 :                 >skip1876
                        
2e34 : e099                     cpx #$99
                                trap_ne     ;x altered during test
2e36 : f003            >        beq skip1878
                       >        trap            ;failed not equal (non zero)
2e38 : 20c740          >        jsr report_error
                       >
2e3b :                 >skip1878
                        
2e3b : c066                     cpy #$66
                                trap_ne     ;y altered during test
2e3d : f003            >        beq skip1880
                       >        trap            ;failed not equal (non zero)
2e3f : 20c740          >        jsr report_error
                       >
2e42 :                 >skip1880
                        
                        
2e42 : a003                     ldy #3      ;testing store result
2e44 : a200                     ldx #0
2e46 : b90511           tstai1  lda abst,y
2e49 : 49c3                     eor #$c3
2e4b : d91011                   cmp abs1,y
                                trap_ne     ;store to indirect data
2e4e : f003            >        beq skip1882
                       >        trap            ;failed not equal (non zero)
2e50 : 20c740          >        jsr report_error
                       >
2e53 :                 >skip1882
                        
2e53 : 8a                       txa
2e54 : 990511                   sta abst,y  ;clear                
2e57 : 88                       dey
2e58 : 10ec                     bpl tstai1
                        
2e5a : a299                     ldx #$99    ;protect x & y
2e5c : a066                     ldy #$66
                                set_stat $ff  
                       >            load_flag $ff  
2e5e : a9ff            >            lda #$ff               ;allow test to change I-flag (no mask)
                       >
2e60 : 48              >            pha         ;use stack to load status
2e61 : 28              >            plp
                        
2e62 : b26a                     lda (ind1)
2e64 : 08                       php         ;test stores do not alter flags
2e65 : 49c3                     eor #$c3
2e67 : 28                       plp
2e68 : 9276                     sta (indt)
2e6a : 08                       php         ;flags after load/store sequence
2e6b : 49c3                     eor #$c3
2e6d : c9c3                     cmp #$c3    ;test result
                                trap_ne
2e6f : f003            >        beq skip1886
                       >        trap            ;failed not equal (non zero)
2e71 : 20c740          >        jsr report_error
                       >
2e74 :                 >skip1886
                        
2e74 : 68                       pla         ;load status
                                eor_flag lo~fnz ;mask bits not altered
2e75 : 497d            >            eor #lo~fnz |fao         ;invert expected flags + always on bits
                        
2e77 : cd1511                   cmp fLDx    ;test flags
                                trap_ne
2e7a : f003            >        beq skip1889
                       >        trap            ;failed not equal (non zero)
2e7c : 20c740          >        jsr report_error
                       >
2e7f :                 >skip1889
                        
                                set_stat $ff
                       >            load_flag $ff
2e7f : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2e81 : 48              >            pha         ;use stack to load status
2e82 : 28              >            plp
                        
2e83 : b26c                     lda (ind1+2)
2e85 : 08                       php         ;test stores do not alter flags
2e86 : 49c3                     eor #$c3
2e88 : 28                       plp
2e89 : 9278                     sta (indt+2)
2e8b : 08                       php         ;flags after load/store sequence
2e8c : 49c3                     eor #$c3
2e8e : c982                     cmp #$82    ;test result
                                trap_ne
2e90 : f003            >        beq skip1893
                       >        trap            ;failed not equal (non zero)
2e92 : 20c740          >        jsr report_error
                       >
2e95 :                 >skip1893
                        
2e95 : 68                       pla         ;load status
                                eor_flag lo~fnz ;mask bits not altered
2e96 : 497d            >            eor #lo~fnz |fao         ;invert expected flags + always on bits
                        
2e98 : cd1611                   cmp fLDx+1  ;test flags
                                trap_ne
2e9b : f003            >        beq skip1896
                       >        trap            ;failed not equal (non zero)
2e9d : 20c740          >        jsr report_error
                       >
2ea0 :                 >skip1896
                        
                                set_stat $ff
                       >            load_flag $ff
2ea0 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2ea2 : 48              >            pha         ;use stack to load status
2ea3 : 28              >            plp
                        
2ea4 : b26e                     lda (ind1+4)
2ea6 : 08                       php         ;test stores do not alter flags
2ea7 : 49c3                     eor #$c3
2ea9 : 28                       plp
2eaa : 927a                     sta (indt+4)
2eac : 08                       php         ;flags after load/store sequence
2ead : 49c3                     eor #$c3
2eaf : c941                     cmp #$41    ;test result
                                trap_ne
2eb1 : f003            >        beq skip1900
                       >        trap            ;failed not equal (non zero)
2eb3 : 20c740          >        jsr report_error
                       >
2eb6 :                 >skip1900
                        
2eb6 : 68                       pla         ;load status
                                eor_flag lo~fnz ;mask bits not altered
2eb7 : 497d            >            eor #lo~fnz |fao         ;invert expected flags + always on bits
                        
2eb9 : cd1711                   cmp fLDx+2  ;test flags
                                trap_ne
2ebc : f003            >        beq skip1903
                       >        trap            ;failed not equal (non zero)
2ebe : 20c740          >        jsr report_error
                       >
2ec1 :                 >skip1903
                        
                                set_stat $ff
                       >            load_flag $ff
2ec1 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2ec3 : 48              >            pha         ;use stack to load status
2ec4 : 28              >            plp
                        
2ec5 : b270                     lda (ind1+6)
2ec7 : 08                       php         ;test stores do not alter flags
2ec8 : 49c3                     eor #$c3
2eca : 28                       plp
2ecb : 927c                     sta (indt+6)
2ecd : 08                       php         ;flags after load/store sequence
2ece : 49c3                     eor #$c3
2ed0 : c900                     cmp #0      ;test result
                                trap_ne
2ed2 : f003            >        beq skip1907
                       >        trap            ;failed not equal (non zero)
2ed4 : 20c740          >        jsr report_error
                       >
2ed7 :                 >skip1907
                        
2ed7 : 68                       pla         ;load status
                                eor_flag lo~fnz ;mask bits not altered
2ed8 : 497d            >            eor #lo~fnz |fao         ;invert expected flags + always on bits
                        
2eda : cd1811                   cmp fLDx+3  ;test flags
                                trap_ne
2edd : f003            >        beq skip1910
                       >        trap            ;failed not equal (non zero)
2edf : 20c740          >        jsr report_error
                       >
2ee2 :                 >skip1910
                        
2ee2 : e099                     cpx #$99
                                trap_ne     ;x altered during test
2ee4 : f003            >        beq skip1912
                       >        trap            ;failed not equal (non zero)
2ee6 : 20c740          >        jsr report_error
                       >
2ee9 :                 >skip1912
                        
2ee9 : c066                     cpy #$66
                                trap_ne     ;y altered during test
2eeb : f003            >        beq skip1914
                       >        trap            ;failed not equal (non zero)
2eed : 20c740          >        jsr report_error
                       >
2ef0 :                 >skip1914
                        
                        
2ef0 : a003                     ldy #3      ;testing store result
2ef2 : a200                     ldx #0
2ef4 : b90511           tstai2  lda abst,y
2ef7 : 49c3                     eor #$c3
2ef9 : d91011                   cmp abs1,y
                                trap_ne     ;store to indirect data
2efc : f003            >        beq skip1916
                       >        trap            ;failed not equal (non zero)
2efe : 20c740          >        jsr report_error
                       >
2f01 :                 >skip1916
                        
2f01 : 8a                       txa
2f02 : 990511                   sta abst,y  ;clear                
2f05 : 88                       dey
2f06 : 10ec                     bpl tstai2
2f08 : ba                       tsx
2f09 : e0ff                     cpx #$ff
                                trap_ne     ;sp push/pop mismatch
2f0b : f003            >        beq skip1918
                       >        trap            ;failed not equal (non zero)
2f0d : 20c740          >        jsr report_error
                       >
2f10 :                 >skip1918
                        
                                next_test
2f10 : ad0211          >            lda test_case   ;previous test
2f13 : c90c            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
2f15 : f003            >        beq skip1921
                       >        trap            ;failed not equal (non zero)
2f17 : 20c740          >        jsr report_error
                       >
2f1a :                 >skip1921
                       >
000d =                 >test_num = test_num + 1
2f1a : a90d            >            lda #test_num   ;*** next tests' number
2f1c : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                        ; testing STZ - zp / abs / zp,x / abs,x
2f1f : a07b                     ldy #123    ;protect y
2f21 : a204                     ldx #4      ;precharge test area
2f23 : a907                     lda #7
2f25 : 9552             tstz1   sta zpt,x
2f27 : 0a                       asl a
2f28 : ca                       dex
2f29 : 10fa                     bpl tstz1
2f2b : a204                     ldx #4
                                set_a $55,$ff
                       >            load_flag $ff
2f2d : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2f2f : 48              >            pha         ;use stack to load status
2f30 : a955            >            lda #$55     ;precharge accu
2f32 : 28              >            plp
                        
2f33 : 6452                     stz zpt     
2f35 : 6453                     stz zpt+1
2f37 : 6454                     stz zpt+2
2f39 : 6455                     stz zpt+3
2f3b : 6456                     stz zpt+4
                                tst_a $55,$ff
2f3d : 08              >            php         ;save flags
2f3e : c955            >            cmp #$55     ;test result
                       >            trap_ne
2f40 : f003            >        beq skip1926
                       >        trap            ;failed not equal (non zero)
2f42 : 20c740          >        jsr report_error
                       >
2f45 :                 >skip1926
                       >
2f45 : 68              >            pla         ;load status
2f46 : 48              >            pha
                       >            cmp_flag $ff
2f47 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2f49 : f003            >        beq skip1929
                       >        trap            ;failed not equal (non zero)
2f4b : 20c740          >        jsr report_error
                       >
2f4e :                 >skip1929
                       >
2f4e : 28              >            plp         ;restore status
                        
2f4f : b552             tstz2   lda zpt,x   ;verify zeros stored
                                trap_ne     ;non zero after STZ zp
2f51 : f003            >        beq skip1931
                       >        trap            ;failed not equal (non zero)
2f53 : 20c740          >        jsr report_error
                       >
2f56 :                 >skip1931
                        
2f56 : ca                       dex
2f57 : 10f6                     bpl tstz2
2f59 : a204                     ldx #4      ;precharge test area
2f5b : a907                     lda #7
2f5d : 9552             tstz3   sta zpt,x
2f5f : 0a                       asl a
2f60 : ca                       dex
2f61 : 10fa                     bpl tstz3
2f63 : a204                     ldx #4
                                set_a $aa,0
                       >            load_flag 0
2f65 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2f67 : 48              >            pha         ;use stack to load status
2f68 : a9aa            >            lda #$aa     ;precharge accu
2f6a : 28              >            plp
                        
2f6b : 6452                     stz zpt     
2f6d : 6453                     stz zpt+1
2f6f : 6454                     stz zpt+2
2f71 : 6455                     stz zpt+3
2f73 : 6456                     stz zpt+4
                                tst_a $aa,0
2f75 : 08              >            php         ;save flags
2f76 : c9aa            >            cmp #$aa     ;test result
                       >            trap_ne
2f78 : f003            >        beq skip1936
                       >        trap            ;failed not equal (non zero)
2f7a : 20c740          >        jsr report_error
                       >
2f7d :                 >skip1936
                       >
2f7d : 68              >            pla         ;load status
2f7e : 48              >            pha
                       >            cmp_flag 0
2f7f : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2f81 : f003            >        beq skip1939
                       >        trap            ;failed not equal (non zero)
2f83 : 20c740          >        jsr report_error
                       >
2f86 :                 >skip1939
                       >
2f86 : 28              >            plp         ;restore status
                        
2f87 : b552             tstz4   lda zpt,x   ;verify zeros stored
                                trap_ne     ;non zero after STZ zp
2f89 : f003            >        beq skip1941
                       >        trap            ;failed not equal (non zero)
2f8b : 20c740          >        jsr report_error
                       >
2f8e :                 >skip1941
                        
2f8e : ca                       dex
2f8f : 10f6                     bpl tstz4
                                
2f91 : a204                     ldx #4      ;precharge test area
2f93 : a907                     lda #7
2f95 : 9d0511           tstz5   sta abst,x
2f98 : 0a                       asl a
2f99 : ca                       dex
2f9a : 10f9                     bpl tstz5
2f9c : a204                     ldx #4
                                set_a $55,$ff
                       >            load_flag $ff
2f9e : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
2fa0 : 48              >            pha         ;use stack to load status
2fa1 : a955            >            lda #$55     ;precharge accu
2fa3 : 28              >            plp
                        
2fa4 : 9c0511                   stz abst     
2fa7 : 9c0611                   stz abst+1
2faa : 9c0711                   stz abst+2
2fad : 9c0811                   stz abst+3
2fb0 : 9c0911                   stz abst+4
                                tst_a $55,$ff
2fb3 : 08              >            php         ;save flags
2fb4 : c955            >            cmp #$55     ;test result
                       >            trap_ne
2fb6 : f003            >        beq skip1946
                       >        trap            ;failed not equal (non zero)
2fb8 : 20c740          >        jsr report_error
                       >
2fbb :                 >skip1946
                       >
2fbb : 68              >            pla         ;load status
2fbc : 48              >            pha
                       >            cmp_flag $ff
2fbd : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2fbf : f003            >        beq skip1949
                       >        trap            ;failed not equal (non zero)
2fc1 : 20c740          >        jsr report_error
                       >
2fc4 :                 >skip1949
                       >
2fc4 : 28              >            plp         ;restore status
                        
2fc5 : bd0511           tstz6   lda abst,x   ;verify zeros stored
                                trap_ne     ;non zero after STZ abs
2fc8 : f003            >        beq skip1951
                       >        trap            ;failed not equal (non zero)
2fca : 20c740          >        jsr report_error
                       >
2fcd :                 >skip1951
                        
2fcd : ca                       dex
2fce : 10f5                     bpl tstz6
2fd0 : a204                     ldx #4      ;precharge test area
2fd2 : a907                     lda #7
2fd4 : 9d0511           tstz7   sta abst,x
2fd7 : 0a                       asl a
2fd8 : ca                       dex
2fd9 : 10f9                     bpl tstz7
2fdb : a204                     ldx #4
                                set_a $aa,0
                       >            load_flag 0
2fdd : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
2fdf : 48              >            pha         ;use stack to load status
2fe0 : a9aa            >            lda #$aa     ;precharge accu
2fe2 : 28              >            plp
                        
2fe3 : 9c0511                   stz abst     
2fe6 : 9c0611                   stz abst+1
2fe9 : 9c0711                   stz abst+2
2fec : 9c0811                   stz abst+3
2fef : 9c0911                   stz abst+4
                                tst_a $aa,0
2ff2 : 08              >            php         ;save flags
2ff3 : c9aa            >            cmp #$aa     ;test result
                       >            trap_ne
2ff5 : f003            >        beq skip1956
                       >        trap            ;failed not equal (non zero)
2ff7 : 20c740          >        jsr report_error
                       >
2ffa :                 >skip1956
                       >
2ffa : 68              >            pla         ;load status
2ffb : 48              >            pha
                       >            cmp_flag 0
2ffc : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
2ffe : f003            >        beq skip1959
                       >        trap            ;failed not equal (non zero)
3000 : 20c740          >        jsr report_error
                       >
3003 :                 >skip1959
                       >
3003 : 28              >            plp         ;restore status
                        
3004 : bd0511           tstz8   lda abst,x   ;verify zeros stored
                                trap_ne     ;non zero after STZ abs
3007 : f003            >        beq skip1961
                       >        trap            ;failed not equal (non zero)
3009 : 20c740          >        jsr report_error
                       >
300c :                 >skip1961
                        
300c : ca                       dex
300d : 10f5                     bpl tstz8
                                
300f : a204                     ldx #4      ;precharge test area
3011 : a907                     lda #7
3013 : 9552             tstz11  sta zpt,x
3015 : 0a                       asl a
3016 : ca                       dex
3017 : 10fa                     bpl tstz11
3019 : a204                     ldx #4
301b :                  tstz15
                                set_a $55,$ff
                       >            load_flag $ff
301b : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
301d : 48              >            pha         ;use stack to load status
301e : a955            >            lda #$55     ;precharge accu
3020 : 28              >            plp
                        
3021 : 7452                     stz zpt,x     
                                tst_a $55,$ff
3023 : 08              >            php         ;save flags
3024 : c955            >            cmp #$55     ;test result
                       >            trap_ne
3026 : f003            >        beq skip1966
                       >        trap            ;failed not equal (non zero)
3028 : 20c740          >        jsr report_error
                       >
302b :                 >skip1966
                       >
302b : 68              >            pla         ;load status
302c : 48              >            pha
                       >            cmp_flag $ff
302d : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
302f : f003            >        beq skip1969
                       >        trap            ;failed not equal (non zero)
3031 : 20c740          >        jsr report_error
                       >
3034 :                 >skip1969
                       >
3034 : 28              >            plp         ;restore status
                        
3035 : ca                       dex
3036 : 10e3                     bpl tstz15
3038 : a204                     ldx #4
303a : b552             tstz12  lda zpt,x   ;verify zeros stored
                                trap_ne     ;non zero after STZ zp
303c : f003            >        beq skip1971
                       >        trap            ;failed not equal (non zero)
303e : 20c740          >        jsr report_error
                       >
3041 :                 >skip1971
                        
3041 : ca                       dex
3042 : 10f6                     bpl tstz12
3044 : a204                     ldx #4      ;precharge test area
3046 : a907                     lda #7
3048 : 9552             tstz13  sta zpt,x
304a : 0a                       asl a
304b : ca                       dex
304c : 10fa                     bpl tstz13
304e : a204                     ldx #4
3050 :                  tstz16
                                set_a $aa,0
                       >            load_flag 0
3050 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3052 : 48              >            pha         ;use stack to load status
3053 : a9aa            >            lda #$aa     ;precharge accu
3055 : 28              >            plp
                        
3056 : 7452                     stz zpt,x
                                tst_a $aa,0
3058 : 08              >            php         ;save flags
3059 : c9aa            >            cmp #$aa     ;test result
                       >            trap_ne
305b : f003            >        beq skip1976
                       >        trap            ;failed not equal (non zero)
305d : 20c740          >        jsr report_error
                       >
3060 :                 >skip1976
                       >
3060 : 68              >            pla         ;load status
3061 : 48              >            pha
                       >            cmp_flag 0
3062 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3064 : f003            >        beq skip1979
                       >        trap            ;failed not equal (non zero)
3066 : 20c740          >        jsr report_error
                       >
3069 :                 >skip1979
                       >
3069 : 28              >            plp         ;restore status
                        
306a : ca                       dex
306b : 10e3                     bpl tstz16
306d : a204                     ldx #4
306f : b552             tstz14  lda zpt,x   ;verify zeros stored
                                trap_ne     ;non zero after STZ zp
3071 : f003            >        beq skip1981
                       >        trap            ;failed not equal (non zero)
3073 : 20c740          >        jsr report_error
                       >
3076 :                 >skip1981
                        
3076 : ca                       dex
3077 : 10f6                     bpl tstz14
                                
3079 : a204                     ldx #4      ;precharge test area
307b : a907                     lda #7
307d : 9d0511           tstz21  sta abst,x
3080 : 0a                       asl a
3081 : ca                       dex
3082 : 10f9                     bpl tstz21
3084 : a204                     ldx #4
3086 :                  tstz25
                                set_a $55,$ff
                       >            load_flag $ff
3086 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3088 : 48              >            pha         ;use stack to load status
3089 : a955            >            lda #$55     ;precharge accu
308b : 28              >            plp
                        
308c : 9e0511                   stz abst,x     
                                tst_a $55,$ff
308f : 08              >            php         ;save flags
3090 : c955            >            cmp #$55     ;test result
                       >            trap_ne
3092 : f003            >        beq skip1986
                       >        trap            ;failed not equal (non zero)
3094 : 20c740          >        jsr report_error
                       >
3097 :                 >skip1986
                       >
3097 : 68              >            pla         ;load status
3098 : 48              >            pha
                       >            cmp_flag $ff
3099 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
309b : f003            >        beq skip1989
                       >        trap            ;failed not equal (non zero)
309d : 20c740          >        jsr report_error
                       >
30a0 :                 >skip1989
                       >
30a0 : 28              >            plp         ;restore status
                        
30a1 : ca                       dex
30a2 : 10e2                     bpl tstz25
30a4 : a204                     ldx #4
30a6 : bd0511           tstz22  lda abst,x   ;verify zeros stored
                                trap_ne     ;non zero after STZ zp
30a9 : f003            >        beq skip1991
                       >        trap            ;failed not equal (non zero)
30ab : 20c740          >        jsr report_error
                       >
30ae :                 >skip1991
                        
30ae : ca                       dex
30af : 10f5                     bpl tstz22
30b1 : a204                     ldx #4      ;precharge test area
30b3 : a907                     lda #7
30b5 : 9d0511           tstz23  sta abst,x
30b8 : 0a                       asl a
30b9 : ca                       dex
30ba : 10f9                     bpl tstz23
30bc : a204                     ldx #4
30be :                  tstz26
                                set_a $aa,0
                       >            load_flag 0
30be : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
30c0 : 48              >            pha         ;use stack to load status
30c1 : a9aa            >            lda #$aa     ;precharge accu
30c3 : 28              >            plp
                        
30c4 : 9e0511                   stz abst,x
                                tst_a $aa,0
30c7 : 08              >            php         ;save flags
30c8 : c9aa            >            cmp #$aa     ;test result
                       >            trap_ne
30ca : f003            >        beq skip1996
                       >        trap            ;failed not equal (non zero)
30cc : 20c740          >        jsr report_error
                       >
30cf :                 >skip1996
                       >
30cf : 68              >            pla         ;load status
30d0 : 48              >            pha
                       >            cmp_flag 0
30d1 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
30d3 : f003            >        beq skip1999
                       >        trap            ;failed not equal (non zero)
30d5 : 20c740          >        jsr report_error
                       >
30d8 :                 >skip1999
                       >
30d8 : 28              >            plp         ;restore status
                        
30d9 : ca                       dex
30da : 10e2                     bpl tstz26
30dc : a204                     ldx #4
30de : bd0511           tstz24  lda abst,x   ;verify zeros stored
                                trap_ne     ;non zero after STZ zp
30e1 : f003            >        beq skip2001
                       >        trap            ;failed not equal (non zero)
30e3 : 20c740          >        jsr report_error
                       >
30e6 :                 >skip2001
                        
30e6 : ca                       dex
30e7 : 10f5                     bpl tstz24
                                
30e9 : c07b                     cpy #123
                                trap_ne     ;y altered during test 
30eb : f003            >        beq skip2003
                       >        trap            ;failed not equal (non zero)
30ed : 20c740          >        jsr report_error
                       >
30f0 :                 >skip2003
                        
30f0 : ba                       tsx
30f1 : e0ff                     cpx #$ff
                                trap_ne     ;sp push/pop mismatch
30f3 : f003            >        beq skip2005
                       >        trap            ;failed not equal (non zero)
30f5 : 20c740          >        jsr report_error
                       >
30f8 :                 >skip2005
                        
                                next_test
30f8 : ad0211          >            lda test_case   ;previous test
30fb : c90d            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
30fd : f003            >        beq skip2008
                       >        trap            ;failed not equal (non zero)
30ff : 20c740          >        jsr report_error
                       >
3102 :                 >skip2008
                       >
000e =                 >test_num = test_num + 1
3102 : a90e            >            lda #test_num   ;*** next tests' number
3104 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                        ; testing BIT - zp,x / abs,x / #
3107 : a042                     ldy #$42
3109 : a203                     ldx #3
                                set_a $ff,0
                       >            load_flag 0
310b : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
310d : 48              >            pha         ;use stack to load status
310e : a9ff            >            lda #$ff     ;precharge accu
3110 : 28              >            plp
                        
3111 : 3459                     bit zp1,x   ;00 - should set Z / clear  NV
                                tst_a $ff,fz 
3113 : 08              >            php         ;save flags
3114 : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
3116 : f003            >        beq skip2013
                       >        trap            ;failed not equal (non zero)
3118 : 20c740          >        jsr report_error
                       >
311b :                 >skip2013
                       >
311b : 68              >            pla         ;load status
311c : 48              >            pha
                       >            cmp_flag fz 
311d : c932            >            cmp #(fz |fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
311f : f003            >        beq skip2016
                       >        trap            ;failed not equal (non zero)
3121 : 20c740          >        jsr report_error
                       >
3124 :                 >skip2016
                       >
3124 : 28              >            plp         ;restore status
                        
3125 : ca                       dex
                                set_a 1,0
                       >            load_flag 0
3126 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3128 : 48              >            pha         ;use stack to load status
3129 : a901            >            lda #1     ;precharge accu
312b : 28              >            plp
                        
312c : 3459                     bit zp1,x   ;41 - should set V (M6) / clear NZ
                                tst_a 1,fv
312e : 08              >            php         ;save flags
312f : c901            >            cmp #1     ;test result
                       >            trap_ne
3131 : f003            >        beq skip2021
                       >        trap            ;failed not equal (non zero)
3133 : 20c740          >        jsr report_error
                       >
3136 :                 >skip2021
                       >
3136 : 68              >            pla         ;load status
3137 : 48              >            pha
                       >            cmp_flag fv
3138 : c970            >            cmp #(fv|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
313a : f003            >        beq skip2024
                       >        trap            ;failed not equal (non zero)
313c : 20c740          >        jsr report_error
                       >
313f :                 >skip2024
                       >
313f : 28              >            plp         ;restore status
                        
3140 : ca                       dex
                                set_a 1,0
                       >            load_flag 0
3141 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3143 : 48              >            pha         ;use stack to load status
3144 : a901            >            lda #1     ;precharge accu
3146 : 28              >            plp
                        
3147 : 3459                     bit zp1,x   ;82 - should set N (M7) & Z / clear V
                                tst_a 1,fnz
3149 : 08              >            php         ;save flags
314a : c901            >            cmp #1     ;test result
                       >            trap_ne
314c : f003            >        beq skip2029
                       >        trap            ;failed not equal (non zero)
314e : 20c740          >        jsr report_error
                       >
3151 :                 >skip2029
                       >
3151 : 68              >            pla         ;load status
3152 : 48              >            pha
                       >            cmp_flag fnz
3153 : c9b2            >            cmp #(fnz|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3155 : f003            >        beq skip2032
                       >        trap            ;failed not equal (non zero)
3157 : 20c740          >        jsr report_error
                       >
315a :                 >skip2032
                       >
315a : 28              >            plp         ;restore status
                        
315b : ca                       dex
                                set_a 1,0
                       >            load_flag 0
315c : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
315e : 48              >            pha         ;use stack to load status
315f : a901            >            lda #1     ;precharge accu
3161 : 28              >            plp
                        
3162 : 3459                     bit zp1,x   ;c3 - should set N (M7) & V (M6) / clear Z
                                tst_a 1,fnv
3164 : 08              >            php         ;save flags
3165 : c901            >            cmp #1     ;test result
                       >            trap_ne
3167 : f003            >        beq skip2037
                       >        trap            ;failed not equal (non zero)
3169 : 20c740          >        jsr report_error
                       >
316c :                 >skip2037
                       >
316c : 68              >            pla         ;load status
316d : 48              >            pha
                       >            cmp_flag fnv
316e : c9f0            >            cmp #(fnv|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3170 : f003            >        beq skip2040
                       >        trap            ;failed not equal (non zero)
3172 : 20c740          >        jsr report_error
                       >
3175 :                 >skip2040
                       >
3175 : 28              >            plp         ;restore status
                        
                                
                                set_a 1,$ff
                       >            load_flag $ff
3176 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3178 : 48              >            pha         ;use stack to load status
3179 : a901            >            lda #1     ;precharge accu
317b : 28              >            plp
                        
317c : 3459                     bit zp1,x   ;c3 - should set N (M7) & V (M6) / clear Z
                                tst_a 1,~fz
317e : 08              >            php         ;save flags
317f : c901            >            cmp #1     ;test result
                       >            trap_ne
3181 : f003            >        beq skip2045
                       >        trap            ;failed not equal (non zero)
3183 : 20c740          >        jsr report_error
                       >
3186 :                 >skip2045
                       >
3186 : 68              >            pla         ;load status
3187 : 48              >            pha
                       >            cmp_flag ~fz
3188 : c9fd            >            cmp #(~fz|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
318a : f003            >        beq skip2048
                       >        trap            ;failed not equal (non zero)
318c : 20c740          >        jsr report_error
                       >
318f :                 >skip2048
                       >
318f : 28              >            plp         ;restore status
                        
3190 : e8                       inx
                                set_a 1,$ff
                       >            load_flag $ff
3191 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3193 : 48              >            pha         ;use stack to load status
3194 : a901            >            lda #1     ;precharge accu
3196 : 28              >            plp
                        
3197 : 3459                     bit zp1,x   ;82 - should set N (M7) & Z / clear V
                                tst_a 1,~fv
3199 : 08              >            php         ;save flags
319a : c901            >            cmp #1     ;test result
                       >            trap_ne
319c : f003            >        beq skip2053
                       >        trap            ;failed not equal (non zero)
319e : 20c740          >        jsr report_error
                       >
31a1 :                 >skip2053
                       >
31a1 : 68              >            pla         ;load status
31a2 : 48              >            pha
                       >            cmp_flag ~fv
31a3 : c9bf            >            cmp #(~fv|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
31a5 : f003            >        beq skip2056
                       >        trap            ;failed not equal (non zero)
31a7 : 20c740          >        jsr report_error
                       >
31aa :                 >skip2056
                       >
31aa : 28              >            plp         ;restore status
                        
31ab : e8                       inx
                                set_a 1,$ff
                       >            load_flag $ff
31ac : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
31ae : 48              >            pha         ;use stack to load status
31af : a901            >            lda #1     ;precharge accu
31b1 : 28              >            plp
                        
31b2 : 3459                     bit zp1,x   ;41 - should set V (M6) / clear NZ
                                tst_a 1,~fnz
31b4 : 08              >            php         ;save flags
31b5 : c901            >            cmp #1     ;test result
                       >            trap_ne
31b7 : f003            >        beq skip2061
                       >        trap            ;failed not equal (non zero)
31b9 : 20c740          >        jsr report_error
                       >
31bc :                 >skip2061
                       >
31bc : 68              >            pla         ;load status
31bd : 48              >            pha
                       >            cmp_flag ~fnz
31be : c97d            >            cmp #(~fnz|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
31c0 : f003            >        beq skip2064
                       >        trap            ;failed not equal (non zero)
31c2 : 20c740          >        jsr report_error
                       >
31c5 :                 >skip2064
                       >
31c5 : 28              >            plp         ;restore status
                        
31c6 : e8                       inx
                                set_a $ff,$ff
                       >            load_flag $ff
31c7 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
31c9 : 48              >            pha         ;use stack to load status
31ca : a9ff            >            lda #$ff     ;precharge accu
31cc : 28              >            plp
                        
31cd : 3459                     bit zp1,x   ;00 - should set Z / clear  NV
                                tst_a $ff,~fnv 
31cf : 08              >            php         ;save flags
31d0 : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
31d2 : f003            >        beq skip2069
                       >        trap            ;failed not equal (non zero)
31d4 : 20c740          >        jsr report_error
                       >
31d7 :                 >skip2069
                       >
31d7 : 68              >            pla         ;load status
31d8 : 48              >            pha
                       >            cmp_flag ~fnv 
31d9 : c93f            >            cmp #(~fnv |fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
31db : f003            >        beq skip2072
                       >        trap            ;failed not equal (non zero)
31dd : 20c740          >        jsr report_error
                       >
31e0 :                 >skip2072
                       >
31e0 : 28              >            plp         ;restore status
                        
                                
                                set_a $ff,0
                       >            load_flag 0
31e1 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
31e3 : 48              >            pha         ;use stack to load status
31e4 : a9ff            >            lda #$ff     ;precharge accu
31e6 : 28              >            plp
                        
31e7 : 3c1011                   bit abs1,x  ;00 - should set Z / clear  NV
                                tst_a $ff,fz 
31ea : 08              >            php         ;save flags
31eb : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
31ed : f003            >        beq skip2077
                       >        trap            ;failed not equal (non zero)
31ef : 20c740          >        jsr report_error
                       >
31f2 :                 >skip2077
                       >
31f2 : 68              >            pla         ;load status
31f3 : 48              >            pha
                       >            cmp_flag fz 
31f4 : c932            >            cmp #(fz |fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
31f6 : f003            >        beq skip2080
                       >        trap            ;failed not equal (non zero)
31f8 : 20c740          >        jsr report_error
                       >
31fb :                 >skip2080
                       >
31fb : 28              >            plp         ;restore status
                        
31fc : ca                       dex
                                set_a 1,0
                       >            load_flag 0
31fd : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
31ff : 48              >            pha         ;use stack to load status
3200 : a901            >            lda #1     ;precharge accu
3202 : 28              >            plp
                        
3203 : 3c1011                   bit abs1,x  ;41 - should set V (M6) / clear NZ
                                tst_a 1,fv
3206 : 08              >            php         ;save flags
3207 : c901            >            cmp #1     ;test result
                       >            trap_ne
3209 : f003            >        beq skip2085
                       >        trap            ;failed not equal (non zero)
320b : 20c740          >        jsr report_error
                       >
320e :                 >skip2085
                       >
320e : 68              >            pla         ;load status
320f : 48              >            pha
                       >            cmp_flag fv
3210 : c970            >            cmp #(fv|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3212 : f003            >        beq skip2088
                       >        trap            ;failed not equal (non zero)
3214 : 20c740          >        jsr report_error
                       >
3217 :                 >skip2088
                       >
3217 : 28              >            plp         ;restore status
                        
3218 : ca                       dex
                                set_a 1,0
                       >            load_flag 0
3219 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
321b : 48              >            pha         ;use stack to load status
321c : a901            >            lda #1     ;precharge accu
321e : 28              >            plp
                        
321f : 3c1011                   bit abs1,x  ;82 - should set N (M7) & Z / clear V
                                tst_a 1,fnz
3222 : 08              >            php         ;save flags
3223 : c901            >            cmp #1     ;test result
                       >            trap_ne
3225 : f003            >        beq skip2093
                       >        trap            ;failed not equal (non zero)
3227 : 20c740          >        jsr report_error
                       >
322a :                 >skip2093
                       >
322a : 68              >            pla         ;load status
322b : 48              >            pha
                       >            cmp_flag fnz
322c : c9b2            >            cmp #(fnz|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
322e : f003            >        beq skip2096
                       >        trap            ;failed not equal (non zero)
3230 : 20c740          >        jsr report_error
                       >
3233 :                 >skip2096
                       >
3233 : 28              >            plp         ;restore status
                        
3234 : ca                       dex
                                set_a 1,0
                       >            load_flag 0
3235 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3237 : 48              >            pha         ;use stack to load status
3238 : a901            >            lda #1     ;precharge accu
323a : 28              >            plp
                        
323b : 3c1011                   bit abs1,x  ;c3 - should set N (M7) & V (M6) / clear Z
                                tst_a 1,fnv
323e : 08              >            php         ;save flags
323f : c901            >            cmp #1     ;test result
                       >            trap_ne
3241 : f003            >        beq skip2101
                       >        trap            ;failed not equal (non zero)
3243 : 20c740          >        jsr report_error
                       >
3246 :                 >skip2101
                       >
3246 : 68              >            pla         ;load status
3247 : 48              >            pha
                       >            cmp_flag fnv
3248 : c9f0            >            cmp #(fnv|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
324a : f003            >        beq skip2104
                       >        trap            ;failed not equal (non zero)
324c : 20c740          >        jsr report_error
                       >
324f :                 >skip2104
                       >
324f : 28              >            plp         ;restore status
                        
                                
                                set_a 1,$ff
                       >            load_flag $ff
3250 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3252 : 48              >            pha         ;use stack to load status
3253 : a901            >            lda #1     ;precharge accu
3255 : 28              >            plp
                        
3256 : 3c1011                   bit abs1,x  ;c3 - should set N (M7) & V (M6) / clear Z
                                tst_a 1,~fz
3259 : 08              >            php         ;save flags
325a : c901            >            cmp #1     ;test result
                       >            trap_ne
325c : f003            >        beq skip2109
                       >        trap            ;failed not equal (non zero)
325e : 20c740          >        jsr report_error
                       >
3261 :                 >skip2109
                       >
3261 : 68              >            pla         ;load status
3262 : 48              >            pha
                       >            cmp_flag ~fz
3263 : c9fd            >            cmp #(~fz|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3265 : f003            >        beq skip2112
                       >        trap            ;failed not equal (non zero)
3267 : 20c740          >        jsr report_error
                       >
326a :                 >skip2112
                       >
326a : 28              >            plp         ;restore status
                        
326b : e8                       inx
                                set_a 1,$ff
                       >            load_flag $ff
326c : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
326e : 48              >            pha         ;use stack to load status
326f : a901            >            lda #1     ;precharge accu
3271 : 28              >            plp
                        
3272 : 3c1011                   bit abs1,x  ;82 - should set N (M7) & Z / clear V
                                tst_a 1,~fv
3275 : 08              >            php         ;save flags
3276 : c901            >            cmp #1     ;test result
                       >            trap_ne
3278 : f003            >        beq skip2117
                       >        trap            ;failed not equal (non zero)
327a : 20c740          >        jsr report_error
                       >
327d :                 >skip2117
                       >
327d : 68              >            pla         ;load status
327e : 48              >            pha
                       >            cmp_flag ~fv
327f : c9bf            >            cmp #(~fv|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3281 : f003            >        beq skip2120
                       >        trap            ;failed not equal (non zero)
3283 : 20c740          >        jsr report_error
                       >
3286 :                 >skip2120
                       >
3286 : 28              >            plp         ;restore status
                        
3287 : e8                       inx
                                set_a 1,$ff
                       >            load_flag $ff
3288 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
328a : 48              >            pha         ;use stack to load status
328b : a901            >            lda #1     ;precharge accu
328d : 28              >            plp
                        
328e : 3c1011                   bit abs1,x  ;41 - should set V (M6) / clear NZ
                                tst_a 1,~fnz
3291 : 08              >            php         ;save flags
3292 : c901            >            cmp #1     ;test result
                       >            trap_ne
3294 : f003            >        beq skip2125
                       >        trap            ;failed not equal (non zero)
3296 : 20c740          >        jsr report_error
                       >
3299 :                 >skip2125
                       >
3299 : 68              >            pla         ;load status
329a : 48              >            pha
                       >            cmp_flag ~fnz
329b : c97d            >            cmp #(~fnz|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
329d : f003            >        beq skip2128
                       >        trap            ;failed not equal (non zero)
329f : 20c740          >        jsr report_error
                       >
32a2 :                 >skip2128
                       >
32a2 : 28              >            plp         ;restore status
                        
32a3 : e8                       inx
                                set_a $ff,$ff
                       >            load_flag $ff
32a4 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
32a6 : 48              >            pha         ;use stack to load status
32a7 : a9ff            >            lda #$ff     ;precharge accu
32a9 : 28              >            plp
                        
32aa : 3c1011                   bit abs1,x  ;00 - should set Z / clear  NV
                                tst_a $ff,~fnv 
32ad : 08              >            php         ;save flags
32ae : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
32b0 : f003            >        beq skip2133
                       >        trap            ;failed not equal (non zero)
32b2 : 20c740          >        jsr report_error
                       >
32b5 :                 >skip2133
                       >
32b5 : 68              >            pla         ;load status
32b6 : 48              >            pha
                       >            cmp_flag ~fnv 
32b7 : c93f            >            cmp #(~fnv |fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
32b9 : f003            >        beq skip2136
                       >        trap            ;failed not equal (non zero)
32bb : 20c740          >        jsr report_error
                       >
32be :                 >skip2136
                       >
32be : 28              >            plp         ;restore status
                        
                                
                                set_a $ff,0
                       >            load_flag 0
32bf : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
32c1 : 48              >            pha         ;use stack to load status
32c2 : a9ff            >            lda #$ff     ;precharge accu
32c4 : 28              >            plp
                        
32c5 : 8900                     bit #$00    ;00 - should set Z
                                tst_a $ff,fz 
32c7 : 08              >            php         ;save flags
32c8 : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
32ca : f003            >        beq skip2141
                       >        trap            ;failed not equal (non zero)
32cc : 20c740          >        jsr report_error
                       >
32cf :                 >skip2141
                       >
32cf : 68              >            pla         ;load status
32d0 : 48              >            pha
                       >            cmp_flag fz 
32d1 : c932            >            cmp #(fz |fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
32d3 : f003            >        beq skip2144
                       >        trap            ;failed not equal (non zero)
32d5 : 20c740          >        jsr report_error
                       >
32d8 :                 >skip2144
                       >
32d8 : 28              >            plp         ;restore status
                        
32d9 : ca                       dex
                                set_a 1,0
                       >            load_flag 0
32da : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
32dc : 48              >            pha         ;use stack to load status
32dd : a901            >            lda #1     ;precharge accu
32df : 28              >            plp
                        
32e0 : 8941                     bit #$41    ;41 - should clear Z
                                tst_a 1,0
32e2 : 08              >            php         ;save flags
32e3 : c901            >            cmp #1     ;test result
                       >            trap_ne
32e5 : f003            >        beq skip2149
                       >        trap            ;failed not equal (non zero)
32e7 : 20c740          >        jsr report_error
                       >
32ea :                 >skip2149
                       >
32ea : 68              >            pla         ;load status
32eb : 48              >            pha
                       >            cmp_flag 0
32ec : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
32ee : f003            >        beq skip2152
                       >        trap            ;failed not equal (non zero)
32f0 : 20c740          >        jsr report_error
                       >
32f3 :                 >skip2152
                       >
32f3 : 28              >            plp         ;restore status
                        
                        ; *** DEBUG INFO ***
                        ; if it fails the previous test and your BIT # has set the V flag
                        ; see http://forum.6502.org/viewtopic.php?f=2&t=2241&p=27243#p27239
                        ; why it shouldn't alter N or V flags on a BIT #
32f4 : ca                       dex
                                set_a 1,0
                       >            load_flag 0
32f5 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
32f7 : 48              >            pha         ;use stack to load status
32f8 : a901            >            lda #1     ;precharge accu
32fa : 28              >            plp
                        
32fb : 8982                     bit #$82    ;82 - should set Z
                                tst_a 1,fz
32fd : 08              >            php         ;save flags
32fe : c901            >            cmp #1     ;test result
                       >            trap_ne
3300 : f003            >        beq skip2157
                       >        trap            ;failed not equal (non zero)
3302 : 20c740          >        jsr report_error
                       >
3305 :                 >skip2157
                       >
3305 : 68              >            pla         ;load status
3306 : 48              >            pha
                       >            cmp_flag fz
3307 : c932            >            cmp #(fz|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3309 : f003            >        beq skip2160
                       >        trap            ;failed not equal (non zero)
330b : 20c740          >        jsr report_error
                       >
330e :                 >skip2160
                       >
330e : 28              >            plp         ;restore status
                        
330f : ca                       dex
                                set_a 1,0
                       >            load_flag 0
3310 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3312 : 48              >            pha         ;use stack to load status
3313 : a901            >            lda #1     ;precharge accu
3315 : 28              >            plp
                        
3316 : 89c3                     bit #$c3    ;c3 - should clear Z
                                tst_a 1,0
3318 : 08              >            php         ;save flags
3319 : c901            >            cmp #1     ;test result
                       >            trap_ne
331b : f003            >        beq skip2165
                       >        trap            ;failed not equal (non zero)
331d : 20c740          >        jsr report_error
                       >
3320 :                 >skip2165
                       >
3320 : 68              >            pla         ;load status
3321 : 48              >            pha
                       >            cmp_flag 0
3322 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3324 : f003            >        beq skip2168
                       >        trap            ;failed not equal (non zero)
3326 : 20c740          >        jsr report_error
                       >
3329 :                 >skip2168
                       >
3329 : 28              >            plp         ;restore status
                        
                                
                                set_a 1,$ff
                       >            load_flag $ff
332a : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
332c : 48              >            pha         ;use stack to load status
332d : a901            >            lda #1     ;precharge accu
332f : 28              >            plp
                        
3330 : 89c3                     bit #$c3    ;c3 - clear Z
                                tst_a 1,~fz
3332 : 08              >            php         ;save flags
3333 : c901            >            cmp #1     ;test result
                       >            trap_ne
3335 : f003            >        beq skip2173
                       >        trap            ;failed not equal (non zero)
3337 : 20c740          >        jsr report_error
                       >
333a :                 >skip2173
                       >
333a : 68              >            pla         ;load status
333b : 48              >            pha
                       >            cmp_flag ~fz
333c : c9fd            >            cmp #(~fz|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
333e : f003            >        beq skip2176
                       >        trap            ;failed not equal (non zero)
3340 : 20c740          >        jsr report_error
                       >
3343 :                 >skip2176
                       >
3343 : 28              >            plp         ;restore status
                        
3344 : e8                       inx
                                set_a 1,$ff
                       >            load_flag $ff
3345 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3347 : 48              >            pha         ;use stack to load status
3348 : a901            >            lda #1     ;precharge accu
334a : 28              >            plp
                        
334b : 8982                     bit #$82    ;82 - should set Z
                                tst_a 1,$ff
334d : 08              >            php         ;save flags
334e : c901            >            cmp #1     ;test result
                       >            trap_ne
3350 : f003            >        beq skip2181
                       >        trap            ;failed not equal (non zero)
3352 : 20c740          >        jsr report_error
                       >
3355 :                 >skip2181
                       >
3355 : 68              >            pla         ;load status
3356 : 48              >            pha
                       >            cmp_flag $ff
3357 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3359 : f003            >        beq skip2184
                       >        trap            ;failed not equal (non zero)
335b : 20c740          >        jsr report_error
                       >
335e :                 >skip2184
                       >
335e : 28              >            plp         ;restore status
                        
335f : e8                       inx
                                set_a 1,$ff
                       >            load_flag $ff
3360 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3362 : 48              >            pha         ;use stack to load status
3363 : a901            >            lda #1     ;precharge accu
3365 : 28              >            plp
                        
3366 : 8941                     bit #$41    ;41 - should clear Z
                                tst_a 1,~fz
3368 : 08              >            php         ;save flags
3369 : c901            >            cmp #1     ;test result
                       >            trap_ne
336b : f003            >        beq skip2189
                       >        trap            ;failed not equal (non zero)
336d : 20c740          >        jsr report_error
                       >
3370 :                 >skip2189
                       >
3370 : 68              >            pla         ;load status
3371 : 48              >            pha
                       >            cmp_flag ~fz
3372 : c9fd            >            cmp #(~fz|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3374 : f003            >        beq skip2192
                       >        trap            ;failed not equal (non zero)
3376 : 20c740          >        jsr report_error
                       >
3379 :                 >skip2192
                       >
3379 : 28              >            plp         ;restore status
                        
337a : e8                       inx
                                set_a $ff,$ff
                       >            load_flag $ff
337b : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
337d : 48              >            pha         ;use stack to load status
337e : a9ff            >            lda #$ff     ;precharge accu
3380 : 28              >            plp
                        
3381 : 8900                     bit #$00   ;00 - should set Z
                                tst_a $ff,$ff
3383 : 08              >            php         ;save flags
3384 : c9ff            >            cmp #$ff     ;test result
                       >            trap_ne
3386 : f003            >        beq skip2197
                       >        trap            ;failed not equal (non zero)
3388 : 20c740          >        jsr report_error
                       >
338b :                 >skip2197
                       >
338b : 68              >            pla         ;load status
338c : 48              >            pha
                       >            cmp_flag $ff
338d : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
338f : f003            >        beq skip2200
                       >        trap            ;failed not equal (non zero)
3391 : 20c740          >        jsr report_error
                       >
3394 :                 >skip2200
                       >
3394 : 28              >            plp         ;restore status
                        
                                
3395 : e003                     cpx #3
                                trap_ne     ;x altered during test
3397 : f003            >        beq skip2202
                       >        trap            ;failed not equal (non zero)
3399 : 20c740          >        jsr report_error
                       >
339c :                 >skip2202
                        
339c : c042                     cpy #$42
                                trap_ne     ;y altered during test 
339e : f003            >        beq skip2204
                       >        trap            ;failed not equal (non zero)
33a0 : 20c740          >        jsr report_error
                       >
33a3 :                 >skip2204
                        
33a3 : ba                       tsx
33a4 : e0ff                     cpx #$ff
                                trap_ne     ;sp push/pop mismatch
33a6 : f003            >        beq skip2206
                       >        trap            ;failed not equal (non zero)
33a8 : 20c740          >        jsr report_error
                       >
33ab :                 >skip2206
                        
                                next_test
33ab : ad0211          >            lda test_case   ;previous test
33ae : c90e            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
33b0 : f003            >        beq skip2209
                       >        trap            ;failed not equal (non zero)
33b2 : 20c740          >        jsr report_error
                       >
33b5 :                 >skip2209
                       >
000f =                 >test_num = test_num + 1
33b5 : a90f            >            lda #test_num   ;*** next tests' number
33b7 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                        ; testing TRB, TSB - zp / abs
                        
                        trbt    macro       ;\1 = memory, \2 = flags   
                                sty \1
                                load_flag \2
                                pha
                                lda zpt+1
                                plp
                                trb \1
                                php
                                cmp zpt+1
                                trap_ne     ;accu was changed
                                pla
                                pha
                                ora #fz     ;mask Z
                                cmp_flag \2|fz
                                trap_ne     ;flags changed except Z
                                pla
                                and #fz
                                cmp zpt+2
                                trap_ne     ;Z flag invalid
                                lda zpt+3
                                cmp zpt
                                trap_ne     ;altered bits in memory wrong       
                                endm
                        
                        tsbt    macro       ;\1 = memory, \2 = flags   
                                sty \1
                                load_flag \2
                                pha
                                lda zpt+1
                                plp
                                tsb \1
                                php
                                cmp zpt+1
                                trap_ne     ;accu was changed
                                pla
                                pha
                                ora #fz     ;mask Z
                                cmp_flag \2|fz
                                trap_ne     ;flags changed except Z
                                pla
                                and #fz
                                cmp zpt+2
                                trap_ne     ;Z flag invalid
                                lda zpt+4
                                cmp zpt
                                trap_ne     ;altered bits in memory wrong        
                                endm
                        
33ba : a2c0                     ldx #$c0
33bc : a000                     ldy #0      ;op1 - memory save
                                ;   zpt     ;op1 - memory modifiable
33be : 6453                     stz zpt+1   ;op2 - accu
                                ;   zpt+2   ;and flags
                                ;   zpt+3   ;memory after reset
                                ;   zpt+4   ;memory after set
                                
33c0 : 98               tbt1    tya
33c1 : 2553                     and zpt+1   ;set Z by anding the 2 operands
33c3 : 08                       php
33c4 : 68                       pla
33c5 : 2902                     and #fz     ;mask Z
33c7 : 8554                     sta zpt+2
33c9 : 98                       tya         ;reset op1 bits by op2
33ca : 49ff                     eor #$ff
33cc : 0553                     ora zpt+1
33ce : 49ff                     eor #$ff
33d0 : 8555                     sta zpt+3
33d2 : 98                       tya         ;set op1 bits by op2
33d3 : 0553                     ora zpt+1
33d5 : 8556                     sta zpt+4
                        
                                trbt zpt,$ff
33d7 : 8452            >        sty zpt
                       >        load_flag $ff
33d9 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
33db : 48              >        pha
33dc : a553            >        lda zpt+1
33de : 28              >        plp
33df : 1452            >        trb zpt
33e1 : 08              >        php
33e2 : c553            >        cmp zpt+1
                       >        trap_ne     ;accu was changed
33e4 : f003            >        beq skip2213
                       >        trap            ;failed not equal (non zero)
33e6 : 20c740          >        jsr report_error
                       >
33e9 :                 >skip2213
                       >
33e9 : 68              >        pla
33ea : 48              >        pha
33eb : 0902            >        ora #fz     ;mask Z
                       >        cmp_flag $ff|fz
33ed : c9ff            >            cmp #($ff|fz|fao)&m8    ;expected flags + always on bits
                       >
                       >        trap_ne     ;flags changed except Z
33ef : f003            >        beq skip2216
                       >        trap            ;failed not equal (non zero)
33f1 : 20c740          >        jsr report_error
                       >
33f4 :                 >skip2216
                       >
33f4 : 68              >        pla
33f5 : 2902            >        and #fz
33f7 : c554            >        cmp zpt+2
                       >        trap_ne     ;Z flag invalid
33f9 : f003            >        beq skip2218
                       >        trap            ;failed not equal (non zero)
33fb : 20c740          >        jsr report_error
                       >
33fe :                 >skip2218
                       >
33fe : a555            >        lda zpt+3
3400 : c552            >        cmp zpt
                       >        trap_ne     ;altered bits in memory wrong       
3402 : f003            >        beq skip2220
                       >        trap            ;failed not equal (non zero)
3404 : 20c740          >        jsr report_error
                       >
3407 :                 >skip2220
                       >
                        
                                trbt abst,$ff
3407 : 8c0511          >        sty abst
                       >        load_flag $ff
340a : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
340c : 48              >        pha
340d : a553            >        lda zpt+1
340f : 28              >        plp
3410 : 1c0511          >        trb abst
3413 : 08              >        php
3414 : c553            >        cmp zpt+1
                       >        trap_ne     ;accu was changed
3416 : f003            >        beq skip2224
                       >        trap            ;failed not equal (non zero)
3418 : 20c740          >        jsr report_error
                       >
341b :                 >skip2224
                       >
341b : 68              >        pla
341c : 48              >        pha
341d : 0902            >        ora #fz     ;mask Z
                       >        cmp_flag $ff|fz
341f : c9ff            >            cmp #($ff|fz|fao)&m8    ;expected flags + always on bits
                       >
                       >        trap_ne     ;flags changed except Z
3421 : f003            >        beq skip2227
                       >        trap            ;failed not equal (non zero)
3423 : 20c740          >        jsr report_error
                       >
3426 :                 >skip2227
                       >
3426 : 68              >        pla
3427 : 2902            >        and #fz
3429 : c554            >        cmp zpt+2
                       >        trap_ne     ;Z flag invalid
342b : f003            >        beq skip2229
                       >        trap            ;failed not equal (non zero)
342d : 20c740          >        jsr report_error
                       >
3430 :                 >skip2229
                       >
3430 : a555            >        lda zpt+3
3432 : c552            >        cmp zpt
                       >        trap_ne     ;altered bits in memory wrong       
3434 : f003            >        beq skip2231
                       >        trap            ;failed not equal (non zero)
3436 : 20c740          >        jsr report_error
                       >
3439 :                 >skip2231
                       >
                        
                                trbt zpt,0
3439 : 8452            >        sty zpt
                       >        load_flag 0
343b : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
343d : 48              >        pha
343e : a553            >        lda zpt+1
3440 : 28              >        plp
3441 : 1452            >        trb zpt
3443 : 08              >        php
3444 : c553            >        cmp zpt+1
                       >        trap_ne     ;accu was changed
3446 : f003            >        beq skip2235
                       >        trap            ;failed not equal (non zero)
3448 : 20c740          >        jsr report_error
                       >
344b :                 >skip2235
                       >
344b : 68              >        pla
344c : 48              >        pha
344d : 0902            >        ora #fz     ;mask Z
                       >        cmp_flag 0|fz
344f : c932            >            cmp #(0|fz|fao)&m8    ;expected flags + always on bits
                       >
                       >        trap_ne     ;flags changed except Z
3451 : f003            >        beq skip2238
                       >        trap            ;failed not equal (non zero)
3453 : 20c740          >        jsr report_error
                       >
3456 :                 >skip2238
                       >
3456 : 68              >        pla
3457 : 2902            >        and #fz
3459 : c554            >        cmp zpt+2
                       >        trap_ne     ;Z flag invalid
345b : f003            >        beq skip2240
                       >        trap            ;failed not equal (non zero)
345d : 20c740          >        jsr report_error
                       >
3460 :                 >skip2240
                       >
3460 : a555            >        lda zpt+3
3462 : c552            >        cmp zpt
                       >        trap_ne     ;altered bits in memory wrong       
3464 : f003            >        beq skip2242
                       >        trap            ;failed not equal (non zero)
3466 : 20c740          >        jsr report_error
                       >
3469 :                 >skip2242
                       >
                        
                                trbt abst,0
3469 : 8c0511          >        sty abst
                       >        load_flag 0
346c : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
346e : 48              >        pha
346f : a553            >        lda zpt+1
3471 : 28              >        plp
3472 : 1c0511          >        trb abst
3475 : 08              >        php
3476 : c553            >        cmp zpt+1
                       >        trap_ne     ;accu was changed
3478 : f003            >        beq skip2246
                       >        trap            ;failed not equal (non zero)
347a : 20c740          >        jsr report_error
                       >
347d :                 >skip2246
                       >
347d : 68              >        pla
347e : 48              >        pha
347f : 0902            >        ora #fz     ;mask Z
                       >        cmp_flag 0|fz
3481 : c932            >            cmp #(0|fz|fao)&m8    ;expected flags + always on bits
                       >
                       >        trap_ne     ;flags changed except Z
3483 : f003            >        beq skip2249
                       >        trap            ;failed not equal (non zero)
3485 : 20c740          >        jsr report_error
                       >
3488 :                 >skip2249
                       >
3488 : 68              >        pla
3489 : 2902            >        and #fz
348b : c554            >        cmp zpt+2
                       >        trap_ne     ;Z flag invalid
348d : f003            >        beq skip2251
                       >        trap            ;failed not equal (non zero)
348f : 20c740          >        jsr report_error
                       >
3492 :                 >skip2251
                       >
3492 : a555            >        lda zpt+3
3494 : c552            >        cmp zpt
                       >        trap_ne     ;altered bits in memory wrong       
3496 : f003            >        beq skip2253
                       >        trap            ;failed not equal (non zero)
3498 : 20c740          >        jsr report_error
                       >
349b :                 >skip2253
                       >
                        
                                tsbt zpt,$ff
349b : 8452            >        sty zpt
                       >        load_flag $ff
349d : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
349f : 48              >        pha
34a0 : a553            >        lda zpt+1
34a2 : 28              >        plp
34a3 : 0452            >        tsb zpt
34a5 : 08              >        php
34a6 : c553            >        cmp zpt+1
                       >        trap_ne     ;accu was changed
34a8 : f003            >        beq skip2257
                       >        trap            ;failed not equal (non zero)
34aa : 20c740          >        jsr report_error
                       >
34ad :                 >skip2257
                       >
34ad : 68              >        pla
34ae : 48              >        pha
34af : 0902            >        ora #fz     ;mask Z
                       >        cmp_flag $ff|fz
34b1 : c9ff            >            cmp #($ff|fz|fao)&m8    ;expected flags + always on bits
                       >
                       >        trap_ne     ;flags changed except Z
34b3 : f003            >        beq skip2260
                       >        trap            ;failed not equal (non zero)
34b5 : 20c740          >        jsr report_error
                       >
34b8 :                 >skip2260
                       >
34b8 : 68              >        pla
34b9 : 2902            >        and #fz
34bb : c554            >        cmp zpt+2
                       >        trap_ne     ;Z flag invalid
34bd : f003            >        beq skip2262
                       >        trap            ;failed not equal (non zero)
34bf : 20c740          >        jsr report_error
                       >
34c2 :                 >skip2262
                       >
34c2 : a556            >        lda zpt+4
34c4 : c552            >        cmp zpt
                       >        trap_ne     ;altered bits in memory wrong        
34c6 : f003            >        beq skip2264
                       >        trap            ;failed not equal (non zero)
34c8 : 20c740          >        jsr report_error
                       >
34cb :                 >skip2264
                       >
                        
                                tsbt abst,$ff
34cb : 8c0511          >        sty abst
                       >        load_flag $ff
34ce : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
34d0 : 48              >        pha
34d1 : a553            >        lda zpt+1
34d3 : 28              >        plp
34d4 : 0c0511          >        tsb abst
34d7 : 08              >        php
34d8 : c553            >        cmp zpt+1
                       >        trap_ne     ;accu was changed
34da : f003            >        beq skip2268
                       >        trap            ;failed not equal (non zero)
34dc : 20c740          >        jsr report_error
                       >
34df :                 >skip2268
                       >
34df : 68              >        pla
34e0 : 48              >        pha
34e1 : 0902            >        ora #fz     ;mask Z
                       >        cmp_flag $ff|fz
34e3 : c9ff            >            cmp #($ff|fz|fao)&m8    ;expected flags + always on bits
                       >
                       >        trap_ne     ;flags changed except Z
34e5 : f003            >        beq skip2271
                       >        trap            ;failed not equal (non zero)
34e7 : 20c740          >        jsr report_error
                       >
34ea :                 >skip2271
                       >
34ea : 68              >        pla
34eb : 2902            >        and #fz
34ed : c554            >        cmp zpt+2
                       >        trap_ne     ;Z flag invalid
34ef : f003            >        beq skip2273
                       >        trap            ;failed not equal (non zero)
34f1 : 20c740          >        jsr report_error
                       >
34f4 :                 >skip2273
                       >
34f4 : a556            >        lda zpt+4
34f6 : c552            >        cmp zpt
                       >        trap_ne     ;altered bits in memory wrong        
34f8 : f003            >        beq skip2275
                       >        trap            ;failed not equal (non zero)
34fa : 20c740          >        jsr report_error
                       >
34fd :                 >skip2275
                       >
                        
                                tsbt zpt,0
34fd : 8452            >        sty zpt
                       >        load_flag 0
34ff : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3501 : 48              >        pha
3502 : a553            >        lda zpt+1
3504 : 28              >        plp
3505 : 0452            >        tsb zpt
3507 : 08              >        php
3508 : c553            >        cmp zpt+1
                       >        trap_ne     ;accu was changed
350a : f003            >        beq skip2279
                       >        trap            ;failed not equal (non zero)
350c : 20c740          >        jsr report_error
                       >
350f :                 >skip2279
                       >
350f : 68              >        pla
3510 : 48              >        pha
3511 : 0902            >        ora #fz     ;mask Z
                       >        cmp_flag 0|fz
3513 : c932            >            cmp #(0|fz|fao)&m8    ;expected flags + always on bits
                       >
                       >        trap_ne     ;flags changed except Z
3515 : f003            >        beq skip2282
                       >        trap            ;failed not equal (non zero)
3517 : 20c740          >        jsr report_error
                       >
351a :                 >skip2282
                       >
351a : 68              >        pla
351b : 2902            >        and #fz
351d : c554            >        cmp zpt+2
                       >        trap_ne     ;Z flag invalid
351f : f003            >        beq skip2284
                       >        trap            ;failed not equal (non zero)
3521 : 20c740          >        jsr report_error
                       >
3524 :                 >skip2284
                       >
3524 : a556            >        lda zpt+4
3526 : c552            >        cmp zpt
                       >        trap_ne     ;altered bits in memory wrong        
3528 : f003            >        beq skip2286
                       >        trap            ;failed not equal (non zero)
352a : 20c740          >        jsr report_error
                       >
352d :                 >skip2286
                       >
                        
                                tsbt abst,0
352d : 8c0511          >        sty abst
                       >        load_flag 0
3530 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3532 : 48              >        pha
3533 : a553            >        lda zpt+1
3535 : 28              >        plp
3536 : 0c0511          >        tsb abst
3539 : 08              >        php
353a : c553            >        cmp zpt+1
                       >        trap_ne     ;accu was changed
353c : f003            >        beq skip2290
                       >        trap            ;failed not equal (non zero)
353e : 20c740          >        jsr report_error
                       >
3541 :                 >skip2290
                       >
3541 : 68              >        pla
3542 : 48              >        pha
3543 : 0902            >        ora #fz     ;mask Z
                       >        cmp_flag 0|fz
3545 : c932            >            cmp #(0|fz|fao)&m8    ;expected flags + always on bits
                       >
                       >        trap_ne     ;flags changed except Z
3547 : f003            >        beq skip2293
                       >        trap            ;failed not equal (non zero)
3549 : 20c740          >        jsr report_error
                       >
354c :                 >skip2293
                       >
354c : 68              >        pla
354d : 2902            >        and #fz
354f : c554            >        cmp zpt+2
                       >        trap_ne     ;Z flag invalid
3551 : f003            >        beq skip2295
                       >        trap            ;failed not equal (non zero)
3553 : 20c740          >        jsr report_error
                       >
3556 :                 >skip2295
                       >
3556 : a556            >        lda zpt+4
3558 : c552            >        cmp zpt
                       >        trap_ne     ;altered bits in memory wrong        
355a : f003            >        beq skip2297
                       >        trap            ;failed not equal (non zero)
355c : 20c740          >        jsr report_error
                       >
355f :                 >skip2297
                       >
                        
                                
355f : c8                       iny         ;iterate op1
3560 : d004                     bne tbt3
3562 : e653                     inc zpt+1   ;iterate op2
3564 : f003                     beq tbt2
3566 : 4cc033           tbt3    jmp tbt1        
3569 :                  tbt2
3569 : e0c0                     cpx #$c0
                                trap_ne     ;x altered during test
356b : f003            >        beq skip2299
                       >        trap            ;failed not equal (non zero)
356d : 20c740          >        jsr report_error
                       >
3570 :                 >skip2299
                        
3570 : ba                       tsx
3571 : e0ff                     cpx #$ff
                                trap_ne     ;sp push/pop mismatch
3573 : f003            >        beq skip2301
                       >        trap            ;failed not equal (non zero)
3575 : 20c740          >        jsr report_error
                       >
3578 :                 >skip2301
                        
                                next_test    
3578 : ad0211          >            lda test_case   ;previous test
357b : c90f            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
357d : f003            >        beq skip2304
                       >        trap            ;failed not equal (non zero)
357f : 20c740          >        jsr report_error
                       >
3582 :                 >skip2304
                       >
0010 =                 >test_num = test_num + 1
3582 : a910            >            lda #test_num   ;*** next tests' number
3584 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                            if rkwl_wdc_op = 1
                        ; testing RMB, SMB - zp
                        rmbt    macro       ;\1 = bitnum
                                lda #$ff
                                sta zpt
                                set_a $a5,0
                                rmb \1,zpt
                                tst_a $a5,0
                                lda zpt
                                cmp #$ff-(1<<\1)
                                trap_ne     ;wrong bits set or cleared
                                lda #1<<\1
                                sta zpt
                                set_a $5a,$ff
                                rmb \1,zpt
                                tst_a $5a,$ff
                                lda zpt
                                trap_ne     ;wrong bits set or cleared
                                endm
                        smbt    macro       ;\1 = bitnum
                                lda #$ff-(1<<\1)
                                sta zpt
                                set_a $a5,0
                                smb \1,zpt
                                tst_a $a5,0
                                lda zpt
                                cmp #$ff
                                trap_ne     ;wrong bits set or cleared
                                lda #0
                                sta zpt
                                set_a $5a,$ff
                                smb \1,zpt
                                tst_a $5a,$ff
                                lda zpt
                                cmp #1<<\1
                                trap_ne     ;wrong bits set or cleared
                                endm
                        
3587 : a2ba                     ldx #$ba    ;protect x & y
3589 : a0d0                     ldy #$d0
                                rmbt 0
358b : a9ff            >        lda #$ff
358d : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
358f : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3591 : 48              >            pha         ;use stack to load status
3592 : a9a5            >            lda #$a5     ;precharge accu
3594 : 28              >            plp
                       >
3595 : 0752            >        rmb 0,zpt
                       >        tst_a $a5,0
3597 : 08              >            php         ;save flags
3598 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
359a : f003            >        beq skip2310
                       >        trap            ;failed not equal (non zero)
359c : 20c740          >        jsr report_error
                       >
359f :                 >skip2310
                       >
359f : 68              >            pla         ;load status
35a0 : 48              >            pha
                       >            cmp_flag 0
35a1 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
35a3 : f003            >        beq skip2313
                       >        trap            ;failed not equal (non zero)
35a5 : 20c740          >        jsr report_error
                       >
35a8 :                 >skip2313
                       >
35a8 : 28              >            plp         ;restore status
                       >
35a9 : a552            >        lda zpt
35ab : c9fe            >        cmp #$ff-(1<<0)
                       >        trap_ne     ;wrong bits set or cleared
35ad : f003            >        beq skip2315
                       >        trap            ;failed not equal (non zero)
35af : 20c740          >        jsr report_error
                       >
35b2 :                 >skip2315
                       >
35b2 : a901            >        lda #1<<0
35b4 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
35b6 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
35b8 : 48              >            pha         ;use stack to load status
35b9 : a95a            >            lda #$5a     ;precharge accu
35bb : 28              >            plp
                       >
35bc : 0752            >        rmb 0,zpt
                       >        tst_a $5a,$ff
35be : 08              >            php         ;save flags
35bf : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
35c1 : f003            >        beq skip2320
                       >        trap            ;failed not equal (non zero)
35c3 : 20c740          >        jsr report_error
                       >
35c6 :                 >skip2320
                       >
35c6 : 68              >            pla         ;load status
35c7 : 48              >            pha
                       >            cmp_flag $ff
35c8 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
35ca : f003            >        beq skip2323
                       >        trap            ;failed not equal (non zero)
35cc : 20c740          >        jsr report_error
                       >
35cf :                 >skip2323
                       >
35cf : 28              >            plp         ;restore status
                       >
35d0 : a552            >        lda zpt
                       >        trap_ne     ;wrong bits set or cleared
35d2 : f003            >        beq skip2325
                       >        trap            ;failed not equal (non zero)
35d4 : 20c740          >        jsr report_error
                       >
35d7 :                 >skip2325
                       >
                        
                                rmbt 1
35d7 : a9ff            >        lda #$ff
35d9 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
35db : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
35dd : 48              >            pha         ;use stack to load status
35de : a9a5            >            lda #$a5     ;precharge accu
35e0 : 28              >            plp
                       >
35e1 : 1752            >        rmb 1,zpt
                       >        tst_a $a5,0
35e3 : 08              >            php         ;save flags
35e4 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
35e6 : f003            >        beq skip2331
                       >        trap            ;failed not equal (non zero)
35e8 : 20c740          >        jsr report_error
                       >
35eb :                 >skip2331
                       >
35eb : 68              >            pla         ;load status
35ec : 48              >            pha
                       >            cmp_flag 0
35ed : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
35ef : f003            >        beq skip2334
                       >        trap            ;failed not equal (non zero)
35f1 : 20c740          >        jsr report_error
                       >
35f4 :                 >skip2334
                       >
35f4 : 28              >            plp         ;restore status
                       >
35f5 : a552            >        lda zpt
35f7 : c9fd            >        cmp #$ff-(1<<1)
                       >        trap_ne     ;wrong bits set or cleared
35f9 : f003            >        beq skip2336
                       >        trap            ;failed not equal (non zero)
35fb : 20c740          >        jsr report_error
                       >
35fe :                 >skip2336
                       >
35fe : a902            >        lda #1<<1
3600 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
3602 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3604 : 48              >            pha         ;use stack to load status
3605 : a95a            >            lda #$5a     ;precharge accu
3607 : 28              >            plp
                       >
3608 : 1752            >        rmb 1,zpt
                       >        tst_a $5a,$ff
360a : 08              >            php         ;save flags
360b : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
360d : f003            >        beq skip2341
                       >        trap            ;failed not equal (non zero)
360f : 20c740          >        jsr report_error
                       >
3612 :                 >skip2341
                       >
3612 : 68              >            pla         ;load status
3613 : 48              >            pha
                       >            cmp_flag $ff
3614 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3616 : f003            >        beq skip2344
                       >        trap            ;failed not equal (non zero)
3618 : 20c740          >        jsr report_error
                       >
361b :                 >skip2344
                       >
361b : 28              >            plp         ;restore status
                       >
361c : a552            >        lda zpt
                       >        trap_ne     ;wrong bits set or cleared
361e : f003            >        beq skip2346
                       >        trap            ;failed not equal (non zero)
3620 : 20c740          >        jsr report_error
                       >
3623 :                 >skip2346
                       >
                        
                                rmbt 2
3623 : a9ff            >        lda #$ff
3625 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
3627 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3629 : 48              >            pha         ;use stack to load status
362a : a9a5            >            lda #$a5     ;precharge accu
362c : 28              >            plp
                       >
362d : 2752            >        rmb 2,zpt
                       >        tst_a $a5,0
362f : 08              >            php         ;save flags
3630 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
3632 : f003            >        beq skip2352
                       >        trap            ;failed not equal (non zero)
3634 : 20c740          >        jsr report_error
                       >
3637 :                 >skip2352
                       >
3637 : 68              >            pla         ;load status
3638 : 48              >            pha
                       >            cmp_flag 0
3639 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
363b : f003            >        beq skip2355
                       >        trap            ;failed not equal (non zero)
363d : 20c740          >        jsr report_error
                       >
3640 :                 >skip2355
                       >
3640 : 28              >            plp         ;restore status
                       >
3641 : a552            >        lda zpt
3643 : c9fb            >        cmp #$ff-(1<<2)
                       >        trap_ne     ;wrong bits set or cleared
3645 : f003            >        beq skip2357
                       >        trap            ;failed not equal (non zero)
3647 : 20c740          >        jsr report_error
                       >
364a :                 >skip2357
                       >
364a : a904            >        lda #1<<2
364c : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
364e : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3650 : 48              >            pha         ;use stack to load status
3651 : a95a            >            lda #$5a     ;precharge accu
3653 : 28              >            plp
                       >
3654 : 2752            >        rmb 2,zpt
                       >        tst_a $5a,$ff
3656 : 08              >            php         ;save flags
3657 : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
3659 : f003            >        beq skip2362
                       >        trap            ;failed not equal (non zero)
365b : 20c740          >        jsr report_error
                       >
365e :                 >skip2362
                       >
365e : 68              >            pla         ;load status
365f : 48              >            pha
                       >            cmp_flag $ff
3660 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3662 : f003            >        beq skip2365
                       >        trap            ;failed not equal (non zero)
3664 : 20c740          >        jsr report_error
                       >
3667 :                 >skip2365
                       >
3667 : 28              >            plp         ;restore status
                       >
3668 : a552            >        lda zpt
                       >        trap_ne     ;wrong bits set or cleared
366a : f003            >        beq skip2367
                       >        trap            ;failed not equal (non zero)
366c : 20c740          >        jsr report_error
                       >
366f :                 >skip2367
                       >
                        
                                rmbt 3
366f : a9ff            >        lda #$ff
3671 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
3673 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3675 : 48              >            pha         ;use stack to load status
3676 : a9a5            >            lda #$a5     ;precharge accu
3678 : 28              >            plp
                       >
3679 : 3752            >        rmb 3,zpt
                       >        tst_a $a5,0
367b : 08              >            php         ;save flags
367c : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
367e : f003            >        beq skip2373
                       >        trap            ;failed not equal (non zero)
3680 : 20c740          >        jsr report_error
                       >
3683 :                 >skip2373
                       >
3683 : 68              >            pla         ;load status
3684 : 48              >            pha
                       >            cmp_flag 0
3685 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3687 : f003            >        beq skip2376
                       >        trap            ;failed not equal (non zero)
3689 : 20c740          >        jsr report_error
                       >
368c :                 >skip2376
                       >
368c : 28              >            plp         ;restore status
                       >
368d : a552            >        lda zpt
368f : c9f7            >        cmp #$ff-(1<<3)
                       >        trap_ne     ;wrong bits set or cleared
3691 : f003            >        beq skip2378
                       >        trap            ;failed not equal (non zero)
3693 : 20c740          >        jsr report_error
                       >
3696 :                 >skip2378
                       >
3696 : a908            >        lda #1<<3
3698 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
369a : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
369c : 48              >            pha         ;use stack to load status
369d : a95a            >            lda #$5a     ;precharge accu
369f : 28              >            plp
                       >
36a0 : 3752            >        rmb 3,zpt
                       >        tst_a $5a,$ff
36a2 : 08              >            php         ;save flags
36a3 : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
36a5 : f003            >        beq skip2383
                       >        trap            ;failed not equal (non zero)
36a7 : 20c740          >        jsr report_error
                       >
36aa :                 >skip2383
                       >
36aa : 68              >            pla         ;load status
36ab : 48              >            pha
                       >            cmp_flag $ff
36ac : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
36ae : f003            >        beq skip2386
                       >        trap            ;failed not equal (non zero)
36b0 : 20c740          >        jsr report_error
                       >
36b3 :                 >skip2386
                       >
36b3 : 28              >            plp         ;restore status
                       >
36b4 : a552            >        lda zpt
                       >        trap_ne     ;wrong bits set or cleared
36b6 : f003            >        beq skip2388
                       >        trap            ;failed not equal (non zero)
36b8 : 20c740          >        jsr report_error
                       >
36bb :                 >skip2388
                       >
                        
                                rmbt 4
36bb : a9ff            >        lda #$ff
36bd : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
36bf : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
36c1 : 48              >            pha         ;use stack to load status
36c2 : a9a5            >            lda #$a5     ;precharge accu
36c4 : 28              >            plp
                       >
36c5 : 4752            >        rmb 4,zpt
                       >        tst_a $a5,0
36c7 : 08              >            php         ;save flags
36c8 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
36ca : f003            >        beq skip2394
                       >        trap            ;failed not equal (non zero)
36cc : 20c740          >        jsr report_error
                       >
36cf :                 >skip2394
                       >
36cf : 68              >            pla         ;load status
36d0 : 48              >            pha
                       >            cmp_flag 0
36d1 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
36d3 : f003            >        beq skip2397
                       >        trap            ;failed not equal (non zero)
36d5 : 20c740          >        jsr report_error
                       >
36d8 :                 >skip2397
                       >
36d8 : 28              >            plp         ;restore status
                       >
36d9 : a552            >        lda zpt
36db : c9ef            >        cmp #$ff-(1<<4)
                       >        trap_ne     ;wrong bits set or cleared
36dd : f003            >        beq skip2399
                       >        trap            ;failed not equal (non zero)
36df : 20c740          >        jsr report_error
                       >
36e2 :                 >skip2399
                       >
36e2 : a910            >        lda #1<<4
36e4 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
36e6 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
36e8 : 48              >            pha         ;use stack to load status
36e9 : a95a            >            lda #$5a     ;precharge accu
36eb : 28              >            plp
                       >
36ec : 4752            >        rmb 4,zpt
                       >        tst_a $5a,$ff
36ee : 08              >            php         ;save flags
36ef : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
36f1 : f003            >        beq skip2404
                       >        trap            ;failed not equal (non zero)
36f3 : 20c740          >        jsr report_error
                       >
36f6 :                 >skip2404
                       >
36f6 : 68              >            pla         ;load status
36f7 : 48              >            pha
                       >            cmp_flag $ff
36f8 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
36fa : f003            >        beq skip2407
                       >        trap            ;failed not equal (non zero)
36fc : 20c740          >        jsr report_error
                       >
36ff :                 >skip2407
                       >
36ff : 28              >            plp         ;restore status
                       >
3700 : a552            >        lda zpt
                       >        trap_ne     ;wrong bits set or cleared
3702 : f003            >        beq skip2409
                       >        trap            ;failed not equal (non zero)
3704 : 20c740          >        jsr report_error
                       >
3707 :                 >skip2409
                       >
                        
                                rmbt 5
3707 : a9ff            >        lda #$ff
3709 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
370b : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
370d : 48              >            pha         ;use stack to load status
370e : a9a5            >            lda #$a5     ;precharge accu
3710 : 28              >            plp
                       >
3711 : 5752            >        rmb 5,zpt
                       >        tst_a $a5,0
3713 : 08              >            php         ;save flags
3714 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
3716 : f003            >        beq skip2415
                       >        trap            ;failed not equal (non zero)
3718 : 20c740          >        jsr report_error
                       >
371b :                 >skip2415
                       >
371b : 68              >            pla         ;load status
371c : 48              >            pha
                       >            cmp_flag 0
371d : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
371f : f003            >        beq skip2418
                       >        trap            ;failed not equal (non zero)
3721 : 20c740          >        jsr report_error
                       >
3724 :                 >skip2418
                       >
3724 : 28              >            plp         ;restore status
                       >
3725 : a552            >        lda zpt
3727 : c9df            >        cmp #$ff-(1<<5)
                       >        trap_ne     ;wrong bits set or cleared
3729 : f003            >        beq skip2420
                       >        trap            ;failed not equal (non zero)
372b : 20c740          >        jsr report_error
                       >
372e :                 >skip2420
                       >
372e : a920            >        lda #1<<5
3730 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
3732 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3734 : 48              >            pha         ;use stack to load status
3735 : a95a            >            lda #$5a     ;precharge accu
3737 : 28              >            plp
                       >
3738 : 5752            >        rmb 5,zpt
                       >        tst_a $5a,$ff
373a : 08              >            php         ;save flags
373b : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
373d : f003            >        beq skip2425
                       >        trap            ;failed not equal (non zero)
373f : 20c740          >        jsr report_error
                       >
3742 :                 >skip2425
                       >
3742 : 68              >            pla         ;load status
3743 : 48              >            pha
                       >            cmp_flag $ff
3744 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3746 : f003            >        beq skip2428
                       >        trap            ;failed not equal (non zero)
3748 : 20c740          >        jsr report_error
                       >
374b :                 >skip2428
                       >
374b : 28              >            plp         ;restore status
                       >
374c : a552            >        lda zpt
                       >        trap_ne     ;wrong bits set or cleared
374e : f003            >        beq skip2430
                       >        trap            ;failed not equal (non zero)
3750 : 20c740          >        jsr report_error
                       >
3753 :                 >skip2430
                       >
                        
                                rmbt 6
3753 : a9ff            >        lda #$ff
3755 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
3757 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3759 : 48              >            pha         ;use stack to load status
375a : a9a5            >            lda #$a5     ;precharge accu
375c : 28              >            plp
                       >
375d : 6752            >        rmb 6,zpt
                       >        tst_a $a5,0
375f : 08              >            php         ;save flags
3760 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
3762 : f003            >        beq skip2436
                       >        trap            ;failed not equal (non zero)
3764 : 20c740          >        jsr report_error
                       >
3767 :                 >skip2436
                       >
3767 : 68              >            pla         ;load status
3768 : 48              >            pha
                       >            cmp_flag 0
3769 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
376b : f003            >        beq skip2439
                       >        trap            ;failed not equal (non zero)
376d : 20c740          >        jsr report_error
                       >
3770 :                 >skip2439
                       >
3770 : 28              >            plp         ;restore status
                       >
3771 : a552            >        lda zpt
3773 : c9bf            >        cmp #$ff-(1<<6)
                       >        trap_ne     ;wrong bits set or cleared
3775 : f003            >        beq skip2441
                       >        trap            ;failed not equal (non zero)
3777 : 20c740          >        jsr report_error
                       >
377a :                 >skip2441
                       >
377a : a940            >        lda #1<<6
377c : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
377e : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3780 : 48              >            pha         ;use stack to load status
3781 : a95a            >            lda #$5a     ;precharge accu
3783 : 28              >            plp
                       >
3784 : 6752            >        rmb 6,zpt
                       >        tst_a $5a,$ff
3786 : 08              >            php         ;save flags
3787 : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
3789 : f003            >        beq skip2446
                       >        trap            ;failed not equal (non zero)
378b : 20c740          >        jsr report_error
                       >
378e :                 >skip2446
                       >
378e : 68              >            pla         ;load status
378f : 48              >            pha
                       >            cmp_flag $ff
3790 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3792 : f003            >        beq skip2449
                       >        trap            ;failed not equal (non zero)
3794 : 20c740          >        jsr report_error
                       >
3797 :                 >skip2449
                       >
3797 : 28              >            plp         ;restore status
                       >
3798 : a552            >        lda zpt
                       >        trap_ne     ;wrong bits set or cleared
379a : f003            >        beq skip2451
                       >        trap            ;failed not equal (non zero)
379c : 20c740          >        jsr report_error
                       >
379f :                 >skip2451
                       >
                        
                                rmbt 7
379f : a9ff            >        lda #$ff
37a1 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
37a3 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
37a5 : 48              >            pha         ;use stack to load status
37a6 : a9a5            >            lda #$a5     ;precharge accu
37a8 : 28              >            plp
                       >
37a9 : 7752            >        rmb 7,zpt
                       >        tst_a $a5,0
37ab : 08              >            php         ;save flags
37ac : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
37ae : f003            >        beq skip2457
                       >        trap            ;failed not equal (non zero)
37b0 : 20c740          >        jsr report_error
                       >
37b3 :                 >skip2457
                       >
37b3 : 68              >            pla         ;load status
37b4 : 48              >            pha
                       >            cmp_flag 0
37b5 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
37b7 : f003            >        beq skip2460
                       >        trap            ;failed not equal (non zero)
37b9 : 20c740          >        jsr report_error
                       >
37bc :                 >skip2460
                       >
37bc : 28              >            plp         ;restore status
                       >
37bd : a552            >        lda zpt
37bf : c97f            >        cmp #$ff-(1<<7)
                       >        trap_ne     ;wrong bits set or cleared
37c1 : f003            >        beq skip2462
                       >        trap            ;failed not equal (non zero)
37c3 : 20c740          >        jsr report_error
                       >
37c6 :                 >skip2462
                       >
37c6 : a980            >        lda #1<<7
37c8 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
37ca : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
37cc : 48              >            pha         ;use stack to load status
37cd : a95a            >            lda #$5a     ;precharge accu
37cf : 28              >            plp
                       >
37d0 : 7752            >        rmb 7,zpt
                       >        tst_a $5a,$ff
37d2 : 08              >            php         ;save flags
37d3 : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
37d5 : f003            >        beq skip2467
                       >        trap            ;failed not equal (non zero)
37d7 : 20c740          >        jsr report_error
                       >
37da :                 >skip2467
                       >
37da : 68              >            pla         ;load status
37db : 48              >            pha
                       >            cmp_flag $ff
37dc : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
37de : f003            >        beq skip2470
                       >        trap            ;failed not equal (non zero)
37e0 : 20c740          >        jsr report_error
                       >
37e3 :                 >skip2470
                       >
37e3 : 28              >            plp         ;restore status
                       >
37e4 : a552            >        lda zpt
                       >        trap_ne     ;wrong bits set or cleared
37e6 : f003            >        beq skip2472
                       >        trap            ;failed not equal (non zero)
37e8 : 20c740          >        jsr report_error
                       >
37eb :                 >skip2472
                       >
                        
                                smbt 0
37eb : a9fe            >        lda #$ff-(1<<0)
37ed : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
37ef : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
37f1 : 48              >            pha         ;use stack to load status
37f2 : a9a5            >            lda #$a5     ;precharge accu
37f4 : 28              >            plp
                       >
37f5 : 8752            >        smb 0,zpt
                       >        tst_a $a5,0
37f7 : 08              >            php         ;save flags
37f8 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
37fa : f003            >        beq skip2478
                       >        trap            ;failed not equal (non zero)
37fc : 20c740          >        jsr report_error
                       >
37ff :                 >skip2478
                       >
37ff : 68              >            pla         ;load status
3800 : 48              >            pha
                       >            cmp_flag 0
3801 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3803 : f003            >        beq skip2481
                       >        trap            ;failed not equal (non zero)
3805 : 20c740          >        jsr report_error
                       >
3808 :                 >skip2481
                       >
3808 : 28              >            plp         ;restore status
                       >
3809 : a552            >        lda zpt
380b : c9ff            >        cmp #$ff
                       >        trap_ne     ;wrong bits set or cleared
380d : f003            >        beq skip2483
                       >        trap            ;failed not equal (non zero)
380f : 20c740          >        jsr report_error
                       >
3812 :                 >skip2483
                       >
3812 : a900            >        lda #0
3814 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
3816 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3818 : 48              >            pha         ;use stack to load status
3819 : a95a            >            lda #$5a     ;precharge accu
381b : 28              >            plp
                       >
381c : 8752            >        smb 0,zpt
                       >        tst_a $5a,$ff
381e : 08              >            php         ;save flags
381f : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
3821 : f003            >        beq skip2488
                       >        trap            ;failed not equal (non zero)
3823 : 20c740          >        jsr report_error
                       >
3826 :                 >skip2488
                       >
3826 : 68              >            pla         ;load status
3827 : 48              >            pha
                       >            cmp_flag $ff
3828 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
382a : f003            >        beq skip2491
                       >        trap            ;failed not equal (non zero)
382c : 20c740          >        jsr report_error
                       >
382f :                 >skip2491
                       >
382f : 28              >            plp         ;restore status
                       >
3830 : a552            >        lda zpt
3832 : c901            >        cmp #1<<0
                       >        trap_ne     ;wrong bits set or cleared
3834 : f003            >        beq skip2493
                       >        trap            ;failed not equal (non zero)
3836 : 20c740          >        jsr report_error
                       >
3839 :                 >skip2493
                       >
                        
                                smbt 1
3839 : a9fd            >        lda #$ff-(1<<1)
383b : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
383d : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
383f : 48              >            pha         ;use stack to load status
3840 : a9a5            >            lda #$a5     ;precharge accu
3842 : 28              >            plp
                       >
3843 : 9752            >        smb 1,zpt
                       >        tst_a $a5,0
3845 : 08              >            php         ;save flags
3846 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
3848 : f003            >        beq skip2499
                       >        trap            ;failed not equal (non zero)
384a : 20c740          >        jsr report_error
                       >
384d :                 >skip2499
                       >
384d : 68              >            pla         ;load status
384e : 48              >            pha
                       >            cmp_flag 0
384f : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3851 : f003            >        beq skip2502
                       >        trap            ;failed not equal (non zero)
3853 : 20c740          >        jsr report_error
                       >
3856 :                 >skip2502
                       >
3856 : 28              >            plp         ;restore status
                       >
3857 : a552            >        lda zpt
3859 : c9ff            >        cmp #$ff
                       >        trap_ne     ;wrong bits set or cleared
385b : f003            >        beq skip2504
                       >        trap            ;failed not equal (non zero)
385d : 20c740          >        jsr report_error
                       >
3860 :                 >skip2504
                       >
3860 : a900            >        lda #0
3862 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
3864 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3866 : 48              >            pha         ;use stack to load status
3867 : a95a            >            lda #$5a     ;precharge accu
3869 : 28              >            plp
                       >
386a : 9752            >        smb 1,zpt
                       >        tst_a $5a,$ff
386c : 08              >            php         ;save flags
386d : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
386f : f003            >        beq skip2509
                       >        trap            ;failed not equal (non zero)
3871 : 20c740          >        jsr report_error
                       >
3874 :                 >skip2509
                       >
3874 : 68              >            pla         ;load status
3875 : 48              >            pha
                       >            cmp_flag $ff
3876 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3878 : f003            >        beq skip2512
                       >        trap            ;failed not equal (non zero)
387a : 20c740          >        jsr report_error
                       >
387d :                 >skip2512
                       >
387d : 28              >            plp         ;restore status
                       >
387e : a552            >        lda zpt
3880 : c902            >        cmp #1<<1
                       >        trap_ne     ;wrong bits set or cleared
3882 : f003            >        beq skip2514
                       >        trap            ;failed not equal (non zero)
3884 : 20c740          >        jsr report_error
                       >
3887 :                 >skip2514
                       >
                        
                                smbt 2
3887 : a9fb            >        lda #$ff-(1<<2)
3889 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
388b : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
388d : 48              >            pha         ;use stack to load status
388e : a9a5            >            lda #$a5     ;precharge accu
3890 : 28              >            plp
                       >
3891 : a752            >        smb 2,zpt
                       >        tst_a $a5,0
3893 : 08              >            php         ;save flags
3894 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
3896 : f003            >        beq skip2520
                       >        trap            ;failed not equal (non zero)
3898 : 20c740          >        jsr report_error
                       >
389b :                 >skip2520
                       >
389b : 68              >            pla         ;load status
389c : 48              >            pha
                       >            cmp_flag 0
389d : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
389f : f003            >        beq skip2523
                       >        trap            ;failed not equal (non zero)
38a1 : 20c740          >        jsr report_error
                       >
38a4 :                 >skip2523
                       >
38a4 : 28              >            plp         ;restore status
                       >
38a5 : a552            >        lda zpt
38a7 : c9ff            >        cmp #$ff
                       >        trap_ne     ;wrong bits set or cleared
38a9 : f003            >        beq skip2525
                       >        trap            ;failed not equal (non zero)
38ab : 20c740          >        jsr report_error
                       >
38ae :                 >skip2525
                       >
38ae : a900            >        lda #0
38b0 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
38b2 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
38b4 : 48              >            pha         ;use stack to load status
38b5 : a95a            >            lda #$5a     ;precharge accu
38b7 : 28              >            plp
                       >
38b8 : a752            >        smb 2,zpt
                       >        tst_a $5a,$ff
38ba : 08              >            php         ;save flags
38bb : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
38bd : f003            >        beq skip2530
                       >        trap            ;failed not equal (non zero)
38bf : 20c740          >        jsr report_error
                       >
38c2 :                 >skip2530
                       >
38c2 : 68              >            pla         ;load status
38c3 : 48              >            pha
                       >            cmp_flag $ff
38c4 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
38c6 : f003            >        beq skip2533
                       >        trap            ;failed not equal (non zero)
38c8 : 20c740          >        jsr report_error
                       >
38cb :                 >skip2533
                       >
38cb : 28              >            plp         ;restore status
                       >
38cc : a552            >        lda zpt
38ce : c904            >        cmp #1<<2
                       >        trap_ne     ;wrong bits set or cleared
38d0 : f003            >        beq skip2535
                       >        trap            ;failed not equal (non zero)
38d2 : 20c740          >        jsr report_error
                       >
38d5 :                 >skip2535
                       >
                        
                                smbt 3
38d5 : a9f7            >        lda #$ff-(1<<3)
38d7 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
38d9 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
38db : 48              >            pha         ;use stack to load status
38dc : a9a5            >            lda #$a5     ;precharge accu
38de : 28              >            plp
                       >
38df : b752            >        smb 3,zpt
                       >        tst_a $a5,0
38e1 : 08              >            php         ;save flags
38e2 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
38e4 : f003            >        beq skip2541
                       >        trap            ;failed not equal (non zero)
38e6 : 20c740          >        jsr report_error
                       >
38e9 :                 >skip2541
                       >
38e9 : 68              >            pla         ;load status
38ea : 48              >            pha
                       >            cmp_flag 0
38eb : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
38ed : f003            >        beq skip2544
                       >        trap            ;failed not equal (non zero)
38ef : 20c740          >        jsr report_error
                       >
38f2 :                 >skip2544
                       >
38f2 : 28              >            plp         ;restore status
                       >
38f3 : a552            >        lda zpt
38f5 : c9ff            >        cmp #$ff
                       >        trap_ne     ;wrong bits set or cleared
38f7 : f003            >        beq skip2546
                       >        trap            ;failed not equal (non zero)
38f9 : 20c740          >        jsr report_error
                       >
38fc :                 >skip2546
                       >
38fc : a900            >        lda #0
38fe : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
3900 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3902 : 48              >            pha         ;use stack to load status
3903 : a95a            >            lda #$5a     ;precharge accu
3905 : 28              >            plp
                       >
3906 : b752            >        smb 3,zpt
                       >        tst_a $5a,$ff
3908 : 08              >            php         ;save flags
3909 : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
390b : f003            >        beq skip2551
                       >        trap            ;failed not equal (non zero)
390d : 20c740          >        jsr report_error
                       >
3910 :                 >skip2551
                       >
3910 : 68              >            pla         ;load status
3911 : 48              >            pha
                       >            cmp_flag $ff
3912 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3914 : f003            >        beq skip2554
                       >        trap            ;failed not equal (non zero)
3916 : 20c740          >        jsr report_error
                       >
3919 :                 >skip2554
                       >
3919 : 28              >            plp         ;restore status
                       >
391a : a552            >        lda zpt
391c : c908            >        cmp #1<<3
                       >        trap_ne     ;wrong bits set or cleared
391e : f003            >        beq skip2556
                       >        trap            ;failed not equal (non zero)
3920 : 20c740          >        jsr report_error
                       >
3923 :                 >skip2556
                       >
                        
                                smbt 4
3923 : a9ef            >        lda #$ff-(1<<4)
3925 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
3927 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3929 : 48              >            pha         ;use stack to load status
392a : a9a5            >            lda #$a5     ;precharge accu
392c : 28              >            plp
                       >
392d : c752            >        smb 4,zpt
                       >        tst_a $a5,0
392f : 08              >            php         ;save flags
3930 : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
3932 : f003            >        beq skip2562
                       >        trap            ;failed not equal (non zero)
3934 : 20c740          >        jsr report_error
                       >
3937 :                 >skip2562
                       >
3937 : 68              >            pla         ;load status
3938 : 48              >            pha
                       >            cmp_flag 0
3939 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
393b : f003            >        beq skip2565
                       >        trap            ;failed not equal (non zero)
393d : 20c740          >        jsr report_error
                       >
3940 :                 >skip2565
                       >
3940 : 28              >            plp         ;restore status
                       >
3941 : a552            >        lda zpt
3943 : c9ff            >        cmp #$ff
                       >        trap_ne     ;wrong bits set or cleared
3945 : f003            >        beq skip2567
                       >        trap            ;failed not equal (non zero)
3947 : 20c740          >        jsr report_error
                       >
394a :                 >skip2567
                       >
394a : a900            >        lda #0
394c : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
394e : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3950 : 48              >            pha         ;use stack to load status
3951 : a95a            >            lda #$5a     ;precharge accu
3953 : 28              >            plp
                       >
3954 : c752            >        smb 4,zpt
                       >        tst_a $5a,$ff
3956 : 08              >            php         ;save flags
3957 : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
3959 : f003            >        beq skip2572
                       >        trap            ;failed not equal (non zero)
395b : 20c740          >        jsr report_error
                       >
395e :                 >skip2572
                       >
395e : 68              >            pla         ;load status
395f : 48              >            pha
                       >            cmp_flag $ff
3960 : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3962 : f003            >        beq skip2575
                       >        trap            ;failed not equal (non zero)
3964 : 20c740          >        jsr report_error
                       >
3967 :                 >skip2575
                       >
3967 : 28              >            plp         ;restore status
                       >
3968 : a552            >        lda zpt
396a : c910            >        cmp #1<<4
                       >        trap_ne     ;wrong bits set or cleared
396c : f003            >        beq skip2577
                       >        trap            ;failed not equal (non zero)
396e : 20c740          >        jsr report_error
                       >
3971 :                 >skip2577
                       >
                        
                                smbt 5
3971 : a9df            >        lda #$ff-(1<<5)
3973 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
3975 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3977 : 48              >            pha         ;use stack to load status
3978 : a9a5            >            lda #$a5     ;precharge accu
397a : 28              >            plp
                       >
397b : d752            >        smb 5,zpt
                       >        tst_a $a5,0
397d : 08              >            php         ;save flags
397e : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
3980 : f003            >        beq skip2583
                       >        trap            ;failed not equal (non zero)
3982 : 20c740          >        jsr report_error
                       >
3985 :                 >skip2583
                       >
3985 : 68              >            pla         ;load status
3986 : 48              >            pha
                       >            cmp_flag 0
3987 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3989 : f003            >        beq skip2586
                       >        trap            ;failed not equal (non zero)
398b : 20c740          >        jsr report_error
                       >
398e :                 >skip2586
                       >
398e : 28              >            plp         ;restore status
                       >
398f : a552            >        lda zpt
3991 : c9ff            >        cmp #$ff
                       >        trap_ne     ;wrong bits set or cleared
3993 : f003            >        beq skip2588
                       >        trap            ;failed not equal (non zero)
3995 : 20c740          >        jsr report_error
                       >
3998 :                 >skip2588
                       >
3998 : a900            >        lda #0
399a : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
399c : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
399e : 48              >            pha         ;use stack to load status
399f : a95a            >            lda #$5a     ;precharge accu
39a1 : 28              >            plp
                       >
39a2 : d752            >        smb 5,zpt
                       >        tst_a $5a,$ff
39a4 : 08              >            php         ;save flags
39a5 : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
39a7 : f003            >        beq skip2593
                       >        trap            ;failed not equal (non zero)
39a9 : 20c740          >        jsr report_error
                       >
39ac :                 >skip2593
                       >
39ac : 68              >            pla         ;load status
39ad : 48              >            pha
                       >            cmp_flag $ff
39ae : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
39b0 : f003            >        beq skip2596
                       >        trap            ;failed not equal (non zero)
39b2 : 20c740          >        jsr report_error
                       >
39b5 :                 >skip2596
                       >
39b5 : 28              >            plp         ;restore status
                       >
39b6 : a552            >        lda zpt
39b8 : c920            >        cmp #1<<5
                       >        trap_ne     ;wrong bits set or cleared
39ba : f003            >        beq skip2598
                       >        trap            ;failed not equal (non zero)
39bc : 20c740          >        jsr report_error
                       >
39bf :                 >skip2598
                       >
                        
                                smbt 6
39bf : a9bf            >        lda #$ff-(1<<6)
39c1 : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
39c3 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
39c5 : 48              >            pha         ;use stack to load status
39c6 : a9a5            >            lda #$a5     ;precharge accu
39c8 : 28              >            plp
                       >
39c9 : e752            >        smb 6,zpt
                       >        tst_a $a5,0
39cb : 08              >            php         ;save flags
39cc : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
39ce : f003            >        beq skip2604
                       >        trap            ;failed not equal (non zero)
39d0 : 20c740          >        jsr report_error
                       >
39d3 :                 >skip2604
                       >
39d3 : 68              >            pla         ;load status
39d4 : 48              >            pha
                       >            cmp_flag 0
39d5 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
39d7 : f003            >        beq skip2607
                       >        trap            ;failed not equal (non zero)
39d9 : 20c740          >        jsr report_error
                       >
39dc :                 >skip2607
                       >
39dc : 28              >            plp         ;restore status
                       >
39dd : a552            >        lda zpt
39df : c9ff            >        cmp #$ff
                       >        trap_ne     ;wrong bits set or cleared
39e1 : f003            >        beq skip2609
                       >        trap            ;failed not equal (non zero)
39e3 : 20c740          >        jsr report_error
                       >
39e6 :                 >skip2609
                       >
39e6 : a900            >        lda #0
39e8 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
39ea : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
39ec : 48              >            pha         ;use stack to load status
39ed : a95a            >            lda #$5a     ;precharge accu
39ef : 28              >            plp
                       >
39f0 : e752            >        smb 6,zpt
                       >        tst_a $5a,$ff
39f2 : 08              >            php         ;save flags
39f3 : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
39f5 : f003            >        beq skip2614
                       >        trap            ;failed not equal (non zero)
39f7 : 20c740          >        jsr report_error
                       >
39fa :                 >skip2614
                       >
39fa : 68              >            pla         ;load status
39fb : 48              >            pha
                       >            cmp_flag $ff
39fc : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
39fe : f003            >        beq skip2617
                       >        trap            ;failed not equal (non zero)
3a00 : 20c740          >        jsr report_error
                       >
3a03 :                 >skip2617
                       >
3a03 : 28              >            plp         ;restore status
                       >
3a04 : a552            >        lda zpt
3a06 : c940            >        cmp #1<<6
                       >        trap_ne     ;wrong bits set or cleared
3a08 : f003            >        beq skip2619
                       >        trap            ;failed not equal (non zero)
3a0a : 20c740          >        jsr report_error
                       >
3a0d :                 >skip2619
                       >
                        
                                smbt 7
3a0d : a97f            >        lda #$ff-(1<<7)
3a0f : 8552            >        sta zpt
                       >        set_a $a5,0
                       >            load_flag 0
3a11 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3a13 : 48              >            pha         ;use stack to load status
3a14 : a9a5            >            lda #$a5     ;precharge accu
3a16 : 28              >            plp
                       >
3a17 : f752            >        smb 7,zpt
                       >        tst_a $a5,0
3a19 : 08              >            php         ;save flags
3a1a : c9a5            >            cmp #$a5     ;test result
                       >            trap_ne
3a1c : f003            >        beq skip2625
                       >        trap            ;failed not equal (non zero)
3a1e : 20c740          >        jsr report_error
                       >
3a21 :                 >skip2625
                       >
3a21 : 68              >            pla         ;load status
3a22 : 48              >            pha
                       >            cmp_flag 0
3a23 : c930            >            cmp #(0|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3a25 : f003            >        beq skip2628
                       >        trap            ;failed not equal (non zero)
3a27 : 20c740          >        jsr report_error
                       >
3a2a :                 >skip2628
                       >
3a2a : 28              >            plp         ;restore status
                       >
3a2b : a552            >        lda zpt
3a2d : c9ff            >        cmp #$ff
                       >        trap_ne     ;wrong bits set or cleared
3a2f : f003            >        beq skip2630
                       >        trap            ;failed not equal (non zero)
3a31 : 20c740          >        jsr report_error
                       >
3a34 :                 >skip2630
                       >
3a34 : a900            >        lda #0
3a36 : 8552            >        sta zpt
                       >        set_a $5a,$ff
                       >            load_flag $ff
3a38 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3a3a : 48              >            pha         ;use stack to load status
3a3b : a95a            >            lda #$5a     ;precharge accu
3a3d : 28              >            plp
                       >
3a3e : f752            >        smb 7,zpt
                       >        tst_a $5a,$ff
3a40 : 08              >            php         ;save flags
3a41 : c95a            >            cmp #$5a     ;test result
                       >            trap_ne
3a43 : f003            >        beq skip2635
                       >        trap            ;failed not equal (non zero)
3a45 : 20c740          >        jsr report_error
                       >
3a48 :                 >skip2635
                       >
3a48 : 68              >            pla         ;load status
3a49 : 48              >            pha
                       >            cmp_flag $ff
3a4a : c9ff            >            cmp #($ff|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3a4c : f003            >        beq skip2638
                       >        trap            ;failed not equal (non zero)
3a4e : 20c740          >        jsr report_error
                       >
3a51 :                 >skip2638
                       >
3a51 : 28              >            plp         ;restore status
                       >
3a52 : a552            >        lda zpt
3a54 : c980            >        cmp #1<<7
                       >        trap_ne     ;wrong bits set or cleared
3a56 : f003            >        beq skip2640
                       >        trap            ;failed not equal (non zero)
3a58 : 20c740          >        jsr report_error
                       >
3a5b :                 >skip2640
                       >
                        
3a5b : e0ba                     cpx #$ba
                                trap_ne     ;x altered during test
3a5d : f003            >        beq skip2642
                       >        trap            ;failed not equal (non zero)
3a5f : 20c740          >        jsr report_error
                       >
3a62 :                 >skip2642
                        
3a62 : c0d0                     cpy #$d0
                                trap_ne     ;y altered during test
3a64 : f003            >        beq skip2644
                       >        trap            ;failed not equal (non zero)
3a66 : 20c740          >        jsr report_error
                       >
3a69 :                 >skip2644
                        
3a69 : ba                       tsx
3a6a : e0ff                     cpx #$ff
                                trap_ne     ;sp push/pop mismatch
3a6c : f003            >        beq skip2646
                       >        trap            ;failed not equal (non zero)
3a6e : 20c740          >        jsr report_error
                       >
3a71 :                 >skip2646
                        
                                next_test
3a71 : ad0211          >            lda test_case   ;previous test
3a74 : c910            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
3a76 : f003            >        beq skip2649
                       >        trap            ;failed not equal (non zero)
3a78 : 20c740          >        jsr report_error
                       >
3a7b :                 >skip2649
                       >
0011 =                 >test_num = test_num + 1
3a7b : a911            >            lda #test_num   ;*** next tests' number
3a7d : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                            endif        
                                 
                        ; testing CMP - (zp)         
3a80 : a2de                     ldx #$de    ;protect x & y
3a82 : a0ad                     ldy #$ad
                                set_a $80,0
                       >            load_flag 0
3a84 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3a86 : 48              >            pha         ;use stack to load status
3a87 : a980            >            lda #$80     ;precharge accu
3a89 : 28              >            plp
                        
3a8a : d272                     cmp (ind1+8)
                                tst_a $80,fc
3a8c : 08              >            php         ;save flags
3a8d : c980            >            cmp #$80     ;test result
                       >            trap_ne
3a8f : f003            >        beq skip2654
                       >        trap            ;failed not equal (non zero)
3a91 : 20c740          >        jsr report_error
                       >
3a94 :                 >skip2654
                       >
3a94 : 68              >            pla         ;load status
3a95 : 48              >            pha
                       >            cmp_flag fc
3a96 : c931            >            cmp #(fc|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3a98 : f003            >        beq skip2657
                       >        trap            ;failed not equal (non zero)
3a9a : 20c740          >        jsr report_error
                       >
3a9d :                 >skip2657
                       >
3a9d : 28              >            plp         ;restore status
                        
                                set_a $7f,0
                       >            load_flag 0
3a9e : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3aa0 : 48              >            pha         ;use stack to load status
3aa1 : a97f            >            lda #$7f     ;precharge accu
3aa3 : 28              >            plp
                        
3aa4 : d272                     cmp (ind1+8)
                                tst_a $7f,fzc
3aa6 : 08              >            php         ;save flags
3aa7 : c97f            >            cmp #$7f     ;test result
                       >            trap_ne
3aa9 : f003            >        beq skip2662
                       >        trap            ;failed not equal (non zero)
3aab : 20c740          >        jsr report_error
                       >
3aae :                 >skip2662
                       >
3aae : 68              >            pla         ;load status
3aaf : 48              >            pha
                       >            cmp_flag fzc
3ab0 : c933            >            cmp #(fzc|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3ab2 : f003            >        beq skip2665
                       >        trap            ;failed not equal (non zero)
3ab4 : 20c740          >        jsr report_error
                       >
3ab7 :                 >skip2665
                       >
3ab7 : 28              >            plp         ;restore status
                        
                                set_a $7e,0
                       >            load_flag 0
3ab8 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3aba : 48              >            pha         ;use stack to load status
3abb : a97e            >            lda #$7e     ;precharge accu
3abd : 28              >            plp
                        
3abe : d272                     cmp (ind1+8)
                                tst_a $7e,fn
3ac0 : 08              >            php         ;save flags
3ac1 : c97e            >            cmp #$7e     ;test result
                       >            trap_ne
3ac3 : f003            >        beq skip2670
                       >        trap            ;failed not equal (non zero)
3ac5 : 20c740          >        jsr report_error
                       >
3ac8 :                 >skip2670
                       >
3ac8 : 68              >            pla         ;load status
3ac9 : 48              >            pha
                       >            cmp_flag fn
3aca : c9b0            >            cmp #(fn|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3acc : f003            >        beq skip2673
                       >        trap            ;failed not equal (non zero)
3ace : 20c740          >        jsr report_error
                       >
3ad1 :                 >skip2673
                       >
3ad1 : 28              >            plp         ;restore status
                        
                                set_a $80,$ff
                       >            load_flag $ff
3ad2 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3ad4 : 48              >            pha         ;use stack to load status
3ad5 : a980            >            lda #$80     ;precharge accu
3ad7 : 28              >            plp
                        
3ad8 : d272                     cmp (ind1+8)
                                tst_a $80,~fnz
3ada : 08              >            php         ;save flags
3adb : c980            >            cmp #$80     ;test result
                       >            trap_ne
3add : f003            >        beq skip2678
                       >        trap            ;failed not equal (non zero)
3adf : 20c740          >        jsr report_error
                       >
3ae2 :                 >skip2678
                       >
3ae2 : 68              >            pla         ;load status
3ae3 : 48              >            pha
                       >            cmp_flag ~fnz
3ae4 : c97d            >            cmp #(~fnz|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3ae6 : f003            >        beq skip2681
                       >        trap            ;failed not equal (non zero)
3ae8 : 20c740          >        jsr report_error
                       >
3aeb :                 >skip2681
                       >
3aeb : 28              >            plp         ;restore status
                        
                                set_a $7f,$ff
                       >            load_flag $ff
3aec : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3aee : 48              >            pha         ;use stack to load status
3aef : a97f            >            lda #$7f     ;precharge accu
3af1 : 28              >            plp
                        
3af2 : d272                     cmp (ind1+8)
                                tst_a $7f,~fn
3af4 : 08              >            php         ;save flags
3af5 : c97f            >            cmp #$7f     ;test result
                       >            trap_ne
3af7 : f003            >        beq skip2686
                       >        trap            ;failed not equal (non zero)
3af9 : 20c740          >        jsr report_error
                       >
3afc :                 >skip2686
                       >
3afc : 68              >            pla         ;load status
3afd : 48              >            pha
                       >            cmp_flag ~fn
3afe : c97f            >            cmp #(~fn|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3b00 : f003            >        beq skip2689
                       >        trap            ;failed not equal (non zero)
3b02 : 20c740          >        jsr report_error
                       >
3b05 :                 >skip2689
                       >
3b05 : 28              >            plp         ;restore status
                        
                                set_a $7e,$ff
                       >            load_flag $ff
3b06 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3b08 : 48              >            pha         ;use stack to load status
3b09 : a97e            >            lda #$7e     ;precharge accu
3b0b : 28              >            plp
                        
3b0c : d272                     cmp (ind1+8)
                                tst_a $7e,~fzc
3b0e : 08              >            php         ;save flags
3b0f : c97e            >            cmp #$7e     ;test result
                       >            trap_ne
3b11 : f003            >        beq skip2694
                       >        trap            ;failed not equal (non zero)
3b13 : 20c740          >        jsr report_error
                       >
3b16 :                 >skip2694
                       >
3b16 : 68              >            pla         ;load status
3b17 : 48              >            pha
                       >            cmp_flag ~fzc
3b18 : c9fc            >            cmp #(~fzc|fao)&m8    ;expected flags + always on bits
                       >
                       >            trap_ne
3b1a : f003            >        beq skip2697
                       >        trap            ;failed not equal (non zero)
3b1c : 20c740          >        jsr report_error
                       >
3b1f :                 >skip2697
                       >
3b1f : 28              >            plp         ;restore status
                        
3b20 : e0de                     cpx #$de
                                trap_ne     ;x altered during test
3b22 : f003            >        beq skip2699
                       >        trap            ;failed not equal (non zero)
3b24 : 20c740          >        jsr report_error
                       >
3b27 :                 >skip2699
                        
3b27 : c0ad                     cpy #$ad
                                trap_ne     ;y altered during test 
3b29 : f003            >        beq skip2701
                       >        trap            ;failed not equal (non zero)
3b2b : 20c740          >        jsr report_error
                       >
3b2e :                 >skip2701
                        
3b2e : ba                       tsx
3b2f : e0ff                     cpx #$ff
                                trap_ne     ;sp push/pop mismatch
3b31 : f003            >        beq skip2703
                       >        trap            ;failed not equal (non zero)
3b33 : 20c740          >        jsr report_error
                       >
3b36 :                 >skip2703
                        
                                next_test
3b36 : ad0211          >            lda test_case   ;previous test
3b39 : c911            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
3b3b : f003            >        beq skip2706
                       >        trap            ;failed not equal (non zero)
3b3d : 20c740          >        jsr report_error
                       >
3b40 :                 >skip2706
                       >
0012 =                 >test_num = test_num + 1
3b40 : a912            >            lda #test_num   ;*** next tests' number
3b42 : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                        ; testing logical instructions - AND EOR ORA (zp)
3b45 : a242                     ldx #$42    ;protect x & y
                        
3b47 : a000                     ldy #0      ;AND
3b49 : a580                     lda indAN   ;set indirect address
3b4b : 8552                     sta zpt
3b4d : a581                     lda indAN+1
3b4f : 8553                     sta zpt+1
3b51 :                  tand1
                                set_ay  absANa,0
                       >            load_flag 0
3b51 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3b53 : 48              >            pha         ;use stack to load status
3b54 : b95311          >            lda absANa,y    ;precharge accu
3b57 : 28              >            plp
                        
3b58 : 3252                     and (zpt)
                                tst_ay  absrlo,absflo,0
3b5a : 08              >            php         ;save flags
3b5b : d95b11          >            cmp absrlo,y    ;test result
                       >            trap_ne     ;
3b5e : f003            >        beq skip2711
                       >        trap            ;failed not equal (non zero)
3b60 : 20c740          >        jsr report_error
                       >
3b63 :                 >skip2711
                       >
3b63 : 68              >            pla         ;load status
                       >            eor_flag 0
3b64 : 4930            >            eor #0|fao         ;invert expected flags + always on bits
                       >
3b66 : d95f11          >            cmp absflo,y    ;test flags
                       >            trap_ne
3b69 : f003            >        beq skip2714
                       >        trap            ;failed not equal (non zero)
3b6b : 20c740          >        jsr report_error
                       >
3b6e :                 >skip2714
                       >
                        
3b6e : e652                     inc zpt
3b70 : c8                       iny
3b71 : c004                     cpy #4
3b73 : d0dc                     bne tand1
3b75 : 88                       dey
3b76 : c652                     dec zpt
3b78 :                  tand2
                                set_ay  absANa,$ff
                       >            load_flag $ff
3b78 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3b7a : 48              >            pha         ;use stack to load status
3b7b : b95311          >            lda absANa,y    ;precharge accu
3b7e : 28              >            plp
                        
3b7f : 3252                     and (zpt)
                                tst_ay  absrlo,absflo,$ff-fnz
3b81 : 08              >            php         ;save flags
3b82 : d95b11          >            cmp absrlo,y    ;test result
                       >            trap_ne     ;
3b85 : f003            >        beq skip2719
                       >        trap            ;failed not equal (non zero)
3b87 : 20c740          >        jsr report_error
                       >
3b8a :                 >skip2719
                       >
3b8a : 68              >            pla         ;load status
                       >            eor_flag $ff-fnz
3b8b : 497d            >            eor #$ff-fnz|fao         ;invert expected flags + always on bits
                       >
3b8d : d95f11          >            cmp absflo,y    ;test flags
                       >            trap_ne
3b90 : f003            >        beq skip2722
                       >        trap            ;failed not equal (non zero)
3b92 : 20c740          >        jsr report_error
                       >
3b95 :                 >skip2722
                       >
                        
3b95 : c652                     dec zpt
3b97 : 88                       dey
3b98 : 10de                     bpl tand2
                        
3b9a : a000                     ldy #0      ;EOR
3b9c : a588                     lda indEO   ;set indirect address
3b9e : 8552                     sta zpt
3ba0 : a589                     lda indEO+1
3ba2 : 8553                     sta zpt+1
3ba4 :                  teor1
                                set_ay  absEOa,0
                       >            load_flag 0
3ba4 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3ba6 : 48              >            pha         ;use stack to load status
3ba7 : b95711          >            lda absEOa,y    ;precharge accu
3baa : 28              >            plp
                        
3bab : 5252                     eor (zpt)
                                tst_ay  absrlo,absflo,0
3bad : 08              >            php         ;save flags
3bae : d95b11          >            cmp absrlo,y    ;test result
                       >            trap_ne     ;
3bb1 : f003            >        beq skip2727
                       >        trap            ;failed not equal (non zero)
3bb3 : 20c740          >        jsr report_error
                       >
3bb6 :                 >skip2727
                       >
3bb6 : 68              >            pla         ;load status
                       >            eor_flag 0
3bb7 : 4930            >            eor #0|fao         ;invert expected flags + always on bits
                       >
3bb9 : d95f11          >            cmp absflo,y    ;test flags
                       >            trap_ne
3bbc : f003            >        beq skip2730
                       >        trap            ;failed not equal (non zero)
3bbe : 20c740          >        jsr report_error
                       >
3bc1 :                 >skip2730
                       >
                        
3bc1 : e652                     inc zpt
3bc3 : c8                       iny
3bc4 : c004                     cpy #4
3bc6 : d0dc                     bne teor1
3bc8 : 88                       dey
3bc9 : c652                     dec zpt
3bcb :                  teor2
                                set_ay  absEOa,$ff
                       >            load_flag $ff
3bcb : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3bcd : 48              >            pha         ;use stack to load status
3bce : b95711          >            lda absEOa,y    ;precharge accu
3bd1 : 28              >            plp
                        
3bd2 : 5252                     eor (zpt)
                                tst_ay  absrlo,absflo,$ff-fnz
3bd4 : 08              >            php         ;save flags
3bd5 : d95b11          >            cmp absrlo,y    ;test result
                       >            trap_ne     ;
3bd8 : f003            >        beq skip2735
                       >        trap            ;failed not equal (non zero)
3bda : 20c740          >        jsr report_error
                       >
3bdd :                 >skip2735
                       >
3bdd : 68              >            pla         ;load status
                       >            eor_flag $ff-fnz
3bde : 497d            >            eor #$ff-fnz|fao         ;invert expected flags + always on bits
                       >
3be0 : d95f11          >            cmp absflo,y    ;test flags
                       >            trap_ne
3be3 : f003            >        beq skip2738
                       >        trap            ;failed not equal (non zero)
3be5 : 20c740          >        jsr report_error
                       >
3be8 :                 >skip2738
                       >
                        
3be8 : c652                     dec zpt
3bea : 88                       dey
3beb : 10de                     bpl teor2
                        
3bed : a000                     ldy #0      ;ORA
3bef : a590                     lda indOR   ;set indirect address
3bf1 : 8552                     sta zpt
3bf3 : a591                     lda indOR+1
3bf5 : 8553                     sta zpt+1
3bf7 :                  tora1
                                set_ay  absORa,0
                       >            load_flag 0
3bf7 : a900            >            lda #0             ;allow test to change I-flag (no mask)
                       >
3bf9 : 48              >            pha         ;use stack to load status
3bfa : b94f11          >            lda absORa,y    ;precharge accu
3bfd : 28              >            plp
                        
3bfe : 1252                     ora (zpt)
                                tst_ay  absrlo,absflo,0
3c00 : 08              >            php         ;save flags
3c01 : d95b11          >            cmp absrlo,y    ;test result
                       >            trap_ne     ;
3c04 : f003            >        beq skip2743
                       >        trap            ;failed not equal (non zero)
3c06 : 20c740          >        jsr report_error
                       >
3c09 :                 >skip2743
                       >
3c09 : 68              >            pla         ;load status
                       >            eor_flag 0
3c0a : 4930            >            eor #0|fao         ;invert expected flags + always on bits
                       >
3c0c : d95f11          >            cmp absflo,y    ;test flags
                       >            trap_ne
3c0f : f003            >        beq skip2746
                       >        trap            ;failed not equal (non zero)
3c11 : 20c740          >        jsr report_error
                       >
3c14 :                 >skip2746
                       >
                        
3c14 : e652                     inc zpt
3c16 : c8                       iny
3c17 : c004                     cpy #4
3c19 : d0dc                     bne tora1
3c1b : 88                       dey
3c1c : c652                     dec zpt
3c1e :                  tora2
                                set_ay  absORa,$ff
                       >            load_flag $ff
3c1e : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
3c20 : 48              >            pha         ;use stack to load status
3c21 : b94f11          >            lda absORa,y    ;precharge accu
3c24 : 28              >            plp
                        
3c25 : 1252                     ora (zpt)
                                tst_ay  absrlo,absflo,$ff-fnz
3c27 : 08              >            php         ;save flags
3c28 : d95b11          >            cmp absrlo,y    ;test result
                       >            trap_ne     ;
3c2b : f003            >        beq skip2751
                       >        trap            ;failed not equal (non zero)
3c2d : 20c740          >        jsr report_error
                       >
3c30 :                 >skip2751
                       >
3c30 : 68              >            pla         ;load status
                       >            eor_flag $ff-fnz
3c31 : 497d            >            eor #$ff-fnz|fao         ;invert expected flags + always on bits
                       >
3c33 : d95f11          >            cmp absflo,y    ;test flags
                       >            trap_ne
3c36 : f003            >        beq skip2754
                       >        trap            ;failed not equal (non zero)
3c38 : 20c740          >        jsr report_error
                       >
3c3b :                 >skip2754
                       >
                        
3c3b : c652                     dec zpt
3c3d : 88                       dey
3c3e : 10de                     bpl tora2
                        
3c40 : e042                     cpx #$42
                                trap_ne     ;x altered during test
3c42 : f003            >        beq skip2756
                       >        trap            ;failed not equal (non zero)
3c44 : 20c740          >        jsr report_error
                       >
3c47 :                 >skip2756
                        
3c47 : ba                       tsx
3c48 : e0ff                     cpx #$ff
                                trap_ne     ;sp push/pop mismatch
3c4a : f003            >        beq skip2758
                       >        trap            ;failed not equal (non zero)
3c4c : 20c740          >        jsr report_error
                       >
3c4f :                 >skip2758
                        
                                next_test
3c4f : ad0211          >            lda test_case   ;previous test
3c52 : c912            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
3c54 : f003            >        beq skip2761
                       >        trap            ;failed not equal (non zero)
3c56 : 20c740          >        jsr report_error
                       >
3c59 :                 >skip2761
                       >
0013 =                 >test_num = test_num + 1
3c59 : a913            >            lda #test_num   ;*** next tests' number
3c5b : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                                
                            if I_flag = 3
3c5e : 58                       cli
                            endif                
                        
                        ; full binary add/subtract test - (zp) only
                        ; iterates through all combinations of operands and carry input
                        ; uses increments/decrements to predict result & result flags
3c5f : d8                       cld
3c60 : a254                     ldx #ad2        ;for indexed test
3c62 : a0ff                     ldy #$ff        ;max range
3c64 : a900                     lda #0          ;start with adding zeroes & no carry
3c66 : 8552                     sta adfc        ;carry in - for diag
3c68 : 8553                     sta ad1         ;operand 1 - accumulator
3c6a : 8554                     sta ad2         ;operand 2 - memory or immediate
3c6c : 8d0511                   sta ada2        ;non zp
3c6f : 8555                     sta adrl        ;expected result bits 0-7
3c71 : 8556                     sta adrh        ;expected result bit 8 (carry out)
3c73 : a9ff                     lda #$ff        ;complemented operand 2 for subtract
3c75 : 8558                     sta sb2
3c77 : 8d0611                   sta sba2        ;non zp
3c7a : a902                     lda #2          ;expected Z-flag
3c7c : 8557                     sta adrf
3c7e : 18               tadd    clc             ;test with carry clear
3c7f : 20793f                   jsr chkadd
3c82 : e652                     inc adfc        ;now with carry
3c84 : e655                     inc adrl        ;result +1
3c86 : 08                       php             ;save N & Z from low result
3c87 : 08                       php
3c88 : 68                       pla             ;accu holds expected flags
3c89 : 2982                     and #$82        ;mask N & Z
3c8b : 28                       plp
3c8c : d002                     bne tadd1
3c8e : e656                     inc adrh        ;result bit 8 - carry
3c90 : 0556             tadd1   ora adrh        ;merge C to expected flags
3c92 : 8557                     sta adrf        ;save expected flags except overflow
3c94 : 38                       sec             ;test with carry set
3c95 : 20793f                   jsr chkadd
3c98 : c652                     dec adfc        ;same for operand +1 but no carry
3c9a : e653                     inc ad1
3c9c : d0e0                     bne tadd        ;iterate op1
3c9e : a900                     lda #0          ;preset result to op2 when op1 = 0
3ca0 : 8556                     sta adrh
3ca2 : ee0511                   inc ada2
3ca5 : e654                     inc ad2
3ca7 : 08                       php             ;save NZ as operand 2 becomes the new result
3ca8 : 68                       pla
3ca9 : 2982                     and #$82        ;mask N00000Z0
3cab : 8557                     sta adrf        ;no need to check carry as we are adding to 0
3cad : c658                     dec sb2         ;complement subtract operand 2
3caf : ce0611                   dec sba2
3cb2 : a554                     lda ad2         
3cb4 : 8555                     sta adrl
3cb6 : d0c6                     bne tadd        ;iterate op2
                        
3cb8 : e054                     cpx #ad2
                                trap_ne         ;x altered during test
3cba : f003            >        beq skip2763
                       >        trap            ;failed not equal (non zero)
3cbc : 20c740          >        jsr report_error
                       >
3cbf :                 >skip2763
                        
3cbf : c0ff                     cpy #$ff
                                trap_ne         ;y altered during test 
3cc1 : f003            >        beq skip2765
                       >        trap            ;failed not equal (non zero)
3cc3 : 20c740          >        jsr report_error
                       >
3cc6 :                 >skip2765
                        
3cc6 : ba                       tsx
3cc7 : e0ff                     cpx #$ff
                                trap_ne         ;sp push/pop mismatch
3cc9 : f003            >        beq skip2767
                       >        trap            ;failed not equal (non zero)
3ccb : 20c740          >        jsr report_error
                       >
3cce :                 >skip2767
                        
                                next_test
3cce : ad0211          >            lda test_case   ;previous test
3cd1 : c913            >            cmp #test_num
                       >            trap_ne         ;test is out of sequence
3cd3 : f003            >        beq skip2770
                       >        trap            ;failed not equal (non zero)
3cd5 : 20c740          >        jsr report_error
                       >
3cd8 :                 >skip2770
                       >
0014 =                 >test_num = test_num + 1
3cd8 : a914            >            lda #test_num   ;*** next tests' number
3cda : 8d0211          >            sta test_case
                       >            ;check_ram       ;uncomment to find altered RAM after each test
                        
                        
                        ; decimal add/subtract test
                        ; *** WARNING - tests documented behavior only! ***
                        ;   only valid BCD operands are tested, the V flag is ignored
                        ;   although V is declared as beeing valid on the 65C02 it has absolutely
                        ;   no use in BCD math. No sign = no overflow!
                        ; iterates through all valid combinations of operands and carry input
                        ; uses increments/decrements to predict result & carry flag
3cdd : f8                       sed 
3cde : a254                     ldx #ad2        ;for indexed test
3ce0 : a0ff                     ldy #$ff        ;max range
3ce2 : a999                     lda #$99        ;start with adding 99 to 99 with carry
3ce4 : 8553                     sta ad1         ;operand 1 - accumulator
3ce6 : 8554                     sta ad2         ;operand 2 - memory or immediate
3ce8 : 8d0511                   sta ada2        ;non zp
3ceb : 8555                     sta adrl        ;expected result bits 0-7
3ced : a901                     lda #1          ;set carry in & out
3cef : 8552                     sta adfc        ;carry in - for diag
3cf1 : 8556                     sta adrh        ;expected result bit 8 (carry out)
3cf3 : a981                     lda #$81        ;set N & C (99 + 99 + C = 99 + C)
3cf5 : 8557                     sta adrf
3cf7 : a900                     lda #0          ;complemented operand 2 for subtract
3cf9 : 8558                     sta sb2
3cfb : 8d0611                   sta sba2        ;non zp
3cfe : 38               tdad    sec             ;test with carry set
3cff : 20b63d                   jsr chkdad
3d02 : c652                     dec adfc        ;now with carry clear
3d04 : a555                     lda adrl        ;decimal adjust result
3d06 : d008                     bne tdad1       ;skip clear carry & preset result 99 (9A-1)
3d08 : c656                     dec adrh
3d0a : a999                     lda #$99
3d0c : 8555                     sta adrl
3d0e : d012                     bne tdad3
3d10 : 290f             tdad1   and #$f         ;lower nibble mask
3d12 : d00c                     bne tdad2       ;no decimal adjust needed
3d14 : c655                     dec adrl        ;decimal adjust (?0-6)
3d16 : c655                     dec adrl
3d18 : c655                     dec adrl
3d1a : c655                     dec adrl
3d1c : c655                     dec adrl
3d1e : c655                     dec adrl
3d20 : c655             tdad2   dec adrl        ;result -1
3d22 : 08               tdad3   php             ;save valid flags
3d23 : 68                       pla
3d24 : 2982                     and #$82        ;N-----Z-
3d26 : 0556                     ora adrh        ;N-----ZC
3d28 : 8557                     sta adrf
3d2a : 18                       clc             ;test with carry clear
3d2b : 20b63d                   jsr chkdad
3d2e : e652                     inc adfc        ;same for operand -1 but with carry
3d30 : a553                     lda ad1         ;decimal adjust operand 1
3d32 : f015                     beq tdad5       ;iterate operand 2
3d34 : 290f                     and #$f         ;lower nibble mask
3d36 : d00c                     bne tdad4       ;skip decimal adjust
3d38 : c653                     dec ad1         ;decimal adjust (?0-6)
3d3a : c653                     dec ad1
3d3c : c653                     dec ad1
3d3e : c653                     dec ad1
3d40 : c653                     dec ad1
3d42 : c653                     dec ad1
3d44 : c653             tdad4   dec ad1         ;operand 1 -1
3d46 : 4cfe3c                   jmp tdad        ;iterate op1
                        
3d49 : a999             tdad5   lda #$99        ;precharge op1 max
3d4b : 8553                     sta ad1
3d4d : a554                     lda ad2         ;decimal adjust operand 2
3d4f : f039                     beq tdad7       ;end of iteration
3d51 : 290f                     and #$f         ;lower nibble mask
3d53 : d018                     bne tdad6       ;skip decimal adjust
3d55 : c654                     dec ad2         ;decimal adjust (?0-6)
3d57 : c654                     dec ad2
3d59 : c654                     dec ad2
3d5b : c654                     dec ad2
3d5d : c654                     dec ad2
3d5f : c654                     dec ad2
3d61 : e658                     inc sb2         ;complemented decimal adjust for subtract (?9+6)
3d63 : e658                     inc sb2
3d65 : e658                     inc sb2
3d67 : e658                     inc sb2
3d69 : e658                     inc sb2
3d6b : e658                     inc sb2
3d6d : c654             tdad6   dec ad2         ;operand 2 -1
3d6f : e658                     inc sb2         ;complemented operand for subtract
3d71 : a558                     lda sb2
3d73 : 8d0611                   sta sba2        ;copy as non zp operand
3d76 : a554                     lda ad2
3d78 : 8d0511                   sta ada2        ;copy as non zp operand
3d7b : 8555                     sta adrl        ;new result since op1+carry=00+carry +op2=op2
3d7d : 08                       php             ;save flags
3d7e : 68                       pla
3d7f : 2982                     and #$82        ;N-----Z-
3d81 : 0901                     ora #1          ;N-----ZC
3d83 : 8557                     sta adrf
3d85 : e656                     inc adrh        ;result carry
3d87 : 4cfe3c                   jmp tdad        ;iterate op2
                        
3d8a : e054             tdad7   cpx #ad2
                                trap_ne         ;x altered during test
3d8c : f003            >        beq skip2772
                       >        trap            ;failed not equal (non zero)
3d8e : 20c740          >        jsr report_error
                       >
3d91 :                 >skip2772
                        
3d91 : c0ff                     cpy #$ff
                                trap_ne         ;y altered during test 
3d93 : f003            >        beq skip2774
                       >        trap            ;failed not equal (non zero)
3d95 : 20c740          >        jsr report_error
                       >
3d98 :                 >skip2774
                        
3d98 : ba                       tsx
3d99 : e0ff                     cpx #$ff
                                trap_ne         ;sp push/pop mismatch
3d9b : f003            >        beq skip2776
                       >        trap            ;failed not equal (non zero)
3d9d : 20c740          >        jsr report_error
                       >
3da0 :                 >skip2776
                        
3da0 : d8                       cld
                        
3da1 : ad0211                   lda test_case
3da4 : c914                     cmp #test_num
                                trap_ne         ;previous test is out of sequence
3da6 : f003            >        beq skip2778
                       >        trap            ;failed not equal (non zero)
3da8 : 20c740          >        jsr report_error
                       >
3dab :                 >skip2778
                        
3dab : a9f0                     lda #$f0        ;mark opcode testing complete
3dad : 8d0211                   sta test_case
                        
                        ; final RAM integrity test
                        ;   verifies that none of the previous tests has altered RAM outside of the
                        ;   designated write areas.
                                check_ram
                       >            ;RAM check disabled - RAM size not set
                        
                        ; *** DEBUG INFO ***
                        ; to debug checksum errors uncomment check_ram in the next_test macro to 
                        ; narrow down the responsible opcode.
                        ; may give false errors when monitor, OS or other background activity is
                        ; allowed during previous tests.
                        
                        
                        ; S U C C E S S ************************************************       
                        ; -------------       
                                success         ;if you get here everything went well
3db0 : 209041          >        jsr report_success
                        
                        ; -------------       
                        ; S U C C E S S ************************************************       
3db3 : 4c0013                   jmp start       ;run again      
                        
                        ; core subroutine of the decimal add/subtract test
                        ; *** WARNING - tests documented behavior only! ***
                        ;   only valid BCD operands are tested, V flag is ignored
                        ; iterates through all valid combinations of operands and carry input
                        ; uses increments/decrements to predict result & carry flag
3db6 :                  chkdad
                        ; decimal ADC / SBC zp
3db6 : 08                       php             ;save carry for subtract
3db7 : a553                     lda ad1
3db9 : 6554                     adc ad2         ;perform add
3dbb : 08                       php          
3dbc : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3dbe : f003            >        beq skip2782
                       >        trap            ;failed not equal (non zero)
3dc0 : 20c740          >        jsr report_error
                       >
3dc3 :                 >skip2782
                        
3dc3 : 68                       pla             ;check flags
3dc4 : 2983                     and #$83        ;mask N-----ZC
3dc6 : c557                     cmp adrf
                                trap_ne         ;bad flags
3dc8 : f003            >        beq skip2784
                       >        trap            ;failed not equal (non zero)
3dca : 20c740          >        jsr report_error
                       >
3dcd :                 >skip2784
                        
3dcd : 28                       plp
3dce : 08                       php             ;save carry for next add
3dcf : a553                     lda ad1
3dd1 : e558                     sbc sb2         ;perform subtract
3dd3 : 08                       php          
3dd4 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3dd6 : f003            >        beq skip2786
                       >        trap            ;failed not equal (non zero)
3dd8 : 20c740          >        jsr report_error
                       >
3ddb :                 >skip2786
                        
3ddb : 68                       pla             ;check flags
3ddc : 2983                     and #$83        ;mask N-----ZC
3dde : c557                     cmp adrf
                                trap_ne         ;bad flags
3de0 : f003            >        beq skip2788
                       >        trap            ;failed not equal (non zero)
3de2 : 20c740          >        jsr report_error
                       >
3de5 :                 >skip2788
                        
3de5 : 28                       plp
                        ; decimal ADC / SBC abs
3de6 : 08                       php             ;save carry for subtract
3de7 : a553                     lda ad1
3de9 : 6d0511                   adc ada2        ;perform add
3dec : 08                       php          
3ded : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3def : f003            >        beq skip2790
                       >        trap            ;failed not equal (non zero)
3df1 : 20c740          >        jsr report_error
                       >
3df4 :                 >skip2790
                        
3df4 : 68                       pla             ;check flags
3df5 : 2983                     and #$83        ;mask N-----ZC
3df7 : c557                     cmp adrf
                                trap_ne         ;bad flags
3df9 : f003            >        beq skip2792
                       >        trap            ;failed not equal (non zero)
3dfb : 20c740          >        jsr report_error
                       >
3dfe :                 >skip2792
                        
3dfe : 28                       plp
3dff : 08                       php             ;save carry for next add
3e00 : a553                     lda ad1
3e02 : ed0611                   sbc sba2        ;perform subtract
3e05 : 08                       php          
3e06 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3e08 : f003            >        beq skip2794
                       >        trap            ;failed not equal (non zero)
3e0a : 20c740          >        jsr report_error
                       >
3e0d :                 >skip2794
                        
3e0d : 68                       pla             ;check flags
3e0e : 2983                     and #$83        ;mask N-----ZC
3e10 : c557                     cmp adrf
                                trap_ne         ;bad flags
3e12 : f003            >        beq skip2796
                       >        trap            ;failed not equal (non zero)
3e14 : 20c740          >        jsr report_error
                       >
3e17 :                 >skip2796
                        
3e17 : 28                       plp
                        ; decimal ADC / SBC #
3e18 : 08                       php             ;save carry for subtract
3e19 : a554                     lda ad2
3e1b : 8d0b11                   sta ex_adci+1   ;set ADC # operand
3e1e : a553                     lda ad1
3e20 : 200a11                   jsr ex_adci     ;execute ADC # in RAM
3e23 : 08                       php          
3e24 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3e26 : f003            >        beq skip2798
                       >        trap            ;failed not equal (non zero)
3e28 : 20c740          >        jsr report_error
                       >
3e2b :                 >skip2798
                        
3e2b : 68                       pla             ;check flags
3e2c : 2983                     and #$83        ;mask N-----ZC
3e2e : c557                     cmp adrf
                                trap_ne         ;bad flags
3e30 : f003            >        beq skip2800
                       >        trap            ;failed not equal (non zero)
3e32 : 20c740          >        jsr report_error
                       >
3e35 :                 >skip2800
                        
3e35 : 28                       plp
3e36 : 08                       php             ;save carry for next add
3e37 : a558                     lda sb2
3e39 : 8d0e11                   sta ex_sbci+1   ;set SBC # operand
3e3c : a553                     lda ad1
3e3e : 200d11                   jsr ex_sbci     ;execute SBC # in RAM
3e41 : 08                       php          
3e42 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3e44 : f003            >        beq skip2802
                       >        trap            ;failed not equal (non zero)
3e46 : 20c740          >        jsr report_error
                       >
3e49 :                 >skip2802
                        
3e49 : 68                       pla             ;check flags
3e4a : 2983                     and #$83        ;mask N-----ZC
3e4c : c557                     cmp adrf
                                trap_ne         ;bad flags
3e4e : f003            >        beq skip2804
                       >        trap            ;failed not equal (non zero)
3e50 : 20c740          >        jsr report_error
                       >
3e53 :                 >skip2804
                        
3e53 : 28                       plp
                        ; decimal ADC / SBC zp,x
3e54 : 08                       php             ;save carry for subtract
3e55 : a553                     lda ad1
3e57 : 7500                     adc 0,x         ;perform add
3e59 : 08                       php          
3e5a : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3e5c : f003            >        beq skip2806
                       >        trap            ;failed not equal (non zero)
3e5e : 20c740          >        jsr report_error
                       >
3e61 :                 >skip2806
                        
3e61 : 68                       pla             ;check flags
3e62 : 2983                     and #$83        ;mask N-----ZC
3e64 : c557                     cmp adrf
                                trap_ne         ;bad flags
3e66 : f003            >        beq skip2808
                       >        trap            ;failed not equal (non zero)
3e68 : 20c740          >        jsr report_error
                       >
3e6b :                 >skip2808
                        
3e6b : 28                       plp
3e6c : 08                       php             ;save carry for next add
3e6d : a553                     lda ad1
3e6f : f504                     sbc sb2-ad2,x   ;perform subtract
3e71 : 08                       php          
3e72 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3e74 : f003            >        beq skip2810
                       >        trap            ;failed not equal (non zero)
3e76 : 20c740          >        jsr report_error
                       >
3e79 :                 >skip2810
                        
3e79 : 68                       pla             ;check flags
3e7a : 2983                     and #$83        ;mask N-----ZC
3e7c : c557                     cmp adrf
                                trap_ne         ;bad flags
3e7e : f003            >        beq skip2812
                       >        trap            ;failed not equal (non zero)
3e80 : 20c740          >        jsr report_error
                       >
3e83 :                 >skip2812
                        
3e83 : 28                       plp
                        ; decimal ADC / SBC abs,x
3e84 : 08                       php             ;save carry for subtract
3e85 : a553                     lda ad1
3e87 : 7db110                   adc ada2-ad2,x  ;perform add
3e8a : 08                       php          
3e8b : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3e8d : f003            >        beq skip2814
                       >        trap            ;failed not equal (non zero)
3e8f : 20c740          >        jsr report_error
                       >
3e92 :                 >skip2814
                        
3e92 : 68                       pla             ;check flags
3e93 : 2983                     and #$83        ;mask N-----ZC
3e95 : c557                     cmp adrf
                                trap_ne         ;bad flags
3e97 : f003            >        beq skip2816
                       >        trap            ;failed not equal (non zero)
3e99 : 20c740          >        jsr report_error
                       >
3e9c :                 >skip2816
                        
3e9c : 28                       plp
3e9d : 08                       php             ;save carry for next add
3e9e : a553                     lda ad1
3ea0 : fdb210                   sbc sba2-ad2,x  ;perform subtract
3ea3 : 08                       php          
3ea4 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3ea6 : f003            >        beq skip2818
                       >        trap            ;failed not equal (non zero)
3ea8 : 20c740          >        jsr report_error
                       >
3eab :                 >skip2818
                        
3eab : 68                       pla             ;check flags
3eac : 2983                     and #$83        ;mask N-----ZC
3eae : c557                     cmp adrf
                                trap_ne         ;bad flags
3eb0 : f003            >        beq skip2820
                       >        trap            ;failed not equal (non zero)
3eb2 : 20c740          >        jsr report_error
                       >
3eb5 :                 >skip2820
                        
3eb5 : 28                       plp
                        ; decimal ADC / SBC abs,y
3eb6 : 08                       php             ;save carry for subtract
3eb7 : a553                     lda ad1
3eb9 : 790610                   adc ada2-$ff,y  ;perform add
3ebc : 08                       php          
3ebd : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3ebf : f003            >        beq skip2822
                       >        trap            ;failed not equal (non zero)
3ec1 : 20c740          >        jsr report_error
                       >
3ec4 :                 >skip2822
                        
3ec4 : 68                       pla             ;check flags
3ec5 : 2983                     and #$83        ;mask N-----ZC
3ec7 : c557                     cmp adrf
                                trap_ne         ;bad flags
3ec9 : f003            >        beq skip2824
                       >        trap            ;failed not equal (non zero)
3ecb : 20c740          >        jsr report_error
                       >
3ece :                 >skip2824
                        
3ece : 28                       plp
3ecf : 08                       php             ;save carry for next add
3ed0 : a553                     lda ad1
3ed2 : f90710                   sbc sba2-$ff,y  ;perform subtract
3ed5 : 08                       php          
3ed6 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3ed8 : f003            >        beq skip2826
                       >        trap            ;failed not equal (non zero)
3eda : 20c740          >        jsr report_error
                       >
3edd :                 >skip2826
                        
3edd : 68                       pla             ;check flags
3ede : 2983                     and #$83        ;mask N-----ZC
3ee0 : c557                     cmp adrf
                                trap_ne         ;bad flags
3ee2 : f003            >        beq skip2828
                       >        trap            ;failed not equal (non zero)
3ee4 : 20c740          >        jsr report_error
                       >
3ee7 :                 >skip2828
                        
3ee7 : 28                       plp
                        ; decimal ADC / SBC (zp,x)
3ee8 : 08                       php             ;save carry for subtract
3ee9 : a553                     lda ad1
3eeb : 6144                     adc (lo adi2-ad2,x) ;perform add
3eed : 08                       php          
3eee : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3ef0 : f003            >        beq skip2830
                       >        trap            ;failed not equal (non zero)
3ef2 : 20c740          >        jsr report_error
                       >
3ef5 :                 >skip2830
                        
3ef5 : 68                       pla             ;check flags
3ef6 : 2983                     and #$83        ;mask N-----ZC
3ef8 : c557                     cmp adrf
                                trap_ne         ;bad flags
3efa : f003            >        beq skip2832
                       >        trap            ;failed not equal (non zero)
3efc : 20c740          >        jsr report_error
                       >
3eff :                 >skip2832
                        
3eff : 28                       plp
3f00 : 08                       php             ;save carry for next add
3f01 : a553                     lda ad1
3f03 : e146                     sbc (lo sbi2-ad2,x) ;perform subtract
3f05 : 08                       php          
3f06 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3f08 : f003            >        beq skip2834
                       >        trap            ;failed not equal (non zero)
3f0a : 20c740          >        jsr report_error
                       >
3f0d :                 >skip2834
                        
3f0d : 68                       pla             ;check flags
3f0e : 2983                     and #$83        ;mask N-----ZC
3f10 : c557                     cmp adrf
                                trap_ne         ;bad flags
3f12 : f003            >        beq skip2836
                       >        trap            ;failed not equal (non zero)
3f14 : 20c740          >        jsr report_error
                       >
3f17 :                 >skip2836
                        
3f17 : 28                       plp
                        ; decimal ADC / SBC (abs),y
3f18 : 08                       php             ;save carry for subtract
3f19 : a553                     lda ad1
3f1b : 719c                     adc (adiy2),y   ;perform add
3f1d : 08                       php          
3f1e : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3f20 : f003            >        beq skip2838
                       >        trap            ;failed not equal (non zero)
3f22 : 20c740          >        jsr report_error
                       >
3f25 :                 >skip2838
                        
3f25 : 68                       pla             ;check flags
3f26 : 2983                     and #$83        ;mask N-----ZC
3f28 : c557                     cmp adrf
                                trap_ne         ;bad flags
3f2a : f003            >        beq skip2840
                       >        trap            ;failed not equal (non zero)
3f2c : 20c740          >        jsr report_error
                       >
3f2f :                 >skip2840
                        
3f2f : 28                       plp
3f30 : 08                       php             ;save carry for next add
3f31 : a553                     lda ad1
3f33 : f19e                     sbc (sbiy2),y   ;perform subtract
3f35 : 08                       php          
3f36 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3f38 : f003            >        beq skip2842
                       >        trap            ;failed not equal (non zero)
3f3a : 20c740          >        jsr report_error
                       >
3f3d :                 >skip2842
                        
3f3d : 68                       pla             ;check flags
3f3e : 2983                     and #$83        ;mask N-----ZC
3f40 : c557                     cmp adrf
                                trap_ne         ;bad flags
3f42 : f003            >        beq skip2844
                       >        trap            ;failed not equal (non zero)
3f44 : 20c740          >        jsr report_error
                       >
3f47 :                 >skip2844
                        
3f47 : 28                       plp
                        ; decimal ADC / SBC (zp)
3f48 : 08                       php             ;save carry for subtract
3f49 : a553                     lda ad1
3f4b : 7298                     adc (adi2)      ;perform add
3f4d : 08                       php          
3f4e : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3f50 : f003            >        beq skip2846
                       >        trap            ;failed not equal (non zero)
3f52 : 20c740          >        jsr report_error
                       >
3f55 :                 >skip2846
                        
3f55 : 68                       pla             ;check flags
3f56 : 2983                     and #$83        ;mask N-----ZC
3f58 : c557                     cmp adrf
                                trap_ne         ;bad flags
3f5a : f003            >        beq skip2848
                       >        trap            ;failed not equal (non zero)
3f5c : 20c740          >        jsr report_error
                       >
3f5f :                 >skip2848
                        
3f5f : 28                       plp
3f60 : 08                       php             ;save carry for next add
3f61 : a553                     lda ad1
3f63 : f29a                     sbc (sbi2)      ;perform subtract
3f65 : 08                       php          
3f66 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3f68 : f003            >        beq skip2850
                       >        trap            ;failed not equal (non zero)
3f6a : 20c740          >        jsr report_error
                       >
3f6d :                 >skip2850
                        
3f6d : 68                       pla             ;check flags
3f6e : 2983                     and #$83        ;mask N-----ZC
3f70 : c557                     cmp adrf
                                trap_ne         ;bad flags
3f72 : f003            >        beq skip2852
                       >        trap            ;failed not equal (non zero)
3f74 : 20c740          >        jsr report_error
                       >
3f77 :                 >skip2852
                        
3f77 : 28                       plp
3f78 : 60                       rts
                        
                        ; core subroutine of the full binary add/subtract test
                        ; iterates through all combinations of operands and carry input
                        ; uses increments/decrements to predict result & result flags
3f79 : a557             chkadd  lda adrf        ;add V-flag if overflow
3f7b : 2983                     and #$83        ;keep N-----ZC / clear V
3f7d : 48                       pha
3f7e : a553                     lda ad1         ;test sign unequal between operands
3f80 : 4554                     eor ad2
3f82 : 300a                     bmi ckad1       ;no overflow possible - operands have different sign
3f84 : a553                     lda ad1         ;test sign equal between operands and result
3f86 : 4555                     eor adrl
3f88 : 1004                     bpl ckad1       ;no overflow occured - operand and result have same sign
3f8a : 68                       pla
3f8b : 0940                     ora #$40        ;set V
3f8d : 48                       pha
3f8e : 68               ckad1   pla
3f8f : 8557                     sta adrf        ;save expected flags
                        ; binary ADC / SBC (zp)
3f91 : 08                       php             ;save carry for subtract
3f92 : a553                     lda ad1
3f94 : 7298                     adc (adi2)      ;perform add
3f96 : 08                       php          
3f97 : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3f99 : f003            >        beq skip2854
                       >        trap            ;failed not equal (non zero)
3f9b : 20c740          >        jsr report_error
                       >
3f9e :                 >skip2854
                        
3f9e : 68                       pla             ;check flags
3f9f : 29c3                     and #$c3        ;mask NV----ZC
3fa1 : c557                     cmp adrf
                                trap_ne         ;bad flags
3fa3 : f003            >        beq skip2856
                       >        trap            ;failed not equal (non zero)
3fa5 : 20c740          >        jsr report_error
                       >
3fa8 :                 >skip2856
                        
3fa8 : 28                       plp
3fa9 : 08                       php             ;save carry for next add
3faa : a553                     lda ad1
3fac : f29a                     sbc (sbi2)      ;perform subtract
3fae : 08                       php          
3faf : c555                     cmp adrl        ;check result
                                trap_ne         ;bad result
3fb1 : f003            >        beq skip2858
                       >        trap            ;failed not equal (non zero)
3fb3 : 20c740          >        jsr report_error
                       >
3fb6 :                 >skip2858
                        
3fb6 : 68                       pla             ;check flags
3fb7 : 29c3                     and #$c3        ;mask NV----ZC
3fb9 : c557                     cmp adrf
                                trap_ne         ;bad flags
3fbb : f003            >        beq skip2860
                       >        trap            ;failed not equal (non zero)
3fbd : 20c740          >        jsr report_error
                       >
3fc0 :                 >skip2860
                        
3fc0 : 28                       plp
3fc1 : 60                       rts
                                
                        ; target for the jump indirect test
3fc2 : c83f             ji_adr  dw test_ji
3fc4 : d92b                     dw ji_ret
                        
3fc6 : 88                       dey
3fc7 : 88                       dey
3fc8 :                  test_ji
3fc8 : 08                       php             ;either SP or Y count will fail, if we do not hit
3fc9 : 88                       dey
3fca : 88                       dey
3fcb : 88                       dey
3fcc : 28                       plp
                                trap_cs         ;flags loaded?
3fcd : 9003            >        bcc skip2862
                       >        trap            ;failed carry set
3fcf : 20c740          >        jsr report_error
                       >
3fd2 :                 >skip2862
                        
                                trap_vs
3fd2 : 5003            >        bvc skip2864
                       >        trap            ;failed overflow set
3fd4 : 20c740          >        jsr report_error
                       >
3fd7 :                 >skip2864
                        
                                trap_mi
3fd7 : 1003            >        bpl skip2866
                       >        trap            ;failed minus (bit 7 set)
3fd9 : 20c740          >        jsr report_error
                       >
3fdc :                 >skip2866
                        
                                trap_eq 
3fdc : d003            >        bne skip2868
                       >        trap           ;failed equal (zero)
3fde : 20c740          >        jsr report_error
                       >
3fe1 :                 >skip2868
                        
3fe1 : c949                     cmp #'I'        ;registers loaded?
                                trap_ne
3fe3 : f003            >        beq skip2870
                       >        trap            ;failed not equal (non zero)
3fe5 : 20c740          >        jsr report_error
                       >
3fe8 :                 >skip2870
                        
3fe8 : e04e                     cpx #'N'
                                trap_ne        
3fea : f003            >        beq skip2872
                       >        trap            ;failed not equal (non zero)
3fec : 20c740          >        jsr report_error
                       >
3fef :                 >skip2872
                        
3fef : c041                     cpy #('D'-3)
                                trap_ne
3ff1 : f003            >        beq skip2874
                       >        trap            ;failed not equal (non zero)
3ff3 : 20c740          >        jsr report_error
                       >
3ff6 :                 >skip2874
                        
3ff6 : 48                       pha             ;save a,x
3ff7 : 8a                       txa
3ff8 : 48                       pha
3ff9 : ba                       tsx
3ffa : e0fd                     cpx #$fd        ;check SP
                                trap_ne
3ffc : f003            >        beq skip2876
                       >        trap            ;failed not equal (non zero)
3ffe : 20c740          >        jsr report_error
                       >
4001 :                 >skip2876
                        
4001 : 68                       pla             ;restore x
4002 : aa                       tax
                                set_stat $ff
                       >            load_flag $ff
4003 : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
4005 : 48              >            pha         ;use stack to load status
4006 : 28              >            plp
                        
4007 : 68                       pla             ;restore a
4008 : e8                       inx             ;return registers with modifications
4009 : 49aa                     eor #$aa        ;N=1, V=1, Z=0, C=1
400b : 6cff11                   jmp (ji_tab+2)
400e : ea                       nop
400f : ea                       nop
                                trap            ;runover protection
4010 : 20c740          >        jsr report_error
                        
4013 : 4c0013                   jmp start       ;catastrophic error - cannot continue
                        
                        ; target for the jump indirect test
4016 : 7540             jxi_adr dw  trap_ind
4018 : 7540                     dw  trap_ind
401a : 2440                     dw  test_jxi    ;+4
401c : 432c                     dw  jxi_ret     ;+6
401e : 7540                     dw  trap_ind
4020 : 7540                     dw  trap_ind
                        
4022 : 88                       dey
4023 : 88                       dey
4024 :                  test_jxi
4024 : 08                       php             ;either SP or Y count will fail, if we do not hit
4025 : 88                       dey
4026 : 88                       dey
4027 : 88                       dey
4028 : 28                       plp
                                trap_cs         ;flags loaded?
4029 : 9003            >        bcc skip2881
                       >        trap            ;failed carry set
402b : 20c740          >        jsr report_error
                       >
402e :                 >skip2881
                        
                                trap_vs
402e : 5003            >        bvc skip2883
                       >        trap            ;failed overflow set
4030 : 20c740          >        jsr report_error
                       >
4033 :                 >skip2883
                        
                                trap_mi
4033 : 1003            >        bpl skip2885
                       >        trap            ;failed minus (bit 7 set)
4035 : 20c740          >        jsr report_error
                       >
4038 :                 >skip2885
                        
                                trap_eq 
4038 : d003            >        bne skip2887
                       >        trap           ;failed equal (zero)
403a : 20c740          >        jsr report_error
                       >
403d :                 >skip2887
                        
403d : c958                     cmp #'X'        ;registers loaded?
                                trap_ne
403f : f003            >        beq skip2889
                       >        trap            ;failed not equal (non zero)
4041 : 20c740          >        jsr report_error
                       >
4044 :                 >skip2889
                        
4044 : e004                     cpx #4
                                trap_ne        
4046 : f003            >        beq skip2891
                       >        trap            ;failed not equal (non zero)
4048 : 20c740          >        jsr report_error
                       >
404b :                 >skip2891
                        
404b : c046                     cpy #('I'-3)
                                trap_ne
404d : f003            >        beq skip2893
                       >        trap            ;failed not equal (non zero)
404f : 20c740          >        jsr report_error
                       >
4052 :                 >skip2893
                        
4052 : 48                       pha             ;save a,x
4053 : 8a                       txa
4054 : 48                       pha
4055 : ba                       tsx
4056 : e0fd                     cpx #$fd        ;check SP
                                trap_ne
4058 : f003            >        beq skip2895
                       >        trap            ;failed not equal (non zero)
405a : 20c740          >        jsr report_error
                       >
405d :                 >skip2895
                        
405d : 68                       pla             ;restore x
405e : aa                       tax
                                set_stat $ff
                       >            load_flag $ff
405f : a9ff            >            lda #$ff             ;allow test to change I-flag (no mask)
                       >
4061 : 48              >            pha         ;use stack to load status
4062 : 28              >            plp
                        
4063 : 68                       pla             ;restore a
4064 : e8                       inx             ;return registers with modifications
4065 : e8                       inx
4066 : 49aa                     eor #$aa        ;N=1, V=1, Z=0, C=1
4068 : 7cf911                   jmp (jxi_tab,x)
406b : ea                       nop
406c : ea                       nop
                                trap            ;runover protection
406d : 20c740          >        jsr report_error
                        
4070 : 4c0013                   jmp start       ;catastrophic error - cannot continue
                        
                        ; JMP (abs,x) with bad x
4073 : ea                       nop
4074 : ea                       nop
4075 :                  trap_ind
4075 : ea                       nop
4076 : ea                       nop
                                trap            ;near miss indexed indirect jump
4077 : 20c740          >        jsr report_error
                        
407a : 4c0013                   jmp start       ;catastrophic error - cannot continue
                        
                        ;trap in case of unexpected IRQ, NMI, BRK, RESET
407d :                  nmi_trap
                                trap            ;check stack for conditions at NMI
407d : 20c740          >        jsr report_error
                        
4080 : 4c0013                   jmp start       ;catastrophic error - cannot continue
4083 :                  res_trap
                                trap            ;unexpected RESET
4083 : 20c740          >        jsr report_error
                        
4086 : 4c0013                   jmp start       ;catastrophic error - cannot continue
                        
4089 : 88                       dey
408a : 88                       dey
408b :                  irq_trap                ;BRK test or unextpected BRK or IRQ
408b : 08                       php             ;either SP or Y count will fail, if we do not hit
408c : 88                       dey
408d : 88                       dey
408e : 88                       dey
                                ;next traps could be caused by unexpected BRK or IRQ
                                ;check stack for BREAK and originating location
                                ;possible jump/branch into weeds (uninitialized space)
                            if ROM_vectors = 1
                                cmp #$ff-'B'    ;BRK pass 2 registers loaded?
                                beq break2
                            endif
408f : c942                     cmp #'B'        ;BRK pass 1 registers loaded?
                                trap_ne
4091 : f003            >        beq skip2903
                       >        trap            ;failed not equal (non zero)
4093 : 20c740          >        jsr report_error
                       >
4096 :                 >skip2903
                        
4096 : e052                     cpx #'R'
                                trap_ne        
4098 : f003            >        beq skip2905
                       >        trap            ;failed not equal (non zero)
409a : 20c740          >        jsr report_error
                       >
409d :                 >skip2905
                        
409d : c048                     cpy #'K'-3
                                trap_ne
409f : f003            >        beq skip2907
                       >        trap            ;failed not equal (non zero)
40a1 : 20c740          >        jsr report_error
                       >
40a4 :                 >skip2907
                        
40a4 : 8550                     sta irq_a       ;save registers during break test
40a6 : 8651                     stx irq_x
40a8 : ba                       tsx             ;test break on stack
40a9 : bd0201                   lda $102,x
                                cmp_flag 0      ;break test should have B=1 & unused=1 on stack
40ac : c930            >            cmp #(0      |fao)&m8    ;expected flags + always on bits
                        
                                trap_ne         ;possible no break flag on stack
40ae : f003            >        beq skip2910
                       >        trap            ;failed not equal (non zero)
40b0 : 20c740          >        jsr report_error
                       >
40b3 :                 >skip2910
                        
                            if ROM_vectors = 1
                                pla
                                cmp_flag intdis ;should have added interrupt disable
                                trap_ne
                                tsx
                                cpx #$fc        ;sp -3? (return addr, flags)
                                trap_ne
                                lda $1ff        ;propper return on stack
                                cmp #hi(brk_ret0)
                                trap_ne
                                lda $1fe
                                cmp #lo(brk_ret0)
                                trap_ne
                                load_flag $ff
                                pha
                                ldx irq_x
                                inx             ;return registers with modifications
                                lda irq_a
                                eor #$aa
                                plp             ;N=1, V=1, Z=1, C=1 but original flags should be restored
                                rti
                                trap            ;runover protection
                                jmp start       ;catastrophic error - cannot continue
                                
                        break2                  ;BRK pass 2        
                                cpx #$ff-'R'
                                trap_ne        
                                cpy #$ff-'K'-3
                                trap_ne
                                sta irq_a       ;save registers during break test
                                stx irq_x
                                tsx             ;test break on stack
                                lda $102,x
                                cmp_flag $ff    ;break test should have B=1
                                trap_ne         ;possibly no break flag on stack
                                pla
                                cmp_flag $ff-decmode ;actual passed flags should have decmode cleared
                                trap_ne
                                tsx
                                cpx #$fc        ;sp -3? (return addr, flags)
                                trap_ne
                                lda $1ff        ;propper return on stack
                                cmp #hi(brk_ret1)
                                trap_ne
                                lda $1fe
                                cmp #lo(brk_ret1)
                                trap_ne
                                load_flag intdis
                                pha      
                                ldx irq_x
                                inx             ;return registers with modifications
                                lda irq_a
                                eor #$aa
                                plp             ;N=0, V=0, Z=0, C=0 but original flags should be restored
                                rti
                                trap            ;runover protection
                                jmp start       ;catastrophic error - cannot continue
                            else
                                trap_eq         ;check stack for conditions at BRK
40b3 : d003            >        bne skip2912
                       >        trap           ;failed equal (zero)
40b5 : 20c740          >        jsr report_error
                       >
40b8 :                 >skip2912
                        
                            endif
                        
                            if report = 1
                                include "report.i65"
0001 =                  T_ATOM = 1
0002 =                  T_BEEB = 2
                        
                          if (TARGET = T_ATOM)
                        OSRDCH = $FFE3
                        OSWRCH = $FFF4
                          else
                            if (TARGET = T_BEEB)
ffe0 =                  OSRDCH = $FFE0
ffee =                  OSWRCH = $FFEE
                            else
                        ERROR TARGET must be 1 or 2
                            endif
                          endif
                        
                        
                        ;**** report 6502 funtional test errors to standard I/O ****
                        ;
                        ;this include file is part of the 6502 functional tests
                        ;it is used when you configure report = 1 in the tests
                        ;
                        ;to adopt the standard output vectors of your test environment
                        ;you must modify the rchar and rget subroutines in this include
                        ;
                        ;I/O hardware may have to be initialized in report_init
                        
                        ;print message macro - \1 = message location
                        rprt    macro
                                ldx #0
                                lda \1
                        loop\?
                                jsr rchar
                                inx
                                lda \1,x
                                bne loop\?
                                endm
                        
                        ;initialize I/O as required (example: configure & enable ACIA)
40b8 :                  report_init
                                ;nothing to initialize
                                rprt rmsg_start
40b8 : a200            >        ldx #0
40ba : add541          >        lda rmsg_start
40bd :                 >loop2914
40bd : 20d141          >        jsr rchar
40c0 : e8              >        inx
40c1 : bdd541          >        lda rmsg_start,x
40c4 : d0f7            >        bne loop2914
                        
40c6 : 60                       rts
                                
                        ;show stack (with saved registers), zeropage and absolute memory workspace
                        ;after an error was trapped in the test program
40c7 :                  report_error
                        ;save registers
40c7 : 08                       php
40c8 : 48                       pha
40c9 : 8a                       txa
40ca : 48                       pha
40cb : 98                       tya
40cc : 48                       pha
40cd : d8                       cld
                        ;show stack with index to registers at error
                                rprt rmsg_stack
40ce : a200            >        ldx #0
40d0 : ade941          >        lda rmsg_stack
40d3 :                 >loop2915
40d3 : 20d141          >        jsr rchar
40d6 : e8              >        inx
40d7 : bde941          >        lda rmsg_stack,x
40da : d0f7            >        bne loop2915
                        
40dc : ba                       tsx
40dd : e8                       inx
40de : a901                     lda #1      ;address high
40e0 : 20bd41                   jsr rhex
40e3 : 8a                       txa         ;address low
40e4 : 20bd41                   jsr rhex
40e7 : 20b941           rstack  jsr rspace
40ea : bd0001                   lda $100,x  ;stack data
40ed : 20bd41                   jsr rhex
40f0 : e8                       inx
40f1 : d0f4                     bne rstack
40f3 : 20b041                   jsr rcrlf   ;new line
                        ;show zero page workspace
40f6 : a900                     lda #0
40f8 : 20bd41                   jsr rhex
40fb : a952                     lda #zpt
40fd : aa                       tax
40fe : 20bd41                   jsr rhex
4101 : 20b941           rzp     jsr rspace
4104 : b500                     lda 0,x
4106 : 20bd41                   jsr rhex
4109 : e8                       inx
410a : e059                     cpx #zp_bss
410c : d0f3                     bne rzp
410e : 20b041                   jsr rcrlf
                        ;show absolute workspace
4111 : a911                     lda #hi(data_segment)
4113 : 20bd41                   jsr rhex
4116 : a900                     lda #lo(data_segment)
4118 : 20bd41                   jsr rhex
411b : a200                     ldx #0
411d : 20b941           rabs    jsr rspace
4120 : bd0011                   lda data_segment,x
4123 : 20bd41                   jsr rhex
4126 : e8                       inx
4127 : e00a                     cpx #(data_bss-data_segment)
4129 : d0f2                     bne rabs
                        ;ask to continue
                                rprt rmsg_cont
412b : a200            >        ldx #0
412d : ad0542          >        lda rmsg_cont
4130 :                 >loop2916
4130 : 20d141          >        jsr rchar
4133 : e8              >        inx
4134 : bd0542          >        lda rmsg_cont,x
4137 : d0f7            >        bne loop2916
                        
4139 : 20a641           rerr1   jsr rget
413c : c953                     cmp #'S'
413e : f00b                     beq rskip
4140 : c943                     cmp #'C'
4142 : d0f5                     bne rerr1        
                        ;restore registers
4144 : 68                       pla
4145 : a8                       tay
4146 : 68                       pla
4147 : aa                       tax
4148 : 68                       pla 
4149 : 28                       plp
414a : 60                       rts
                        ;skip the current test
414b : a9f0             rskip   lda #$f0            ;already end of tests?
414d : cd0211                   cmp test_case
4150 : f0e7                     beq rerr1           ;skip is not available
4152 : a2ff                     ldx #$ff            ;clear stack
4154 : 9a                       txs
4155 : ee0211                   inc test_case       ;next test
4158 : a900                     lda #lo(start)      ;find begin of test
415a : 8552                     sta zpt
415c : a913                     lda #hi(start)
415e : 8553                     sta zpt+1
4160 : a004             rskipl1 ldy #4              ;search pattern
4162 : b152             rskipl2 lda (zpt),y         ;next byte
4164 : d98b41                   cmp rmark,y
4167 : d00a                     bne rskipnx         ;no match
4169 : 88                       dey
416a : 300f                     bmi rskipf          ;found pattern        
416c : c001                     cpy #1              ;skip immediate value
416e : d0f2                     bne rskipl2
4170 : 88                       dey
4171 : f0ef                     beq rskipl2
                                
4173 : e652             rskipnx inc zpt             ;next RAM location
4175 : d0e9                     bne rskipl1
4177 : e653                     inc zpt+1
4179 : d0e5                     bne rskipl1
                        
417b : a001             rskipf  ldy #1              ;pattern found - check test number
417d : b152                     lda (zpt),y         ;test number
417f : c9f0                     cmp #$f0            ;end of last test?
4181 : f005                     beq rskipe          ;ask to rerun all
4183 : cd0211                   cmp test_case       ;is next test?
4186 : d0eb                     bne rskipnx         ;continue searching
4188 : 6c5200           rskipe  jmp (zpt)           ;start next test or rerun at end of tests
                                
418b : a900             rmark   lda #0              ;begin of test search pattern
418d : 8d0211                   sta test_case
                        
                        ;show test has ended, ask to repeat
4190 :                  report_success
                            if rep_int = 1
                                rprt rmsg_priority
                                lda data_segment    ;show interrupt sequence
                                jsr rhex
                                jsr rspace
                                lda data_segment+1
                                jsr rhex
                                jsr rspace
                                lda data_segment+2
                                jsr rhex
                            endif
                                rprt rmsg_success
4190 : a200            >        ldx #0
4192 : ad3742          >        lda rmsg_success
4195 :                 >loop2917
4195 : 20d141          >        jsr rchar
4198 : e8              >        inx
4199 : bd3742          >        lda rmsg_success,x
419c : d0f7            >        bne loop2917
                        
419e : 20a641           rsuc1   jsr rget
41a1 : c952                     cmp #'R'
41a3 : d0f9                     bne rsuc1        
41a5 : 60                       rts
                        
                        ;input subroutine
                        ;get a character from standard input 
                        ;adjust according to the needs in your test environment
41a6 :                  rget                ;get character in A
41a6 : 20e0ff                   jsr OSRDCH  ;example: OSRDCH on a Beeb/Atom
                        ;rget1
                        ;        lda $bff1   ;wait RDRF
                        ;        and #8
                        ;        beq rget1
                        ;not a real ACIA - so RDRF is not checked
                        ;        lda $bff0   ;read acia rx reg
                        ;       lda $f004   ;Kowalski simulator default
                        ;the load can be replaced by a call to a kernal routine
                        ;        jsr $ffcf   ;example: CHRIN for a C64
41a9 : c961                     cmp #'a'    ;lower case
41ab : 9002                     bcc rget1
41ad : 295f                     and #$5f    ;convert to upper case
41af : 60               rget1   rts
                        
                        ;output subroutines
41b0 : a90a             rcrlf   lda #10
41b2 : 20d141                   jsr rchar
41b5 : a90d                     lda #13
41b7 : d018                     bne rchar
                        
41b9 : a920             rspace  lda #' '
41bb : d014                     bne rchar
                                
41bd : 48               rhex    pha         ;report hex byte in A
41be : 4a                       lsr a       ;high nibble first
41bf : 4a                       lsr a
41c0 : 4a                       lsr a
41c1 : 4a                       lsr a
41c2 : 20c841                   jsr rnib
41c5 : 68                       pla         ;now low nibble
41c6 : 290f                     and #$f
                        
41c8 : 18               rnib    clc         ;report nibble in A
41c9 : 6930                     adc #'0'    ;make printable 0-9
41cb : c93a                     cmp #'9'+1
41cd : 9002                     bcc rchar
41cf : 6906                     adc #6      ;make printable A-F
                        
                        ;send a character to standard output 
                        ;adjust according to the needs in your test environment
                        ;register X needs to be preserved!
41d1 :                  rchar               ;report character in A
41d1 : 20eeff                   jsr OSWRCH  ;example: OSWRCH on a Beeb/Atom
                        ;        pha         ;wait TDRF
                        ;rchar1  lda $bff1
                        ;        and #$10
                        ;        beq rchar1
                        ;        pla
                        ;not a real ACIA - so TDRF is not checked
                        ;        sta $bff0   ;write acia tx reg
                        ;        sta $f001   ;Kowalski simulator default
                        ;the store can be replaced by a call to a kernal routine
                        ;        jsr $ffd2   ;example: CHROUT for a C64
41d4 : 60                       rts
                        
41d5 :                  rmsg_start
41d5 : 0a0d5374617274..         db  10,13,"Started testing",10,13,0
41e9 :                  rmsg_stack
41e9 : 0a0d7265677320..         db  10,13,"regs Y  X  A  PS PCLPCH",10,13,0
4205 :                  rmsg_cont
4205 : 0a0d7072657373..         db  10,13,"press C to continue or S to skip current test",10,13,0
4237 :                  rmsg_success
4237 : 0a0d416c6c2074..         db  10,13,"All tests completed, press R to repeat",10,13,0
                            if rep_int = 1
                        rmsg_priority
                                db  10,13,"interrupt sequence (NMI IRQ BRK) ",0
                            endif
                           
                            endif
                                    
                        ;copy of data to initialize BSS segment
                            if load_data_direct != 1
4262 :                  zp_init
4262 : c3824100         zp1_    db  $c3,$82,$41,0   ;test patterns for LDx BIT ROL ROR ASL LSR
4266 : 7f               zp7f_   db  $7f             ;test pattern for compare  
                        ;logical zeropage operands
4267 : 001f7180         zpOR_   db  0,$1f,$71,$80   ;test pattern for OR
426b : 0fff7f80         zpAN_   db  $0f,$ff,$7f,$80 ;test pattern for AND
426f : ff0f8f8f         zpEO_   db  $ff,$0f,$8f,$8f ;test pattern for EOR
                        ;indirect addressing pointers
4273 : 1011             ind1_   dw  abs1            ;indirect pointer to pattern in absolute memory
4275 : 1111                     dw  abs1+1
4277 : 1211                     dw  abs1+2
4279 : 1311                     dw  abs1+3
427b : 1411                     dw  abs7f
427d : 1810             inw1_   dw  abs1-$f8        ;indirect pointer for wrap-test pattern
427f : 0511             indt_   dw  abst            ;indirect pointer to store area in absolute memory
4281 : 0611                     dw  abst+1
4283 : 0711                     dw  abst+2
4285 : 0811                     dw  abst+3
4287 : 0d10             inwt_   dw  abst-$f8        ;indirect pointer for wrap-test store
4289 : 4711             indAN_  dw  absAN           ;indirect pointer to AND pattern in absolute memory
428b : 4811                     dw  absAN+1
428d : 4911                     dw  absAN+2
428f : 4a11                     dw  absAN+3
4291 : 4b11             indEO_  dw  absEO           ;indirect pointer to EOR pattern in absolute memory
4293 : 4c11                     dw  absEO+1
4295 : 4d11                     dw  absEO+2
4297 : 4e11                     dw  absEO+3
4299 : 4311             indOR_  dw  absOR           ;indirect pointer to OR pattern in absolute memory
429b : 4411                     dw  absOR+1
429d : 4511                     dw  absOR+2
429f : 4611                     dw  absOR+3
                        ;add/subtract indirect pointers
42a1 : 0511             adi2_   dw  ada2            ;indirect pointer to operand 2 in absolute memory
42a3 : 0611             sbi2_   dw  sba2            ;indirect pointer to complemented operand 2 (SBC)
42a5 : 0610             adiy2_  dw  ada2-$ff        ;with offset for indirect indexed
42a7 : 0710             sbiy2_  dw  sba2-$ff
42a9 :                  zp_end
                            if (zp_end - zp_init) != (zp_bss_end - zp_bss)   
                                ;force assembler error if size is different   
                                ERROR ERROR ERROR   ;mismatch between bss and zeropage data
                            endif 
42a9 :                  data_init
42a9 : 6900             ex_adc_ adc #0              ;execute immediate opcodes
42ab : 60                       rts
42ac : e900             ex_sbc_ sbc #0              ;execute immediate opcodes
42ae : 60                       rts
42af : c3824100         abs1_   db  $c3,$82,$41,0   ;test patterns for LDx BIT ROL ROR ASL LSR
42b3 : 7f               abs7f_  db  $7f             ;test pattern for compare
                        ;loads
42b4 : 80800002         fLDx_   db  fn,fn,0,fz      ;expected flags for load
                        ;shifts
42b8 :                  rASL_                       ;expected result ASL & ROL -carry  
42b8 : 86048200         rROL_   db  $86,$04,$82,0   ; "
42bc : 87058301         rROLc_  db  $87,$05,$83,1   ;expected result ROL +carry
42c0 :                  rLSR_                       ;expected result LSR & ROR -carry
42c0 : 61412000         rROR_   db  $61,$41,$20,0   ; "
42c4 : e1c1a080         rRORc_  db  $e1,$c1,$a0,$80 ;expected result ROR +carry
42c8 :                  fASL_                       ;expected flags for shifts
42c8 : 81018002         fROL_   db  fnc,fc,fn,fz    ;no carry in
42cc : 81018000         fROLc_  db  fnc,fc,fn,0     ;carry in
42d0 :                  fLSR_
42d0 : 01000102         fROR_   db  fc,0,fc,fz      ;no carry in
42d4 : 81808180         fRORc_  db  fnc,fn,fnc,fn   ;carry in
                        ;increments (decrements)
42d8 : 7f80ff0001       rINC_   db  $7f,$80,$ff,0,1 ;expected result for INC/DEC
42dd : 0080800200       fINC_   db  0,fn,fn,fz,0    ;expected flags for INC/DEC
                        ;logical memory operand
42e2 : 001f7180         absOR_  db  0,$1f,$71,$80   ;test pattern for OR
42e6 : 0fff7f80         absAN_  db  $0f,$ff,$7f,$80 ;test pattern for AND
42ea : ff0f8f8f         absEO_  db  $ff,$0f,$8f,$8f ;test pattern for EOR
                        ;logical accu operand
42ee : 00f11f00         absORa_ db  0,$f1,$1f,0     ;test pattern for OR
42f2 : f0ffffff         absANa_ db  $f0,$ff,$ff,$ff ;test pattern for AND
42f6 : fff0f00f         absEOa_ db  $ff,$f0,$f0,$0f ;test pattern for EOR
                        ;logical results
42fa : 00ff7f80         absrlo_ db  0,$ff,$7f,$80
42fe : 02800080         absflo_ db  fz,fn,0,fn
4302 :                  data_end
                            if (data_end - data_init) != (data_bss_end - data_bss)
                                ;force assembler error if size is different   
                                ERROR ERROR ERROR   ;mismatch between bss and data
                            endif 
                        
4302 :                  vec_init
4302 : 7d40                     dw  nmi_trap
4304 : 8340                     dw  res_trap
4306 : 8b40                     dw  irq_trap
fffa =                  vec_bss equ $fffa
                            endif                   ;end of RAM init data
                            
                        ; code at end of image due to the need to add blank space as required
                            if ($ff & (ji_ret - * - 2)) < ($ff & (jxi_ret - * - 2))
                        ; JMP (abs) when $xxff and $xx00 are from same page
                                ds  lo(ji_ret - * - 2)
                                nop
                                nop
                        ji_px   nop             ;low address byte matched with ji_ret 
                                nop
                                trap            ;jmp indirect page cross bug
                        
                        ; JMP (abs,x) when $xxff and $xx00 are from same page
                                ds  lo(jxi_ret - * - 2)
                                nop
                                nop
                        jxi_px  nop             ;low address byte matched with jxi_ret 
                                nop
                                trap            ;jmp indexed indirect page cross bug
                            else
                        ; JMP (abs,x) when $xxff and $xx00 are from same page
4308 : 00000000000000..         ds  lo(jxi_ret - * - 2)
4341 : ea                       nop
4342 : ea                       nop
4343 : ea               jxi_px  nop             ;low address byte matched with jxi_ret 
4344 : ea                       nop
                                trap            ;jmp indexed indirect page cross bug
4345 : 20c740          >        jsr report_error
                        
                        
                        ; JMP (abs) when $xxff and $xx00 are from same page
4348 : 00000000000000..         ds  lo(ji_ret - * - 2)
43d7 : ea                       nop
43d8 : ea                       nop
43d9 : ea               ji_px   nop             ;low address byte matched with ji_ret 
43da : ea                       nop
                                trap            ;jmp indirect page cross bug
43db : 20c740          >        jsr report_error
                        
                            endif
                            
                            if (load_data_direct = 1) & (ROM_vectors = 1)  
                                org $fffa       ;vectors
                                dw  nmi_trap
                                dw  res_trap
                                dw  irq_trap
                            endif
                        
43d9 =                          end start
                        
No errors in pass 2.
Wrote binary from address $1300 through $43dd.
Total size 12510 bytes.
Program start address is at $1300 (4864).
